<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="theme-color" content="#4F46E5">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description"
        content="Team Shoky Helper - A modern web application for college students to access courses, lecture schedules, and university news.">
    <meta name="keywords"
        content="Team Shoky Helper, college student app, university courses, lecture schedules, university news, student portal">
    <meta name="author" content="Team Shoky">
    <meta name="robots" content="index, follow">
    <meta property="og:title" content="Team Shoky Helper - Your College Companion">
    <meta property="og:description"
        content="Access your courses, lecture schedules, and university news with Team Shoky Helper.">
    <meta property="og:image" content="https://i.ibb.co/bRCWmT9d/Team-Shoky-Helper.jpg">
    <meta property="og:url" content="https://teamshoky.or-g.net/">
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="Team Shoky Helper">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Team Shoky Helper - Your College Companion">
    <meta name="twitter:description"
        content="Access your courses, lecture schedules, and university news with Team Shoky Helper.">
    <meta name="twitter:image" content="https://i.ibb.co/bRCWmT9d/Team-Shoky-Helper.jpg">
    <meta name="twitter:site" content="@yousefsrour13">
    <link rel="apple-touch-icon" sizes="57x57" href="favicon/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="favicon/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="favicon/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="favicon/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="favicon/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="favicon/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="favicon/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="favicon/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="favicon/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192" href="favicon/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="favicon/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="favicon/favicon-16x16.png">
    <!-- AFTER (Example - Adapt based on your critical CSS needs) -->
    <!-- Load critical CSS normally (or inline it) -->
    <!-- <link href="critical.css" rel="stylesheet"> -->

    <!-- Preload non-critical CSS -->
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" as="style"
        onload="this.onload=null;this.rel='stylesheet'">
    <noscript>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css">
    </noscript>

    <link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.0.0/css/all.min.css"
        as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.0.0/css/all.min.css">
    </noscript>

    <link rel="preload" href="https://cdn.jsdelivr.net/npm/fullcalendar@5.10.1/main.min.css" as="style"
        onload="this.onload=null;this.rel='stylesheet'">
    <noscript>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/fullcalendar@5.10.1/main.min.css">
    </noscript>

    <link rel="preload" href="https://cdn.jsdelivr.net/npm/shepherd.js@10.0.1/dist/css/shepherd.css" as="style"
        onload="this.onload=null;this.rel='stylesheet'">
    <noscript>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/shepherd.js@10.0.1/dist/css/shepherd.css">
    </noscript>
    <!-- ADD jsPDF Libraries -->
    <script defer src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script defer
        src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.23/jspdf.plugin.autotable.min.js"></script>
    <!-- END jsPDF Libraries -->
    <!-- Add after your existing CSS links -->
    <script defer src="https://cdn.jsdelivr.net/npm/shepherd.js@10.0.1/dist/js/shepherd.min.js"></script>
    <script type="application/ld+json">
        {
          "@context": "https://schema.org",
          "@type": "WebApplication",
          "name": "Team Shoky Helper",
          "url": "https://teamshoky.or-g.net/",
          "description": "A modern web application for college students to access courses, lecture schedules, and university news.",
          "applicationCategory": "EducationApplication",
          "operatingSystem": "All",
          "author": {
            "@type": "Organization",
            "name": "Team Shoky"
          },
          "image": "https://ibb.co/Q7QX033p",
          "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "USD"
          }
        }
        </script>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-7JJ4FT0GJ2"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'G-7JJ4FT0GJ2');
    </script>
    <title>Team Shoky Helper - Your College Companion</title>
    <link rel="canonical" href="https://teamshoky.or-g.net/">
    <link rel="manifest" href="manifest.json">
    <link rel="preconnect" href="https://cdn.jsdelivr.net">
    <script defer src="https://cdn.jsdelivr.net/npm/fullcalendar@5.10.1/main.min.js"></scriptdefer>
    <script>
        if ("serviceWorker" in navigator) {
            navigator.serviceWorker.register("./service-worker.js")
                .then(() => console.log("Service Worker Registered"))
                .catch((error) => console.error("Service Worker Registration Failed:", error));
        }
        document.addEventListener('DOMContentLoaded', () => {
            const statusElement = document.getElementById('notification-status'); // Optional

            // Check if push notifications are supported
            if ('serviceWorker' in navigator && 'PushManager' in window) {
                navigator.serviceWorker.ready.then(registration => {
                    // Replace with your public VAPID key
                    const applicationServerKey = 'BMKGpCMKhbZK013iH-1q3K6Qbmv6Yz6gEwlklT-24GT_pk9f6R2Otq1byR8I2bUmBZmrreyAkkkJplb-M1XEpJs';

                    // Check current permission state
                    if (Notification.permission === 'granted') {
                        subscribeUser(registration, applicationServerKey);
                    } else if (Notification.permission !== 'denied') {
                        // Request permission immediately
                        Notification.requestPermission().then(permission => {
                            if (permission === 'granted') {
                                subscribeUser(registration, applicationServerKey);
                            } else {
                                if (statusElement) statusElement.textContent = 'Notification permission denied.';
                                console.log('User denied notification permission');
                            }
                        });
                    } else {
                        if (statusElement) statusElement.textContent = 'Notifications blocked by user.';
                        console.log('Notifications already denied');
                    }
                });
            } else {
                if (statusElement) statusElement.textContent = 'Push notifications not supported.';
                console.log('Push notifications not supported in this browser');
            }
        });

        // Function to subscribe the user
        function subscribeUser(registration, applicationServerKey) {
            const subscribeOptions = {
                userVisibleOnly: true,
                applicationServerKey: urlBase64ToUint8Array(applicationServerKey)
            };

            registration.pushManager.subscribe(subscribeOptions)
                .then(subscription => {
                    console.log('User subscribed:', subscription);
                    const statusElement = document.getElementById('notification-status');
                    if (statusElement) statusElement.textContent = 'Subscribed to notifications!';

                    // Send subscription to your server
                    fetch('https://push-notfication-server-production.up.railway.app/subscribe', { // Replace with your server URL
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(subscription)
                    })
                        .then(response => response.json())
                        .then(data => console.log('Subscription saved:', data))
                        .catch(error => console.error('Error saving subscription:', error));
                })
                .catch(error => {
                    console.error('Subscription failed:', error);
                    const statusElement = document.getElementById('notification-status');
                    if (statusElement) statusElement.textContent = 'Failed to subscribe to notifications.';
                });
        }

        // Utility function to convert VAPID key
        function urlBase64ToUint8Array(base64String) {
            const padding = '='.repeat((4 - base64String.length % 4) % 4);
            const base64 = (base64String + padding).replace(/-/g, '+').replace(/_/g, '/');
            const rawData = window.atob(base64);
            const outputArray = new Uint8Array(rawData.length);
            for (let i = 0; i < rawData.length; ++i) {
                outputArray[i] = rawData.charCodeAt(i);
            }
            return outputArray;
        }

        let deferredPrompt;

        document.addEventListener('DOMContentLoaded', () => {
            const installButtonContainer = document.getElementById('install-app-button-container');
            const installButton = document.getElementById('install-app-button');

            const isRunningAsPWA = window.matchMedia('(display-mode: standalone)').matches || window.navigator.standalone;

            if (isRunningAsPWA) {
                installButton.disabled = true;
                installButton.textContent = 'App Installed';
                installButtonContainer.classList.remove('hidden');
            } else {
                // Only show if event fires
                window.addEventListener('beforeinstallprompt', (e) => {
                    e.preventDefault();
                    deferredPrompt = e;
                    installButtonContainer.classList.remove('hidden');
                });

                installButton.addEventListener('click', async () => {
                    if (deferredPrompt) {
                        deferredPrompt.prompt();
                        const { outcome } = await deferredPrompt.userChoice;
                        console.log(outcome === 'accepted' ? 'User accepted install' : 'User dismissed install');
                        deferredPrompt = null;
                    } else {
                        alert("Install option not available yet. Try again later.");
                    }
                });
            }
        });
    </script>
    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getDatabase } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-database.js"; // <<< ADD THIS LINE
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-analytics.js"; // Keep if you use analytics
        import { getFirestore } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyAUY9gvxnY5hGPu0lXNXJacLHKgZrEQ7eU", // Use your actual key
            authDomain: "teamshokyhelper.firebaseapp.com",
            // !!! IMPORTANT: Add databaseURL if it's not automatically derived (often needed for Realtime Database)
            databaseURL: "https://teamshokyhelper-default-rtdb.firebaseio.com", // <<< ADD/VERIFY YOUR REALTIME DATABASE URL
            projectId: "teamshokyhelper",
            storageBucket: "teamshokyhelper.appspot.com", // <<< Corrected common pattern .appspot.com
            messagingSenderId: "991615498817",
            appId: "1:991615498817:web:00a1925089c38bcc0464c0",
            measurementId: "G-7JJ4FT0GJ2" // Optional
        };

        // Initialize Firebase App (globally accessible)
        try {
            // We initialize here so the app instance is ready when the main script runs
            window._firebaseAppInstance = initializeApp(firebaseConfig);
            console.log("Firebase App Initialized (in head module)");
        } catch (error) {
            console.error("Firebase Initialization Failed (in head module):", error);
            alert("Critical error initializing application services. Please refresh.");
        }

        // If you use analytics:
        // const analytics = getAnalytics(window._firebaseAppInstance);
    </script>
    <style>
        :root {
            --primary-color: #4F46E5;
            --secondary-color: #7C3AED;
            --accent-color: #10B981;
            --light-bg: #F9FAFB;
            --dark-bg: #1F2937;
            --dark-card: #374151;
            --text-light: #F3F4F6;
            --text-dark: #1F2937;
        }

        /* Shepherd Tour Custom Styles */
        .shepherd-theme-custom {
            max-width: 90vw !important;
            /* Ensures it never exceeds viewport width */
            width: fit-content !important;
            /* Adapts to content */
            font-size: 14px !important;
            z-index: 9999 !important;
        }

        .shepherd-theme-custom .shepherd-button-primary {
            background: #4F46E5 !important;
            color: white !important;
            border-radius: 0.375rem !important;
            padding: 0.5rem 1rem !important;
            font-weight: 500 !important;
            transition: background-color 0.2s !important;
        }

        .shepherd-theme-custom .shepherd-button-primary:hover {
            background: #4338CA !important;
        }

        .shepherd-theme-custom .shepherd-button-secondary {
            background: #9CA3AF !important;
            color: white !important;
            border-radius: 0.375rem !important;
            padding: 0.5rem 1rem !important;
            font-weight: 500 !important;
            transition: background-color 0.2s !important;
        }

        .shepherd-theme-custom .shepherd-button-secondary:hover {
            background: #6B7280 !important;
        }

        .shepherd-theme-custom .shepherd-button-done {
            background: #0cd358 !important;
            color: white !important;
            border-radius: 0.375rem !important;
            padding: 0.5rem 1rem !important;
            font-weight: 500 !important;
            transition: background-color 0.2s !important;
        }

        .shepherd-theme-custom .shepherd-button-done:hover {
            background: #039e20 !important;
        }

        .shepherd-theme-custom .shepherd-button-cancel {
            background: #d30c0c !important;
            color: white !important;
            border-radius: 0.375rem !important;
            padding: 0.5rem 1rem !important;
            font-weight: 500 !important;
            transition: background-color 0.2s !important;
        }

        .shepherd-theme-custom .shepherd-button-cancel:hover {
            background: #9e0303 !important;
        }

        .shepherd-theme-custom .shepherd-text {
            font-size: 0.875rem !important;
            line-height: 1.25rem !important;
            padding: 1rem !important;
        }

        /* Make sure the content does not exceed the screen */
        .shepherd-theme-custom .shepherd-content {
            border-radius: 12px !important;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06) !important;
            width: auto !important;
            /* Adjust width dynamically */
            max-width: 85vw !important;
            /* Prevents it from getting too large */
            word-wrap: break-word !important;
            /* Prevents text overflow */
            white-space: normal !important;
            overflow: hidden !important;
        }

        /* Ensure text does not overflow */
        .shepherd-theme-custom .shepherd-text {
            font-size: 0.875rem !important;
            line-height: 1.4 !important;
            padding: 0.75rem !important;
            width: 100% !important;
            word-wrap: break-word !important;
            white-space: normal !important;
            overflow-wrap: break-word !important;
        }

        /* Make sure buttons adjust and do not break layout */
        .shepherd-theme-custom .shepherd-footer {
            padding: 0.5rem !important;
            display: flex !important;
            justify-content: center !important;
            gap: 0.5rem !important;
            flex-wrap: wrap !important;
        }

        /* Buttons should shrink when needed */
        .shepherd-theme-custom .shepherd-button {
            font-size: 0.875rem !important;
            padding: 0.375rem 0.75rem !important;
            border-radius: 0.375rem !important;
            font-weight: 500 !important;
            min-height: 2rem !important;
            min-width: 4rem !important;
            max-width: 100% !important;
            /* Ensures it does not overflow */
        }

        /* Mobile Optimizations */
        @media (max-width: 640px) {
            .shepherd-theme-custom {
                max-width: 95vw !important;
                /* Fits inside small screens */
                font-size: 13px !important;
                margin: 0 auto !important;
            }

            .shepherd-theme-custom .shepherd-content {
                max-width: 90vw !important;
                /* Prevents cutting on small screens */
            }

            .shepherd-theme-custom .shepherd-text {
                padding: 0.5rem !important;
                font-size: 0.813rem !important;
                overflow-wrap: break-word !important;
                word-break: break-word !important;
            }

            .shepherd-theme-custom .shepherd-button {
                padding: 0.25rem 0.5rem !important;
                font-size: 0.813rem !important;
                min-height: 1.75rem !important;
            }

            .shepherd-theme-custom .shepherd-footer {
                padding: 0.375rem !important;
                justify-content: center !important;
            }
        }

        /* Ensure it never goes off the screen */
        .shepherd-element {
            position: fixed !important;
            z-index: 9999 !important;
            left: 50% !important;
            transform: translateX(-50%) !important;
            /* Centers it properly */
            max-width: 90vw !important;
        }

        /* Keep it properly positioned over the target */
        .shepherd-target.shepherd-enabled {
            position: relative !important;
            z-index: 9998 !important;
        }

        .shepherd-modal-overlay-container {
            z-index: 9997 !important;
        }


        /* Popup animation */
        @keyframes popup-animation {
            0% {
                transform: translate(-50%, -50%) scale(0);
                opacity: 0;
            }

            100% {
                transform: translate(-50%, -50%) scale(1);
                opacity: 1;
            }
        }

        /* Popup close animation */
        @keyframes popup-close-animation {
            0% {
                transform: translate(-50%, -50%) scale(1);
                opacity: 1;
            }

            100% {
                transform: translate(-50%, -50%) scale(0);
                opacity: 0;
            }
        }

        /* Add this to your existing CSS */
        body.dark .bg-white {
            background-color: #4B5563;
            /* Dark background */
        }

        body.dark {
            background-color: var(--dark-bg);
            /* Ensure this is defined in your :root */
        }

        body.light {
            background-color: var(--light-bg);
            /* Ensure this is defined in your :root */
        }

        /* For Tailwind CSS */
        body.dark .content-area {
            background-color: #1F2937;
            /* Dark background */
        }

        body.light .content-area {
            background-color: #F9FAFB;
            /* Light background */
        }

        body.dark .text-gray-900 {
            color: #F3F4F6;
            /* Light text */
        }

        body.dark .text-gray-600 {
            color: #D1D5DB;
            /* Lighter gray text */
        }

        body.dark .border-gray-300 {
            border-color: #374151;
            /* Darker border */
        }

        /* Add other necessary styles for dark mode */
        body {
            font-family: 'Inter', system-ui, -apple-system, sans-serif;
            transition: background-color 0.3s, color 0.3s;
        }

        body.dark {
            background-color: var(--dark-bg);
            color: var(--text-light);
        }

        body.light {
            background-color: var(--light-bg);
            color: var(--text-dark);
        }

        .modal-backdrop {
            backdrop-filter: blur(5px);
            background-color: rgba(0, 0, 0, 0.5);
        }

        .gradient-bg {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
        }

        .card-hover {
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .card-hover:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1);
        }

        .sidebar {
            min-width: 250px;
            transform: translateX(0);
            transition: transform 0.3s ease;
        }

        .content-area {
            min-height: calc(100vh - 60px);
        }

        .sidebar-collapsed {
            transform: translateX(-100%);
        }

        .news-item {
            border-left: 4px solid var(--accent-color);
        }

        .calendar-container {
            height: 600px;
        }

        /* Theme toggle switch */
        .switch {
            position: relative;
            display: inline-block;
            width: 48px;
            height: 24px;
        }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 24px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked+.slider {
            background-color: #4F46E5;
        }

        input:checked+.slider:before {
            transform: translateX(24px);
        }

        /* Animations */
        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes scaleIn {
            from {
                opacity: 0;
                transform: scale(0.95);
            }

            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        @keyframes pulse {
            0% {
                transform: scale(0.95);
                box-shadow: 0 0 0 0 rgba(79, 70, 229, 0.7);
            }

            70% {
                transform: scale(1);
                box-shadow: 0 0 0 10px rgba(79, 70, 229, 0);
            }

            100% {
                transform: scale(0.95);
                box-shadow: 0 0 0 0 rgba(79, 70, 229, 0);
            }
        }

        .animate-fadeIn {
            animation: fadeIn 0.5s ease-out;
        }

        .animate-slideUp {
            animation: slideUp 0.6s cubic-bezier(0.16, 1, 0.3, 1);
        }

        .animate-scaleIn {
            animation: scaleIn 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .animate-delay-100 {
            animation-delay: 100ms;
        }

        .animate-delay-200 {
            animation-delay: 200ms;
        }

        .animate-delay-300 {
            animation-delay: 300ms;
        }

        .pulse-badge {
            animation: pulse 2s infinite;
        }

        /* Hover animations */
        .hover-scale {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .hover-scale:hover {
            transform: translateY(-2px) scale(1.02);
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1);
        }

        /* Button animations */
        .btn-animate {
            transition: all 0.3s ease;
            transform-origin: center;
        }

        .btn-animate:hover {
            transform: translateY(-2px) scale(1.05);
        }

        .btn-animate:active {
            transform: translateY(1px) scale(0.98);
        }

        /* Page transitions */
        .page-transition {
            animation: fadeIn 0.3s ease-out;
        }

        /* Loading skeleton */
        @keyframes shimmer {
            0% {
                background-position: -200% 0;
            }

            100% {
                background-position: 200% 0;
            }
        }

        .animate-shimmer {
            background: linear-gradient(90deg, #f3f4f6 25%, #e5e7eb 50%, #f3f4f6 75%);
            background-size: 200% 100%;
            animation: shimmer 1.5s infinite;
        }

        @keyframes pulse {
            0% {
                transform: scale(0.95);
                box-shadow: 0 0 0 0 rgba(79, 70, 229, 0.7);
            }

            70% {
                transform: scale(1);
                box-shadow: 0 0 0 10px rgba(79, 70, 229, 0);
            }

            100% {
                transform: scale(0.95);
                box-shadow: 0 0 0 0 rgba(79, 70, 229, 0);
            }
        }

        .breadcrumb-item::after {
            content: '/';
            margin: 0 0.5rem;
            color: #9CA3AF;
        }

        .breadcrumb-item:last-child::after {
            content: '';
        }


        /* PDF Optimization */
        @media print {

            .sidebar,
            .navbar {
                display: none;
            }

            .content-area {
                margin-left: 0 !important;
                width: 100% !important;
            }

            .hidden-print {
                display: none !important;
            }

            .page-container {
                display: block !important;
            }

            .tab-content>div {
                display: block !important;
                opacity: 1 !important;
                height: auto !important;
            }

            html,
            body {
                width: 100%;
                margin: 0;
                padding: 0;
            }
        }

        @media (min-width: 1024px) {
            .sidebar-collapsed {
                transform: translateX(0);
            }
        }

        /* Custom Scrollbar Styling for WebKit Browsers (Chrome, Safari, Edge) */
        .sidebar-nav-scroll::-webkit-scrollbar {
            width: 8px;
            /* Width of the scrollbar */
        }

        .sidebar-nav-scroll::-webkit-scrollbar-track {
            background: transparent;
            /* Make the track invisible */
            /* Or use a very dark shade matching the sidebar: background: #1e1b4b; */
            border-radius: 10px;
            /* Optional: Round the track ends */
        }

        .sidebar-nav-scroll::-webkit-scrollbar-thumb {
            background-color: #6366f1;
            /* Tailwind indigo-500 */
            border-radius: 10px;
            /* Round the thumb */
            border: 2px solid transparent;
            /* Optional: Create padding */
            background-clip: content-box;
            /* Make border area transparent */
        }

        .sidebar-nav-scroll::-webkit-scrollbar-thumb:hover {
            background-color: #818cf8;
            /* Tailwind indigo-400 */
        }

        /* Custom Scrollbar Styling for Firefox */
        /* Make sure the target element exists and styles apply */
        .sidebar-nav-scroll {
            /* scrollbar-width: thin; */
            /* Use 'thin' or 'auto' */
            /* scrollbar-color: #6366f1 transparent; */
            /* thumb color, track color */
            /* Better Firefox compatibility with auto width */
            scrollbar-width: auto;
            /* Or thin */
            scrollbar-color: #6366f1 #3730a3;
            /* Thumb color (indigo-500), Track color (indigo-800) */
        }


        /* Ensure the sidebar itself doesn't get a scrollbar if content overflows slightly due to padding/borders */
        #sidebar {
            overflow: hidden;
            /* Prevent the main sidebar container from scrolling */
        }

        /* Inside the main <style> block */


        /* Styles for Exam Schedule Generator Checkboxes */
        #checkboxContainer label {
            cursor: pointer;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            padding: 0.5rem 0.25rem;
            /* py-2 px-1 */
            border-bottom: 1px solid #e5e7eb;
            /* border-b border-gray-200 */
        }

        body.dark .checkbox-item {
            /* Dark mode border */
            border-bottom-color: #4b5563;
            /* dark:border-gray-600 */
        }

        .checkbox-item:last-child {
            border-bottom: none;
        }

        .checkbox-item input[type="checkbox"] {
            margin-left: 0.75rem;
            /* ml-3 */
            height: 1rem;
            /* h-4 */
            width: 1rem;
            /* w-4 */
            accent-color: #4F46E5;
            /* indigo-600 */
            flex-shrink: 0;
            /* Prevent checkbox from shrinking */
        }

        .checkbox-item label {
            flex-grow: 1;
            /* Allow label to take remaining space */
            word-break: break-word;
            /* Prevent long names from overflowing */
        }


        /* PDF Font Style (Optional for HTML view, essential for PDF JS) */
        /* @font-face {
    font-family: 'Amiri';
    src: url('Amiri-Regular.ttf') format('truetype'); /* Ensure path is correct */
        /* }
.pdf-font {
    font-family: 'Amiri', serif;
} */
        /* Basic table styling for PDF export consistency */
        #resultsTable th,
        #resultsTable td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: right;
            /* Default to right for Arabic */
        }

        body.dark #resultsTable th,
        body.dark #resultsTable td {
            border-color: #4b5563;
            /* dark:border-gray-600 */
        }

        #resultsTable th {
            background-color: #f3f4f6;
            /* bg-gray-100 */
            font-weight: 600;
            /* font-semibold */
        }

        body.dark #resultsTable th {
            background-color: #374151;
            /* dark:bg-gray-700 */
            color: #f9fafb;
            /* dark:text-gray-100 */
        }

        #resultsTable td {
            vertical-align: middle;
        }

        /* Center align specific columns if needed */
        #resultsTable th:nth-child(3),
        /* Code */
        #resultsTable td:nth-child(3),
        #resultsTable th:nth-child(7),
        /* Regulation */
        #resultsTable td:nth-child(7),
        #resultsTable th:nth-child(2),
        /* Date */
        #resultsTable td:nth-child(2),
        #resultsTable th:nth-child(6),
        /* Time */
        #resultsTable td:nth-child(6) {
            text-align: center;
        }

        /* Ensure specific fonts for buttons/headings if needed, inheriting from body usually works */
        #exam-schedule-page h1,
        #exam-schedule-page h2,
        #exam-schedule-page button {
            font-family: inherit;
            /* Inherit from body */
        }
    </style>
</head>

<script>
    // Function to set a cookie
    function setCookie(name, value, days) {
        let expires = "";
        if (days) {
            let date = new Date();
            date.setTime(date.getTime() + days * 24 * 60 * 60 * 1000);
            expires = "; expires=" + date.toUTCString();
        }
        document.cookie = name + "=" + value + "; path=/" + expires;
    }

    // Function to get a cookie value by name
    function getCookie(name) {
        let nameEQ = name + "=";
        let cookiesArray = document.cookie.split(";");
        for (let i = 0; i < cookiesArray.length; i++) {
            let cookie = cookiesArray[i].trim();
            if (cookie.indexOf(nameEQ) === 0) return cookie.substring(nameEQ.length);
        }
        return null;
    }

    // Function to update welcome message based on cookie
    function updateWelcomeMessage() {
        let welcomeMessage = document.getElementById("welcome-message");
        let visitCookie = getCookie("visited");

        if (visitCookie) {
            welcomeMessage.innerHTML = "Welcome back, <span id='dashboard-user-name'>User</span>!";
        } else {
            setCookie("visited", "true", 365); // Set cookie for one year
        }

        // Set current date
        document.getElementById("current-date").textContent = new Date().toLocaleDateString();
    }

    // Run the function when the page loads
    document.addEventListener("DOMContentLoaded", updateWelcomeMessage);
</script>

<body class="light">
    <!-- Welcome Modal (First Visit) -->
    <div id="welcome-modal" class="fixed inset-0 z-50 flex items-center justify-center modal-backdrop hidden">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl p-6 w-full max-w-md mx-4 animate-fadeIn">
            <h2 class="text-2xl font-bold text-gray-900 dark:text-white mb-4">Welcome to Team Shoky Helper!</h2>
            <p class="text-gray-600 dark:text-gray-300 mb-6">Please tell us a bit about yourself to personalize your
                experience.</p>

            <form id="user-info-form">
                <div class="mb-4">
                    <label for="userName" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Your
                        Name</label>
                    <input type="text" placeholder="Enter Your Name" id="userName"
                        class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"
                        required>
                </div>

                <div class="mb-4">
                    <label for="university"
                        class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">University</label>
                    <select id="university"
                        class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"
                        required>
                        <option value="" disabled selected>Select your university</option>
                        <option value="hti">HTI University</option>
                        <option value="other">Other</option>
                    </select>
                </div>

                <div id="other-university-container" class="mb-4 hidden">
                    <label for="otherUniversity"
                        class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">University Name</label>
                    <p> Call us to add Your University <a
                            href="https://wa.me/201090952790?text=Hello%20Team%20Shoky%2C%20I%20want%20to%20add%20my%20University."
                            class="text-indigo-600 dark:text-indigo-400 hover:text-indigo-500 transform hover:scale-110 transition duration-200">
                            <i class="fab fa-whatsapp"></i> WhatsApp
                        </a></p>
                </div>

                <div class="mb-4">
                    <label for="academicYear"
                        class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Academic Year</label>
                    <select id="academicYear"
                        class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"
                        required>
                        <option value="" disabled selected>Select your academic year</option>
                        <option value="1">Year 1</option>
                        <option value="2">Year 2</option>
                        <option value="3">Year 3</option>
                        <option value="4">Year 4</option>
                    </select>
                </div>

                <div class="mb-6">
                    <label for="group"
                        class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Group</label>
                    <select id="group"
                        class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"
                        required>
                        <option value="" disabled selected>Select your group</option>
                        <option value="1">Group 1</option>
                        <option value="2">Group 2</option>
                        <option value="3">Group 3</option>
                        <option value="4">Group 4</option>
                        <option value="5">Group 5</option>
                        <option value="6">Group 6</option>
                        <option value="7">Group 7</option>
                        <option value="8">Group 8</option>
                        <option value="100">Group 100</option>
                    </select>
                </div>

                <button type="submit"
                    class="w-full py-2 px-4 gradient-bg text-white font-medium rounded-md shadow-sm hover:opacity-90 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
                    Get Started
                </button>
            </form>
        </div>
    </div>

    <!-- Main Application Container -->
    <div class="flex h-screen overflow-hidden relative">
        <!-- Sidebar -->
        <div id="sidebar"
            class="sidebar bg-indigo-800 text-white h-screen flex flex-col flex-shrink-0 fixed left-0 top-0 bottom-0 z-30 transition-transform duration-300 ease-in-out transform">
            <!-- Sidebar Header (Fixed Top) -->
            <div class="p-4 flex items-center justify-between flex-shrink-0">
                <h1 class="text-xl font-bold" style="cursor: pointer;"> <a href="">Team Shoky Helper</a></h1>
                <button id="close-sidebar" aria-label="Close sidebar" class="lg:hidden text-white focus:outline-none">
                    <i class="fas fa-times"></i>
                </button>
            </div>

            <!-- User Info Block (Fixed Below Header) -->
            <div class="px-3 mt-4 mb-4 flex-shrink-0"> <!-- Adjusted margin -->
                <div id="user-info" class="px-3 py-4 bg-indigo-700 rounded-lg">
                    <div class="flex items-center mb-3">
                        <div
                            class="w-10 h-10 rounded-full bg-indigo-500 flex items-center justify-center text-lg font-semibold mr-3">
                            <span id="user-initials">U</span>
                        </div>
                        <div>
                            <h2 id="sidebar-user-name" class="font-medium">User Name</h2>
                            <p id="sidebar-university" class="text-xs text-indigo-200">University</p>
                        </div>
                    </div>
                    <div class="flex justify-between text-xs text-indigo-200">
                        <span>Year: <span id="sidebar-year">-</span></span>
                        <span>Group: <span id="sidebar-group">-</span></span>
                    </div>
                </div>
            </div>

            <!-- Scrollable Navigation Area -->
            <div class="flex-grow overflow-y-auto px-3 pb-4 sidebar-nav-scroll"> <!-- Make this div scrollable -->
                <nav>
                    <ul class="space-y-2">
                        <li>
                            <button data-page="dashboard"
                                class="nav-link w-full flex items-center px-3 py-2 rounded-md font-medium hover:bg-indigo-700 transition-colors">
                                <i class="fas fa-home w-6"></i>
                                <span>Home</span>
                            </button>
                        </li>
                        <li>
                            <button data-page="courses"
                                class="nav-link w-full flex items-center px-3 py-2 rounded-md font-medium hover:bg-indigo-700 transition-colors">
                                <i class="fas fa-book w-6"></i>
                                <span>Courses</span>
                            </button>
                        </li>
                        <!-- Add the Exam Tracker link here -->
                        <li>
                            <button data-page="exam-tracker"
                                class="nav-link w-full flex items-center px-3 py-2 rounded-md font-medium hover:bg-indigo-700 transition-colors">
                                <i class="fas fa-calendar-check w-6"></i>
                                <span>Exam Tracker</span>
                            </button>
                        </li>
                        <li>
                            <button data-page="news"
                                class="nav-link w-full flex items-center px-3 py-2 rounded-md font-medium hover:bg-indigo-700 transition-colors">
                                <i class="fas fa-newspaper w-6"></i>
                                <span>News</span>
                            </button>
                        </li>
                        <li>
                            <button data-page="communities"
                                class="nav-link w-full flex items-center px-3 py-2 rounded-md font-medium hover:bg-indigo-700 transition-colors">
                                <i class="fas fa-users w-6"></i>
                                <span>Communities</span>
                            </button>
                        </li>
                        <li>
                            <button data-page="tools"
                                class="nav-link w-full flex items-center px-3 py-2 rounded-md font-medium hover:bg-indigo-700 transition-colors">
                                <i class="fas fa-tools w-6"></i>
                                <span>Tools</span>
                            </button>
                        </li>
                        <li>
                            <button data-page="exam-schedule"
                                class="nav-link w-full flex items-center px-3 py-2 rounded-md font-medium hover:bg-indigo-700 transition-colors">
                                <i class="fas fa-calendar-alt w-6"></i> <!-- Example Icon -->
                                <span>Exam Schedule</span>
                            </button>
                        </li>
                        <li>
                            <button data-page="about-us"
                                class="nav-link w-full flex items-center px-3 py-2 rounded-md font-medium hover:bg-indigo-700 transition-colors">
                                <i class="fas fa-info-circle w-6"></i>
                                <span>About Us</span>
                            </button>
                        </li>
                        <!-- Settings button MOVED to footer -->
                        <!-- Install App button stays here -->
                        <li id="install-app-button-container" class="hidden">
                            <button id="install-app-button"
                                class=" w-full flex items-center px-3 py-2 rounded-md font-medium hover:bg-indigo-700 transition-colors">
                                <i class="fas fa-download w-6"></i>
                                <span>Download App</span>
                            </button>
                        </li>
                        <!-- Add any other less critical navigation items here -->

                    </ul>
                </nav>
            </div> <!-- End Scrollable Area -->

            <!-- Sidebar Footer (Fixed Bottom) -->
            <div class="px-4 py-4 border-t border-indigo-700 flex-shrink-0"> <!-- Add border -->
                <!-- Settings Button Moved Here -->
                <button data-page="settings"
                    class="nav-link w-full flex items-center px-3 py-2 mb-3 rounded-md font-medium hover:bg-indigo-700 transition-colors">
                    <i class="fas fa-cog w-6"></i>
                    <span>Settings</span>
                </button>
                <!-- Logout Button Moved Here -->
                <button id="logout-button"
                    class="w-full mb-3 py-2 px-4 bg-red-600 text-white font-medium rounded-md shadow-sm hover:bg-red-700 transition-colors">
                    Logout
                </button>
                <!-- Theme and Copyright -->
                <div class="flex justify-between items-center text-indigo-200 text-sm">
                    <span>Â© 2025 Team Shoky</span>
                    <button id="theme-toggle" aria-label="Toggle theme" class="hover:text-white">
                        <!-- <i class="fas fa-moon"></i> -->
                    </button>
                </div>
            </div>

        </div> <!-- End Sidebar -->

        <!-- Main Content -->
        <div class="flex-1 flex flex-col ml-0 lg:ml-64 transition-all duration-300">
            <!-- Navbar -->
            <header class="bg-white dark:bg-gray-800 shadow-sm h-16 flex items-center px-4 sticky top-0 z-20">
                <button id="open-sidebar" aria-label="Open sidebar"
                    class="lg:hidden mr-4 text-gray-600 dark:text-gray-300 focus:outline-none">
                    <i class="fas fa-bars"></i>
                </button>

                <div class="flex-1 flex items-center">
                    <div id="breadcrumbs" class="hidden sm:flex items-center text-sm text-gray-500 dark:text-gray-400">
                        <span class="breadcrumb-item">Team Shoky Helper</span>
                        <span id="current-page-breadcrumb"
                            class="breadcrumb-item text-indigo-600 dark:text-indigo-400">Dashboard</span>
                    </div>
                </div>

                <div class="flex items-center space-x-4">
                    <div class="relative">
                        <button id="notification-button" class="text-gray-600 dark:text-gray-300 focus:outline-none">
                            <i class="fas fa-bell"></i>
                            <span id="notification-badge"
                                class="absolute -top-1 -right-1 bg-red-500 text-white rounded-full w-4 h-4 flex items-center justify-center text-xs pulse-badge">0</span>
                        </button>
                    </div>

                    <div class="relative">
                        <!-- User Profile Button -->
                        <div class="flex items-center">
                            <button id="user-menu-button"
                                class="w-8 h-8 rounded-full bg-indigo-600 flex items-center justify-center text-white focus:outline-none">
                                <span id="nav-user-initials">U</span>
                            </button>
                            <span id="nav-user-name" class="ml-2 text-sm font-medium hidden sm:inline-block">User
                                Name</span>
                        </div>

                        <!-- Dropdown Panel -->
                        <div id="user-dropdown"
                            class="absolute right-0 mt-2 w-40 bg-white dark:bg-gray-800 shadow-lg rounded-lg p-2 hidden">
                            <a href="/" style="cursor: pointer;"
                                class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700">hi
                                : <span id="dropdown_usrname">User</span> </a>
                            <hr class="my-1 border-gray-300 dark:border-gray-600">
                            <a data-page="settings" style="cursor: pointer;"
                                class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700">Settings</a>
                        </div>
                    </div>

                    <!-- JavaScript for Toggle -->
                    <script>
                        document.addEventListener("DOMContentLoaded", function () {
                            const userButton = document.getElementById("user-menu-button");
                            const dropdown = document.getElementById("user-dropdown");

                            userButton.addEventListener("click", function (event) {
                                dropdown.classList.toggle("hidden");
                                event.stopPropagation(); // Prevents click from closing immediately
                            });

                            // Close dropdown when clicking outside
                            document.addEventListener("click", function (event) {
                                if (!dropdown.contains(event.target) && event.target !== userButton) {
                                    dropdown.classList.add("hidden");
                                }
                            });
                        });
                    </script>

                </div>
            </header>

            <!-- Content Area -->
            <main class="flex-1 overflow-x-hidden overflow-y-auto bg-gray-100 dark:bg-gray-900 p-4 md:p-6 content-area">
                <div id="tab-content" class="tab-content">
                    <!-- Dashboard Page -->
                    <div id="dashboard-page" class="page-container animate-fadeIn">
                        <h1 class="text-2xl font-bold mb-6">Home</h1>

                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
                            <!-- Welcome Card -->
                            <div
                                class="bg-gradient-to-r from-indigo-600 to-purple-600 rounded-xl text-white p-6 shadow-lg col-span-full lg:col-span-2">
                                <div class="flex items-center">
                                    <div>
                                        <h2 class="text-xl font-semibold" id="welcome-message">Welcome, <span
                                                id="dashboard-user-name">User</span>!</h2>
                                        <p class="mt-2 opacity-90">Today is <span id="current-date"></span></p>
                                        <div class="mt-4">
                                            <button data-page="settings"
                                                class="bg-white text-indigo-600 px-4 py-2 rounded-md text-sm font-medium hover:bg-opacity-90 transition-colors">
                                                Edit Your Profile
                                            </button>
                                        </div>
                                    </div>
                                    <div class="ml-auto hidden md:block">
                                        <i class="fas fa-user-graduate text-6xl opacity-80"></i>
                                    </div>
                                </div>
                            </div>

                            <!-- Upcoming Lectures Card -->
                            <div class="bg-white dark:bg-gray-800 rounded-xl p-6 shadow-md card-hover">
                                <div class="flex items-center justify-between mb-4">
                                    <h3 class="text-lg font-semibold">Upcoming Lectures</h3>
                                    <span
                                        class="text-xs bg-indigo-100 dark:bg-indigo-900 text-indigo-800 dark:text-indigo-200 px-2 py-1 rounded-full">Next
                                        7 days</span>
                                </div>
                                <div id="upcoming-lectures" class="space-y-3">
                                    <!-- Dynamically populated -->
                                </div>

                            </div>
                        </div>

                        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                            <!-- Recent Materials -->
                            <div class="bg-white dark:bg-gray-800 rounded-xl p-6 shadow-md lg:col-span-2 card-hover">
                                <div class="flex items-center justify-between mb-4">
                                    <h3 class="text-lg font-semibold">Recent Materials</h3>
                                    <span
                                        class="text-xs bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200 px-2 py-1 rounded-full">New</span>
                                </div>

                                <div id="recent-materials" class="space-y-4">
                                    <!-- Dynamically populated -->
                                </div>

                                <button data-page="courses"
                                    class="nav-link mt-4 text-sm text-indigo-600 dark:text-indigo-400 hover:underline w-full text-center">
                                    View All Courses
                                </button>
                            </div>

                            <!-- Latest News -->
                            <div class="bg-white dark:bg-gray-800 rounded-xl p-6 shadow-md card-hover">
                                <div class="flex items-center justify-between mb-4">
                                    <h3 class="text-lg font-semibold">Latest News</h3>
                                </div>

                                <div id="dashboard-news" class="space-y-4">
                                    <!-- Dynamically populated -->
                                </div>

                                <button data-page="news"
                                    class="nav-link mt-4 text-sm text-indigo-600 dark:text-indigo-400 hover:underline w-full text-center">
                                    View All News
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Courses Page -->
                    <div id="courses-page" class="page-container hidden animate-fadeIn">
                        <div class="flex justify-between items-center mb-6">
                            <h1 class="text-2xl font-bold">My Courses</h1>

                            <div class="relative">
                                <input type="text" id="course-search" placeholder="Search courses..."
                                    class="w-full sm:w-64 pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-700 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 bg-white dark:bg-gray-800">
                                <div class="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400">
                                    <i class="fas fa-search"></i>
                                </div>
                            </div>
                        </div>

                        <div id="courses-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                            <!-- Dynamically populated -->
                        </div>
                    </div>

                    <!-- Course Details Page -->
                    <div id="course-details-page" class="page-container hidden animate-fadeIn">
                        <button id="back-to-courses"
                            class="flex items-center text-indigo-600 dark:text-indigo-400 mb-4 hover:underline">
                            <i class="fas fa-arrow-left mr-2"></i> Back to Courses
                        </button>

                        <div id="course-details-content">
                            <!-- Dynamically populated -->
                        </div>
                    </div>

                    <!-- Lectures Page -->
                    <div id="lectures-page" class="page-container hidden animate-fadeIn">
                        <h1 class="text-2xl font-bold mb-6">Lecture Schedule</h1>

                        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-md p-4 mb-6">
                            <div class="flex flex-wrap items-center gap-4">
                                <button id="view-calendar"
                                    class="px-4 py-2 rounded-md bg-indigo-600 text-white hover:bg-indigo-700">Calendar
                                    View</button>
                                <button id="view-list"
                                    class="px-4 py-2 rounded-md bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-white hover:bg-gray-300 dark:hover:bg-gray-600">List
                                    View</button>
                            </div>
                        </div>

                        <div id="calendar-view"
                            class="bg-white dark:bg-gray-800 rounded-xl shadow-md p-4 calendar-container">
                            <!-- FullCalendar will be mounted here -->
                        </div>

                        <div id="list-view" class="bg-white dark:bg-gray-800 rounded-xl shadow-md p-4 hidden">
                            <div class="overflow-x-auto">
                                <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                                    <thead>
                                        <tr>
                                            <th
                                                class="px-6 py-3 bg-gray-50 dark:bg-gray-900 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                                                Date & Time</th>
                                            <th
                                                class="px-6 py-3 bg-gray-50 dark:bg-gray-900 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                                                Course</th>
                                            <th
                                                class="px-6 py-3 bg-gray-50 dark:bg-gray-900 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                                                Location</th>
                                            <th
                                                class="px-6 py-3 bg-gray-50 dark:bg-gray-900 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                                                Instructor</th>
                                        </tr>
                                    </thead>
                                    <tbody id="lecture-list"
                                        class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700">
                                        <!-- Dynamically populated -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- News Page -->
                    <div id="news-page" class="page-container hidden animate-fadeIn">
                        <h1 class="text-2xl font-bold mb-6">University News</h1>

                        <div id="news-container" class="space-y-6">
                            <!-- Dynamically populated -->
                        </div>
                    </div>

                    <!-- Inside <main id="tab-content" class="tab-content"> -->

                    <!-- ... other page containers ... -->

                    <!-- START: Exam Schedule Generator Page -->
                    <div id="exam-schedule-page" class="page-container hidden animate-fadeIn">
                        <h1 class="text-2xl font-bold mb-6">Exam Schedule Generator</h1>
                        <p class="text-gray-600 dark:text-gray-300 mb-6">Select your courses to generate a personalized
                            final exam schedule based on the official data (Computer Science - May/Jan 2024/2025).</p>

                        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-md p-6">
                            <!-- Course Selection Area -->
                            <div
                                class="mb-8 p-6 bg-indigo-50 dark:bg-indigo-900 rounded-lg border border-indigo-200 dark:border-indigo-700">
                                <label class="block text-lg font-semibold text-gray-700 dark:text-gray-200 mb-3">Select
                                    Your Courses:</label>
                                <div id="checkboxContainer"
                                    class="mb-4 max-h-60 overflow-y-auto border border-gray-300 dark:border-gray-600 rounded-md p-4 bg-gray-50 dark:bg-gray-700">
                                    <!-- Checkboxes will be populated here by JavaScript -->
                                    <p class="text-gray-500 dark:text-gray-400">Loading available courses...</p>
                                </div>
                                <button id="generateScheduleBtn" class="mt-4 w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-6
                                    rounded-md transition duration-150 ease-in-out focus:outline-none focus:ring-2
                                    focus:ring-offset-2 focus:ring-indigo-500 text-lg">
                                    Generate My Schedule
                                </button>
                            </div>
                            <!-- End Course Selection Area -->

                            <!-- Results Area -->
                            <div id="scheduleOutput" class="mt-10 hidden">
                                <hr class="my-6 border-gray-300 dark:border-gray-600">
                                <div class="flex justify-between items-center mb-4 flex-wrap gap-2">
                                    <!-- Added flex-wrap and gap -->
                                    <h2 class="text-2xl font-semibold text-indigo-800 dark:text-indigo-300">Your Custom
                                        Schedule:</h2>
                                    <button id="exportPdfBtn"
                                        class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-md transition duration-150 ease-in-out focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500">
                                        <i class="fas fa-file-pdf mr-1"></i> Export PDF
                                    </button>
                                </div>
                                <div class="overflow-x-auto bg-white dark:bg-gray-800 rounded-lg shadow">
                                    <table id="resultsTable"
                                        class="w-full text-sm text-right text-gray-700 dark:text-gray-200">
                                        <!-- Added dark mode text -->
                                        <thead
                                            class="text-xs text-gray-800 dark:text-gray-100 uppercase bg-indigo-100 dark:bg-indigo-900">
                                            <!-- Added dark mode styles -->
                                            <tr>
                                                <th scope="col" class="px-6 py-3">Day</th>
                                                <th scope="col" class="px-6 py-3">Date</th>
                                                <th scope="col" class="px-6 py-3">Code</th>
                                                <th scope="col" class="px-6 py-3">Course Name</th>
                                                <th scope="col" class="px-6 py-3">Period</th>
                                                <th scope="col" class="px-6 py-3">Time</th>
                                                <th scope="col" class="px-6 py-3">Regulation</th>
                                            </tr>
                                        </thead>
                                        <tbody id="resultsBody" class="divide-y divide-gray-200 dark:divide-gray-700">
                                            <!-- Added dark mode divider -->
                                            <!-- Rows will be inserted here by JavaScript -->
                                        </tbody>
                                    </table>
                                </div>
                                <p id="noResults" class="text-center text-red-600 font-semibold mt-6 hidden">No exams
                                    found matching your selected courses.</p>
                            </div>
                            <!-- End Results Area -->
                        </div>
                    </div>
                    <!-- END: Exam Schedule Generator Page -->

                    <!-- ... rest of the main content ... -->

                    <!-- Settings Page -->
                    <div id="settings-page" class="page-container hidden animate-fadeIn">
                        <h1 class="text-2xl font-bold mb-6">Settings</h1>

                        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-md p-6 mb-6">
                            <h2 class="text-xl font-semibold mb-4">Personal Information</h2>

                            <form id="settings-form" class="space-y-4">
                                <div>
                                    <label for="settings-name"
                                        class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Your
                                        Name</label>
                                    <input type="text" id="settings-name"
                                        class="w-full px-3 py-2 border border-gray-300 dark:border-gray-700 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 bg-white dark:bg-gray-900">
                                </div>

                                <div>
                                    <label for="settings-university"
                                        class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">University</label>
                                    <select id="settings-university"
                                        class="w-full px-3 py-2 border border-gray-300 dark:border-gray-700 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 bg-white dark:bg-gray-900">
                                        <option value="hti">HTI University</option>
                                        <option value="other">Other</option>
                                    </select>
                                </div>

                                <div id="settings-other-university-container" class="hidden">
                                    <label for="otherUniversity"
                                        class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">University
                                        Name</label>
                                    <p> Call us to add Your University <a
                                            href="https://wa.me/201090952790?text=Hello%20Team%20Shoky%2C%20I%20want%20to%20add%20my%20University."
                                            class="text-indigo-600 dark:text-indigo-400 hover:text-indigo-500 transform hover:scale-110 transition duration-200">
                                            <i class="fab fa-whatsapp"></i> WhatsApp
                                        </a></p>
                                </div>

                                <div>
                                    <label for="settings-year"
                                        class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Academic
                                        Year</label>
                                    <select id="settings-year"
                                        class="w-full px-3 py-2 border border-gray-300 dark:border-gray-700 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 bg-white dark:bg-gray-900">
                                        <option value="1">Year 1</option>
                                        <option value="2">Year 2</option>
                                        <option value="3">Year 3</option>
                                        <option value="4">Year 4</option>
                                    </select>
                                </div>

                                <div>
                                    <label for="settings-group"
                                        class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Group</label>
                                    <select id="settings-group"
                                        class="w-full px-3 py-2 border border-gray-300 dark:border-gray-700 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 bg-white dark:bg-gray-900">
                                        <option value="1">Group 1</option>
                                        <option value="2">Group 2</option>
                                    </select>
                                </div>

                                <button type="submit"
                                    class="w-full sm:w-auto py-2 px-4 gradient-bg text-white font-medium rounded-md shadow-sm hover:opacity-90 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
                                    Save Changes
                                </button>
                            </form>
                        </div>

                        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-md p-6 mb-6">
                            <h2 class="text-xl font-semibold mb-4">Preferences</h2>

                            <div class="space-y-4">
                                <div class="flex items-center justify-between">
                                    <div>
                                        <!-- <h3 class="font-medium">Dark Mode</h3> -->
                                        <!-- <p class="text-sm text-gray-500 dark:text-gray-400">Toggle dark/light theme</p> -->
                                    </div>
                                    <label class="switch">
                                        <input type="checkbox" id="settings-theme-toggle">
                                        <!-- <span class="slider"></span> -->
                                    </label>
                                </div>

                                <div class="flex items-center justify-between">
                                    <div>
                                        <h3 class="font-medium">Notifications</h3>
                                        <p class="text-sm text-gray-500 dark:text-gray-400">Enable in-app notifications
                                        </p>
                                    </div>
                                    <label class="switch">
                                        <input type="checkbox" id="settings-notifications-toggle" checked>
                                        <span class="slider"></span>
                                    </label>
                                </div>
                            </div>
                        </div>

                        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-md p-6">
                            <h2 class="text-xl font-semibold mb-4">About Team Shoky Helper</h2>

                            <p class="text-gray-600 dark:text-gray-300 mb-4">
                                Team Shoky Helper is a modern web application designed for college students to access
                                their
                                courses, lecture schedules, and university news.
                            </p>

                            <p class="text-gray-600 dark:text-gray-300">
                                Version 1.0.0 - Last Updated: April 20, 2025
                            </p>
                        </div>
                    </div>

                    <!-- Tools Page -->
                    <div id="tools-page" class="page-container hidden animate-fadeIn">
                        <h1 class="text-2xl font-bold mb-6">Student Tools</h1>

                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                            <!-- Todo List -->
                            <div class="bg-white dark:bg-gray-800 rounded-xl shadow-md p-6 card-hover">
                                <div class="flex justify-between items-center mb-4">
                                    <h2 class="text-xl font-semibold">Todo List</h2>
                                    <button id="add-todo"
                                        class="p-2 rounded-full bg-indigo-100 dark:bg-indigo-900 text-indigo-600 dark:text-indigo-300 hover:bg-indigo-200 dark:hover:bg-indigo-800">
                                        <i class="fas fa-plus"></i>
                                    </button>
                                </div>

                                <div id="todo-input-container" class="hidden mb-4">
                                    <input type="text" id="new-todo" placeholder="Add a new task..."
                                        class="w-full px-3 py-2 border border-gray-300 dark:border-gray-700 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 bg-white dark:bg-gray-900">
                                    <div class="flex justify-end mt-2 space-x-2">
                                        <button id="cancel-todo"
                                            class="px-3 py-1 text-sm text-gray-600 dark:text-gray-300 hover:text-gray-800 dark:hover:text-gray-100">Cancel</button>
                                        <button id="save-todo"
                                            class="px-3 py-1 text-sm bg-indigo-600 text-white rounded-md hover:bg-indigo-700">Add</button>
                                    </div>
                                </div>

                                <ul id="todo-list" class="space-y-2">
                                    <!-- Todo items will be added here dynamically -->
                                </ul>
                            </div>

                            <!-- Sticky Notes -->
                            <div class="bg-white dark:bg-gray-800 rounded-xl shadow-md p-6 card-hover">
                                <div class="flex justify-between items-center mb-4">
                                    <h2 class="text-xl font-semibold">Sticky Notes</h2>
                                    <div class="flex space-x-2">
                                        <button class="color-picker p-2 rounded-full bg-yellow-200 hover:bg-yellow-300"
                                            data-color="yellow"></button>
                                        <button class="color-picker p-2 rounded-full bg-blue-200 hover:bg-blue-300"
                                            data-color="blue"></button>
                                        <button class="color-picker p-2 rounded-full bg-green-200 hover:bg-green-300"
                                            data-color="green"></button>
                                        <button class="color-picker p-2 rounded-full bg-pink-200 hover:bg-pink-300"
                                            data-color="pink"></button>
                                        <button id="add-note"
                                            class="p-2 rounded-full bg-indigo-100 dark:bg-indigo-900 text-indigo-600 dark:text-indigo-300 hover:bg-indigo-200 dark:hover:bg-indigo-800">
                                            <i class="fas fa-plus"></i>
                                        </button>
                                    </div>
                                </div>

                                <div id="notes-container" class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                                    <!-- Sticky notes will be added here dynamically -->
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- START: Exam Tracker Page -->
                    <div id="exam-tracker-page" class="page-container hidden animate-fadeIn">
                        <h1 class="text-2xl font-bold mb-6">Exam & Task Tracker</h1>

                        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-md p-6">
                            <h2 class="text-xl font-semibold mb-4">Upcoming Deadlines (<span id="exam-tracker-year">Year
                                    X</span>)</h2>
                            <div id="exam-tracker-container" class="space-y-4">
                                <!-- Exam/Task items will be dynamically added here -->
                                <p class="text-gray-500 dark:text-gray-400 text-center p-4">Loading Deadlines...</p>
                            </div>
                        </div>
                    </div>
                    <!-- END: Exam Tracker Page -->

                    <!-- Communities Page -->
                    <div id="communities-page" class="page-container hidden animate-fadeIn">
                        <h1 class="text-3xl font-bold mb-6 text-center text-gray-800 dark:text-gray-100">University
                            Communities</h1>
                        <p class="text-lg text-gray-600 dark:text-gray-300 text-center mb-8 max-w-2xl mx-auto">
                            Discover and join vibrant communities at HTI University. Expand your network, develop new
                            skills, and enhance your college experience.
                        </p>

                        <!-- Communities Grid -->
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8" id="communities-container">
                            <!-- CyberCrew Card -->
                            <div
                                class="bg-white dark:bg-gray-800 rounded-xl shadow-xl overflow-hidden transform hover:scale-105 transition duration-300 ease-in-out">
                                <div class="h-40 bg-gradient-to-r from-blue-600 to-red-500 relative">
                                    <div class="absolute inset-0 flex items-center justify-center">
                                        <i class="fas fa-shield-alt text-6xl text-white opacity-80"></i>
                                    </div>
                                </div>
                                <div class="p-6">
                                    <div class="flex justify-between items-start">
                                        <h3 class="text-2xl font-semibold text-gray-800 dark:text-gray-100">CyberCrew
                                        </h3>
                                        <span
                                            class="bg-blue-100 text-blue-800 text-xs font-medium px-2.5 py-0.5 rounded dark:bg-blue-900 dark:text-blue-300">Security</span>
                                    </div>
                                    <p class="text-gray-600 dark:text-gray-300 mt-4">
                                        HTI's cybersecurity community focused on ethical hacking, network security, and
                                        digital forensics. Join us to develop security skills through workshops, CTF
                                        competitions, and hands-on projects.
                                    </p>
                                    <div class="mt-6 flex justify-between items-center">
                                        <span class="text-sm text-gray-500 dark:text-gray-400"><i
                                                class="fas fa-users mr-2"></i>X+ members</span>
                                        <a href="https://linktr.ee/cyber_crew" target="_blank"
                                            class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors">Join
                                            Community</a>
                                    </div>
                                    <!-- Social Media Links -->
                                    <div class="mt-4 pt-4 border-t border-gray-200 dark:border-gray-700">
                                        <p class="text-sm text-gray-500 dark:text-gray-400 mb-2">Connect with us:</p>
                                        <div class="flex space-x-3">
                                            <a href="https://chat.whatsapp.com/GJ1QtxlvLAb8sEGZj2cHVV" target="_blank"
                                                class="flex items-center justify-center w-10 h-10 rounded-full bg-green-100 dark:bg-green-900 text-green-600 dark:text-green-400 hover:bg-green-200 dark:hover:bg-green-800 transition-colors">
                                                <i class="fab fa-whatsapp fa-lg"></i>
                                            </a>
                                            <a href="https://www.facebook.com/CyberCrewHTI" target="_blank"
                                                class="flex items-center justify-center w-10 h-10 rounded-full bg-blue-100 dark:bg-blue-900 text-blue-600 dark:text-blue-400 hover:bg-blue-200 dark:hover:bg-blue-800 transition-colors">
                                                <i class="fab fa-facebook fa-lg"></i>
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- IEEE HTI Card -->
                            <div
                                class="bg-white dark:bg-gray-800 rounded-xl shadow-xl overflow-hidden transform hover:scale-105 transition duration-300 ease-in-out">
                                <div class="h-40 bg-gradient-to-r from-indigo-600 to-blue-500 relative">
                                    <div class="absolute inset-0 flex items-center justify-center">
                                        <i class="fas fa-microchip text-6xl text-white opacity-80"></i>
                                    </div>
                                </div>
                                <div class="p-6">
                                    <div class="flex justify-between items-start">
                                        <h3 class="text-2xl font-semibold text-gray-800 dark:text-gray-100">IEEE HTI
                                        </h3>
                                        <span
                                            class="bg-indigo-100 text-indigo-800 text-xs font-medium px-2.5 py-0.5 rounded dark:bg-indigo-900 dark:text-indigo-300">Engineering</span>
                                    </div>
                                    <p class="text-gray-600 dark:text-gray-300 mt-4">
                                        The IEEE HTI Student Branch connects you with a global network of professionals.
                                        Participate in technical workshops, leadership training, and innovative projects
                                        to enhance your engineering career.
                                    </p>
                                    <div class="mt-6 flex justify-between items-center">
                                        <span class="text-sm text-gray-500 dark:text-gray-400"><i
                                                class="fas fa-users mr-2"></i>X+ members</span>
                                        <!-- <a href="#"
                                            class="px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 transition-colors">Join
                                            Community</a> -->
                                    </div>
                                    <!-- Social Media Links -->
                                    <div class="mt-4 pt-4 border-t border-gray-200 dark:border-gray-700">
                                        <p class="text-sm text-gray-500 dark:text-gray-400 mb-2">Connect with us:</p>
                                        <div class="flex space-x-3">
                                            <!-- <a href="https://www.facebook.com/IEEEHTISB1" target="_blank"
                                                class="flex items-center justify-center w-10 h-10 rounded-full bg-green-100 dark:bg-green-900 text-green-600 dark:text-green-400 hover:bg-green-200 dark:hover:bg-green-800 transition-colors">
                                                <i class="fab fa-whatsapp fa-lg"></i>
                                            </a> -->
                                            <a href="https://www.facebook.com/IEEEHTISB1" target="_blank"
                                                class="flex items-center justify-center w-10 h-10 rounded-full bg-blue-100 dark:bg-blue-900 text-blue-600 dark:text-blue-400 hover:bg-blue-200 dark:hover:bg-blue-800 transition-colors">
                                                <i class="fab fa-facebook fa-lg"></i>
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- ICPC Card -->
                            <div
                                class="bg-white dark:bg-gray-800 rounded-xl shadow-xl overflow-hidden transform hover:scale-105 transition duration-300 ease-in-out">
                                <div class="h-40 bg-gradient-to-r from-purple-600 to-pink-500 relative">
                                    <div class="absolute inset-0 flex items-center justify-center">
                                        <i class="fas fa-code text-6xl text-white opacity-80"></i>
                                    </div>
                                </div>
                                <div class="p-6">
                                    <div class="flex justify-between items-start">
                                        <h3 class="text-2xl font-semibold text-gray-800 dark:text-gray-100">ICPC HTI
                                        </h3>
                                        <span
                                            class="bg-purple-100 text-purple-800 text-xs font-medium px-2.5 py-0.5 rounded dark:bg-purple-900 dark:text-purple-300">Competitive
                                            Programming</span>
                                    </div>
                                    <p class="text-gray-600 dark:text-gray-300 mt-4">
                                        The International Collegiate Programming Contest team at HTI. Sharpen your
                                        problem-solving and coding skills through regular training sessions and compete
                                        in regional and international programming competitions.
                                    </p>
                                    <div class="mt-6 flex justify-between items-center">
                                        <span class="text-sm text-gray-500 dark:text-gray-400"><i
                                                class="fas fa-users mr-2"></i>3k+ members</span>
                                        <!-- <a href="https://icpc-hti-community.vercel.app/"
                                            class="px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 transition-colors">Join
                                            Community</a> -->
                                    </div>
                                    <!-- Social Media Links -->
                                    <div class="mt-4 pt-4 border-t border-gray-200 dark:border-gray-700">
                                        <p class="text-sm text-gray-500 dark:text-gray-400 mb-2">Connect with us:</p>
                                        <div class="flex space-x-3">
                                            <!-- <a href="#" target="_blank"
                                                class="flex items-center justify-center w-10 h-10 rounded-full bg-green-100 dark:bg-green-900 text-green-600 dark:text-green-400 hover:bg-green-200 dark:hover:bg-green-800 transition-colors">
                                                <i class="fab fa-whatsapp fa-lg"></i>
                                            </a> -->
                                            <a href="https://www.facebook.com/icpchti" target="_blank"
                                                class="flex items-center justify-center w-10 h-10 rounded-full bg-blue-100 dark:bg-blue-900 text-blue-600 dark:text-blue-400 hover:bg-blue-200 dark:hover:bg-blue-800 transition-colors">
                                                <i class="fab fa-facebook fa-lg"></i>
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- ASI HTI card  -->
                            <div
                                class="bg-white dark:bg-gray-800 rounded-xl shadow-xl overflow-hidden transform hover:scale-105 transition duration-300 ease-in-out">
                                <div class="h-40 bg-gradient-to-r from-purple-600 to-pink-500 relative">
                                    <div class="absolute inset-0 flex items-center justify-center">
                                        <i class="fas fa-robot text-6xl text-white opacity-80 mb-4"></i>
                                    </div>
                                </div>
                                <div class="p-6">
                                    <div class="flex justify-between items-start">
                                        <h3 class="text-2xl font-semibold text-gray-800 dark:text-gray-100">ASI HTI
                                        </h3>
                                        <span
                                            class="bg-purple-100 text-purple-800 text-xs font-medium px-2.5 py-0.5 rounded dark:bg-purple-900 dark:text-purple-300">AI</span>
                                    </div>
                                    <p class="text-gray-600 dark:text-gray-300 mt-4">
                                        ASI is a student-led community at the Higher Technological Institute that aims
                                        to spread awareness about Artificial Intelligence and Data Science. We help
                                        students explore real-world applications of AI, build technical skills, and
                                        connect with peers through workshops, competitions, and training opportunities.
                                    </p>
                                    <div class="mt-6 flex justify-between items-center">
                                        <span class="text-sm text-gray-500 dark:text-gray-400"><i
                                                class="fas fa-users mr-2"></i>120+ members</span>
                                        <a href="https://linktr.ee/ASI_HTI"
                                            class="px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 transition-colors">Join
                                            Community</a>
                                    </div>
                                    <!-- Social Media Links -->
                                    <div class="mt-4 pt-4 border-t border-gray-200 dark:border-gray-700">
                                        <p class="text-sm text-gray-500 dark:text-gray-400 mb-2">Connect with us:</p>
                                        <div class="flex space-x-3">
                                            <a href="https://chat.whatsapp.com/HFhVYl0TnME6aptIxJcdY6" target="_blank"
                                                class="flex items-center justify-center w-10 h-10 rounded-full bg-green-100 dark:bg-green-900 text-green-600 dark:text-green-400 hover:bg-green-200 dark:hover:bg-green-800 transition-colors">
                                                <i class="fab fa-whatsapp fa-lg"></i>
                                            </a>
                                            <a href="https://www.facebook.com/share/154J9tXUjG/" target="_blank"
                                                class="flex items-center justify-center w-10 h-10 rounded-full bg-blue-100 dark:bg-blue-900 text-blue-600 dark:text-blue-400 hover:bg-blue-200 dark:hover:bg-blue-800 transition-colors">
                                                <i class="fab fa-facebook fa-lg"></i>
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- About Us Page -->
                    <div id="about-us-page" class="page-container hidden animate-fadeIn">
                        <h1 class="text-3xl font-bold mb-6 text-center text-gray-800 dark:text-gray-100">Meet the
                            Brilliant Minds Behind Our Platform</h1>
                        <p class="text-lg text-gray-600 dark:text-gray-300 text-center mb-8 max-w-2xl mx-auto">
                            Our team of skilled developers, meticulous data collectors, and visionary owners have worked
                            tirelessly to create this dynamic platform.
                            Learn more about the individuals who brought this project to life.
                        </p>
                        <!-- Owners Section -->
                        <h2 class="text-2xl font-semibold mb-6 mt-12 text-gray-800 dark:text-gray-100">Team Shoky Owners
                        </h2>
                        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8">
                            <!-- 1 Owner Card with Background Cover Photo -->
                            <div
                                class="relative bg-white dark:bg-gray-800 rounded-xl shadow-xl overflow-hidden transform hover:scale-105 transition duration-300 ease-in-out p-8">
                                <!-- Cover Photo -->
                                <div class="absolute inset-0">
                                    <img loading="lazy" src="youseftamer_profile.jpg"
                                        alt="Yousef Tamer - Head of Team Shoky"
                                        class="w-full h-full object-cover opacity-30">
                                </div>

                                <!-- Profile Section -->
                                <div class="relative flex flex-col items-center">
                                    <div class="w-40 h-40 rounded-full border-4 border-indigo-500 overflow-hidden">
                                        <img loading="lazy" src="youseftamer_profile.jpg"
                                            alt="Yousef Tamer - Head of Team Shoky" class="w-full h-full object-cover">
                                    </div>
                                    <h3 class="text-2xl font-semibold text-gray-800 dark:text-gray-100 mt-4">Yousef
                                        Tamer</h3>
                                    <p class="text-lg text-gray-500 dark:text-gray-400">Head of Team Shoky</p>
                                    <div class="flex space-x-4 mt-4">
                                        <!-- Mail Icon -->
                                        <a href="mailto:youseftamereg@gmail.com"
                                            class="text-indigo-600 dark:text-indigo-400 hover:text-indigo-500 transform hover:scale-110 transition duration-200">
                                            <i class="fas fa-envelope fa-2x"></i>
                                        </a>
                                        <!-- Linktree Icon -->
                                        <a href="https://linktr.ee/jooexploit" target="_blank"
                                            class="text-indigo-600 dark:text-indigo-400 hover:text-indigo-500 transform hover:scale-110 transition duration-200">
                                            <img loading="lazy"
                                                src="https://cdn.brandfetch.io/id_tNIm05N/theme/dark/symbol.svg"
                                                alt="Linktree - icon" class="w-8 h-8">
                                        </a>
                                    </div>
                                </div>

                                <p class="text-gray-600 dark:text-gray-300 mt-6 text-sm text-center">
                                    fullstack dev and bug hunter | non tech lead@ CyberCrew |
                                    cybersecurity co lead and backend lead@IEEE HTI | frontend dev@Brilliant Trend kSA
                                </p>
                            </div>
                            <!-- 2 Owner Card with Background Cover Photo -->
                            <div
                                class="relative bg-white dark:bg-gray-800 rounded-xl shadow-xl overflow-hidden transform hover:scale-105 transition duration-300 ease-in-out p-8">
                                <!-- Cover Photo -->
                                <div class="absolute inset-0">
                                    <img loading="lazy" src="diaa.jpeg" alt="Diaa Elsadek - Vice Head of Team Shoky"
                                        class="w-full h-full object-cover opacity-30">
                                </div>

                                <!-- Profile Section -->
                                <div class="relative flex flex-col items-center">
                                    <div class="w-40 h-40 rounded-full border-4 border-indigo-500 overflow-hidden">
                                        <img loading="lazy" src="diaa.jpeg" alt="Diaa Elsadek - Vice Head of Team Shoky"
                                            class="w-full h-full object-cover">
                                    </div>
                                    <h3 class="text-2xl font-semibold text-gray-800 dark:text-gray-100 mt-4">Diaa
                                        Elsadek
                                    </h3>
                                    <p class="text-lg text-gray-500 dark:text-gray-400">Vice Head of Team Shoky</p>
                                    <div class="flex space-x-4 mt-4">
                                        <!-- Mail Icon -->
                                        <a href="https://wa.me/201117244172"
                                            class="text-indigo-600 dark:text-indigo-400 hover:text-indigo-500 transform hover:scale-110 transition duration-200">
                                            <i class="fab fa-whatsapp fa-2x"></i>
                                        </a>
                                        <!-- linkedin icon  -->
                                        <a href="https://www.linkedin.com/in/diaa-elsadek-1b82682a8"
                                            class="text-indigo-600 dark:text-indigo-400 hover:text-indigo-500 transform hover:scale-110 transition duration-200">
                                            <i class="fab fa-linkedin fa-2x"></i>
                                        </a>
                                        <!-- Linktree Icon -->
                                        <a href="https://linktr.ee/diaa_elsadek" target="_blank"
                                            class="text-indigo-600 dark:text-indigo-400 hover:text-indigo-500 transform hover:scale-110 transition duration-200">
                                            <img loading="lazy"
                                                src="https://cdn.brandfetch.io/id_tNIm05N/theme/dark/symbol.svg"
                                                alt="Linktree - icon" class="w-8 h-8">
                                        </a>
                                    </div>
                                </div>

                                <p class="text-gray-600 dark:text-gray-300 mt-6 text-sm text-center">
                                    Flutter DEV | FrontEnd React | Backend nodejs | Year 3 Leader (2022) </p>
                            </div>
                            <!-- Repeat Owner Cards as needed -->
                        </div>
                        <br>
                        <!-- Developers Section -->
                        <h2 class="text-2xl font-semibold mb-6 text-gray-800 dark:text-gray-100">Meet Our Developers
                        </h2>
                        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8">
                            <!-- Developer Card -->
                            <div
                                class="relative bg-white dark:bg-gray-800 rounded-xl shadow-xl overflow-hidden transform hover:scale-105 transition duration-300 ease-in-out p-8">
                                <!-- Cover Photo -->
                                <div class="absolute inset-0">
                                    <img loading="lazy" src="youseftamer_profile.jpg"
                                        alt="Yousef Tamer - Head of Team Shoky"
                                        class="w-full h-full object-cover opacity-30">
                                </div>

                                <!-- Profile Section -->
                                <div class="relative flex flex-col items-center">
                                    <div class="w-40 h-40 rounded-full border-4 border-indigo-500 overflow-hidden">
                                        <img loading="lazy" src="youseftamer_profile.jpg"
                                            alt="Yousef Tamer - Head of Team Shoky" class="w-full h-full object-cover">
                                    </div>
                                    <h3 class="text-2xl font-semibold text-gray-800 dark:text-gray-100 mt-4">Yousef
                                        Tamer</h3>
                                    <p class="text-lg text-gray-500 dark:text-gray-400">Full Stack DEV</p>
                                    <div class="flex space-x-4 mt-4">
                                        <!-- Mail Icon -->
                                        <a href="mailto:youseftamereg@gmail.com"
                                            class="text-indigo-600 dark:text-indigo-400 hover:text-indigo-500 transform hover:scale-110 transition duration-200">
                                            <i class="fas fa-envelope fa-2x"></i>
                                        </a>
                                        <!-- Linktree Icon -->
                                        <a href="https://linktr.ee/jooexploit" target="_blank"
                                            class="text-indigo-600 dark:text-indigo-400 hover:text-indigo-500 transform hover:scale-110 transition duration-200">
                                            <img loading="lazy"
                                                src="https://cdn.brandfetch.io/id_tNIm05N/theme/dark/symbol.svg"
                                                alt="Linktree - icon" class="w-8 h-8">
                                        </a>
                                    </div>
                                </div>

                                <p class="text-gray-600 dark:text-gray-300 mt-6 text-sm text-center">
                                    fullstack dev and bug hunter | non tech lead@ CyberCrew |
                                    cybersecurity co lead and backend lead@IEEE HTI | frontend dev@Brilliant Trend kSA
                                </p>
                            </div>

                            <!-- Repeat Developer Cards as needed -->
                        </div>

                        <!-- Data Collectors Section -->
                        <h2 class="text-2xl font-semibold mb-6 mt-12 text-gray-800 dark:text-gray-100">Our Data
                            Collectors</h2>
                        <!-- Year 3 leaders  -->
                        <div>
                            <h3 class="text-xl font-semibold mb-4 text-indigo-600 dark:text-indigo-400">Year 3 Leaders
                            </h3>
                            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8">
                                <!-- mazen tamer Card -->
                                <div
                                    class="bg-white dark:bg-gray-800 rounded-xl shadow-xl transform hover:scale-105 transition duration-300 ease-in-out p-8">
                                    <div class="flex flex-col items-center">
                                        <img loading="lazy" src="mazen_tamer.jpg"
                                            alt="mazen tamer - Data Collector Photo"
                                            class="w-32 h-32 rounded-full border-4 border-indigo-500 mb-4">
                                        <h3 class="text-xl font-semibold text-gray-800 dark:text-gray-100">Mazen Tamer
                                        </h3>
                                        <div class="flex space-x-4 mt-6">
                                            <a href="https://wa.me/201097383576"
                                                class="text-indigo-600 dark:text-indigo-400 hover:text-indigo-500 transform hover:scale-110 transition duration-200"
                                                target="_blank" rel="noopener noreferrer">
                                                <i class="fab fa-whatsapp fa-2x"></i>
                                            </a>
                                        </div>
                                    </div>
                                    <p class="text-gray-600 dark:text-gray-300 mt-4 text-sm">
                                        Backend DEV nodejs
                                    </p>
                                </div>
                                <!-- Eslam wael card  -->
                                <div
                                    class="bg-white dark:bg-gray-800 rounded-xl shadow-xl transform hover:scale-105 transition duration-300 ease-in-out p-8">
                                    <div class="flex flex-col items-center">
                                        <img loading="lazy" src="islam_wael.jpg" alt="Eslam wael - Data Collector Photo"
                                            class="w-32 h-32 rounded-full border-4 border-indigo-500 mb-4">
                                        <h3 class="text-xl font-semibold text-gray-800 dark:text-gray-100">Eslam wael
                                        </h3>
                                        <div class="flex space-x-4 mt-6">
                                            <a href="https://wa.me/201065504033"
                                                class="text-indigo-600 dark:text-indigo-400 hover:text-indigo-500 transform hover:scale-110 transition duration-200"
                                                target="_blank" rel="noopener noreferrer">
                                                <i class="fab fa-whatsapp fa-2x"></i>
                                            </a>
                                            <a href="https://www.linkedin.com/in/eslam-amer-5a6b45272/"
                                                class="text-indigo-600 dark:text-indigo-400 hover:text-indigo-500 transform hover:scale-110 transition duration-200"
                                                target="_blank" rel="noopener noreferrer">
                                                <i class="fab fa-linkedin fa-2x"></i>
                                            </a>
                                        </div>
                                    </div>
                                    <p class="text-gray-600 dark:text-gray-300 mt-4 text-sm">
                                        Frontend developer React.js
                                    </p>
                                </div>
                                <!-- Mariem Mostafa card  -->
                                <div
                                    class="bg-white dark:bg-gray-800 rounded-xl shadow-xl transform hover:scale-105 transition duration-300 ease-in-out p-8">
                                    <div class="flex flex-col items-center">
                                        <img loading="lazy" src="icon.jpg" alt="Mariem Mostafa - Data Collector Photo"
                                            class="w-32 h-32 rounded-full border-4 border-indigo-500 mb-4">
                                        <h3 class="text-xl font-semibold text-gray-800 dark:text-gray-100">Mariem
                                            Mostafa
                                        </h3>
                                        <div class="flex space-x-4 mt-6">
                                            <a href="https://wa.me/201211375463"
                                                class="text-indigo-600 dark:text-indigo-400 hover:text-indigo-500 transform hover:scale-110 transition duration-200"
                                                target="_blank" rel="noopener noreferrer">
                                                <i class="fab fa-whatsapp fa-2x"></i>
                                            </a>
                                            <a href="https://www.linkedin.com/in/mariem-moustafa-b5a7a02b5"
                                                class="text-indigo-600 dark:text-indigo-400 hover:text-indigo-500 transform hover:scale-110 transition duration-200"
                                                target="_blank" rel="noopener noreferrer">
                                                <i class="fab fa-linkedin fa-2x"></i>
                                            </a>
                                        </div>
                                    </div>
                                    <p class="text-gray-600 dark:text-gray-300 mt-4 text-sm">
                                        AI Engineer
                                    </p>
                                </div>
                                <!-- Add more Year 3 helpers here -->
                            </div>
                        </div>
                        <br>
                        <!-- Year 2 Leaders -->
                        <div>
                            <h3 class="text-xl font-semibold mb-4 text-indigo-600 dark:text-indigo-400">Year 2 Leaders
                            </h3>
                            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8">
                                <!-- Ammar Roshdy Card -->
                                <div
                                    class="bg-white dark:bg-gray-800 rounded-xl shadow-xl transform hover:scale-105 transition duration-300 ease-in-out p-8">
                                    <div class="flex flex-col items-center">
                                        <img loading="lazy" src="ammar roshdy.jpg"
                                            alt="Ammar Roshdy - Data Collector Photo"
                                            class="w-32 h-32 rounded-full border-4 border-indigo-500 mb-4">
                                        <h3 class="text-xl font-semibold text-gray-800 dark:text-gray-100">ammar roshdy
                                        </h3>
                                        <div class="flex space-x-4 mt-6">
                                            <a href="https://www.instagram.com/3mar_roshdyy"
                                                class="text-indigo-600 dark:text-indigo-400 hover:text-indigo-500 transform hover:scale-110 transition duration-200"
                                                target="_blank" rel="noopener noreferrer">
                                                <i class="fab fa-instagram fa-2x"></i>
                                            </a>
                                        </div>
                                    </div>
                                    <p dir="rtl" class="text-gray-600 dark:text-gray-300 mt-4 text-sm">
                                        ÙÙÙØ¯Ø³ Ø¹ÙÙ ÙØ§ ØªÙØ±Ø¬
                                    </p>
                                </div>

                                <!-- Mohand khaled Card -->
                                <div
                                    class="bg-white dark:bg-gray-800 rounded-xl shadow-xl transform hover:scale-105 transition duration-300 ease-in-out p-8">
                                    <div class="flex flex-col items-center">
                                        <img loading="lazy" src="Mohand khaled.jpg"
                                            alt="Mohand khaled - Data Collector Photo"
                                            class="w-32 h-32 rounded-full border-4 border-indigo-500 mb-4 object-cover">
                                        <h3 class="text-xl font-semibold text-gray-800 dark:text-gray-100">Mohand khaled
                                        </h3>
                                    </div>
                                </div>
                                <!-- Mostafa Nour card  -->
                                <div
                                    class="bg-white dark:bg-gray-800 rounded-xl shadow-xl transform hover:scale-105 transition duration-300 ease-in-out p-8">
                                    <div class="flex flex-col items-center">
                                        <img loading="lazy" src="Mostafa_nour.jpg"
                                            alt="Mostafa Nour - Data Collector Photo"
                                            class="w-32 h-32 rounded-full border-4 border-indigo-500 mb-4 object-cover">
                                        <h3 class="text-xl font-semibold text-gray-800 dark:text-gray-100">Mostafa Nour
                                        </h3>
                                        <div class="flex space-x-4 mt-6">
                                            <a href="https://www.facebook.com/share/16HiyfdoMD/"
                                                class="text-indigo-600 dark:text-indigo-400 hover:text-indigo-500 transform hover:scale-110 transition duration-200"
                                                target="_blank" rel="noopener noreferrer">
                                                <i class="fab fa-facebook fa-2x"></i>
                                            </a>
                                        </div>
                                    </div>
                                </div>
                                <!-- Add more Year 2 helpers here -->
                            </div>
                        </div>

                        <br>

                        <!-- Year 1 Leaders -->
                        <div class="mb-8">
                            <h3 class="text-xl font-semibold mb-4 text-indigo-600 dark:text-indigo-400">Year 1 Leaders
                            </h3>
                            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8">
                                <!-- Nare Mohammed Card -->
                                <div
                                    class="bg-white dark:bg-gray-800 rounded-xl shadow-xl transform hover:scale-105 transition duration-300 ease-in-out p-8">
                                    <div class="flex flex-col items-center">
                                        <img loading="lazy" src="Nare Mohammed.jpg"
                                            alt="Nare Mohammed - Data Collector Photo"
                                            class="w-32 h-32 rounded-full border-4 border-indigo-500 mb-4 object-cover">
                                        <h3 class="text-xl font-semibold text-gray-800 dark:text-gray-100">Nare Mohammed
                                        </h3>
                                        <div class="flex space-x-4 mt-6">
                                            <a href="https://www.linkedin.com/in/naira-elshorbagy-710017330?utm_source=share&utm_campaign=share_via&utm_content=profile&utm_medium=android_app"
                                                class="text-indigo-600 dark:text-indigo-400 hover:text-indigo-500 transform hover:scale-110 transition duration-200"
                                                target="_blank" rel="noopener noreferrer">
                                                <i class="fab fa-linkedin fa-2x"></i>
                                            </a>
                                        </div>
                                    </div>
                                    <p class="text-gray-600 dark:text-gray-300 mt-4 text-sm">
                                        AI intern , HTI first year student
                                    </p>
                                </div>

                                <!-- Hamza Haikal Card  -->
                                <div
                                    class="bg-white dark:bg-gray-800 rounded-xl shadow-xl transform hover:scale-105 transition duration-300 ease-in-out p-8">
                                    <div class="flex flex-col items-center">
                                        <img loading="lazy" src="Hamza_Haikal.jpg"
                                            alt="Hamza Haikal - Data Collector Photo"
                                            class="w-32 h-32 rounded-full border-4 border-indigo-500 mb-4 object-cover">
                                        <h3 class="text-xl font-semibold text-gray-800 dark:text-gray-100">Hamza Haikal
                                        </h3>
                                        <div class="flex space-x-4 mt-6">
                                            <a href="https://www.facebook.com/share/12EQdc3GpjM/"
                                                class="text-indigo-600 dark:text-indigo-400 hover:text-indigo-500 transform hover:scale-110 transition duration-200"
                                                target="_blank" rel="noopener noreferrer">
                                                <i class="fab fa-facebook fa-2x"></i>
                                            </a>

                                            <a href="https://www.instagram.com/dabuilder.hamza"
                                                class="text-indigo-600 dark:text-indigo-400 hover:text-indigo-500 transform hover:scale-110 transition duration-200"
                                                target="_blank" rel="noopener noreferrer">
                                                <i class="fab fa-instagram fa-2x"></i>
                                            </a>

                                            <a href="https://wa.me/qr/LF45FABHMAVUE1"
                                                class="text-indigo-600 dark:text-indigo-400 hover:text-indigo-500 transform hover:scale-110 transition duration-200"
                                                target="_blank" rel="noopener noreferrer">
                                                <i class="fab fa-whatsapp fa-2x"></i>
                                            </a>

                                        </div>
                                    </div>
                                    <p class="text-gray-600 dark:text-gray-300 mt-4 text-sm">
                                        HTI student with a strong foundation in HTML & CSS, and currently exploring
                                        JavaScript to deliver smooth and responsive userÂ experiences </p>
                                </div>
                                <!-- JanaMagdy card  -->
                                <div
                                    class="bg-white dark:bg-gray-800 rounded-xl shadow-xl transform hover:scale-105 transition duration-300 ease-in-out p-8">
                                    <div class="flex flex-col items-center">
                                        <img loading="lazy" src="icon.jpg" alt="JanaMagdy - Data Collector Photo"
                                            class="w-32 h-32 rounded-full border-4 border-indigo-500 mb-4 object-cover">
                                        <h3 class="text-xl font-semibold text-gray-800 dark:text-gray-100">Jana Magdy
                                        </h3>
                                        <div class="flex space-x-4 mt-6">
                                            <a href="https://github.com/JanaMagdy"
                                                class="text-indigo-600 dark:text-indigo-400 hover:text-indigo-500 transform hover:scale-110 transition duration-200"
                                                target="_blank" rel="noopener noreferrer">
                                                <i class="fab fa-github fa-2x"></i>
                                            </a>

                                        </div>
                                    </div>
                                </div>

                                <!-- Thomas nasser Card  -->
                                <div
                                    class="bg-white dark:bg-gray-800 rounded-xl shadow-xl transform hover:scale-105 transition duration-300 ease-in-out p-8">
                                    <div class="flex flex-col items-center">
                                        <img loading="lazy" src="Thomas_nasser.jpg"
                                            alt="Thomas nasser- Data Collector Photo"
                                            class="w-32 h-32 rounded-full border-4 border-indigo-500 mb-4 object-cover">
                                        <h3 class="text-xl font-semibold text-gray-800 dark:text-gray-100">Thomas nasser
                                        </h3>
                                        <div class="flex space-x-4 mt-6">
                                            <a href="https://www.linkedin.com/in/thomas-nasser-30aa87248"
                                                class="text-indigo-600 dark:text-indigo-400 hover:text-indigo-500 transform hover:scale-110 transition duration-200"
                                                target="_blank" rel="noopener noreferrer">
                                                <i class="fab fa-linkedin fa-2x"></i>
                                            </a>
                                        </div>
                                        <p class="text-gray-600 dark:text-gray-300 mt-4 text-sm">Content Creator</p>
                                    </div>
                                </div>

                                <!-- Aya Elsayed card  -->
                                <div
                                    class="bg-white dark:bg-gray-800 rounded-xl shadow-xl transform hover:scale-105 transition duration-300 ease-in-out p-8">
                                    <div class="flex flex-col items-center">
                                        <img loading="lazy" src="icon.jpg" alt=" Aya Elsayed - Data Collector Photo"
                                            class="w-32 h-32 rounded-full border-4 border-indigo-500 mb-4 object-cover">
                                        <h3 class="text-xl font-semibold text-gray-800 dark:text-gray-100">Aya Elsayed
                                        </h3>
                                    </div>
                                </div>

                                <!-- 3amer card  -->
                                <div
                                    class="bg-white dark:bg-gray-800 rounded-xl shadow-xl transform hover:scale-105 transition duration-300 ease-in-out p-8">
                                    <div class="flex flex-col items-center">
                                        <img loading="lazy" src="3amer.jpg" alt="3amer - Data Collector Photo"
                                            class="w-32 h-32 rounded-full border-4 border-indigo-500 mb-4 object-cover">
                                        <h3 class="text-xl font-semibold text-gray-800 dark:text-gray-100">3amer
                                        </h3>
                                        <div class="flex space-x-4 mt-6">
                                            <a href="https://wa.me/qr/WVNH66ZZZK3DC1"
                                                class="text-indigo-600 dark:text-indigo-400 hover:text-indigo-500 transform hover:scale-110 transition duration-200"
                                                target="_blank" rel="noopener noreferrer">
                                                <i class="fab fa-whatsapp fa-2x"></i>
                                            </a>

                                            <a href="https://www.instagram.com/ahmedamer2911?"
                                                class="text-indigo-600 dark:text-indigo-400 hover:text-indigo-500 transform hover:scale-110 transition duration-200"
                                                target="_blank" rel="noopener noreferrer">
                                                <i class="fab fa-instagram fa-2x"></i>
                                            </a>
                                        </div>
                                    </div>
                                </div>
                                <!-- 3amoor card  -->
                                <div
                                    class="bg-white dark:bg-gray-800 rounded-xl shadow-xl transform hover:scale-105 transition duration-300 ease-in-out p-8">
                                    <div class="flex flex-col items-center">
                                        <img loading="lazy" src="3amoor.jpg" alt="3amoor - Data Collector Photo"
                                            class="w-32 h-32 rounded-full border-4 border-indigo-500 mb-4 object-cover">
                                        <h3 class="text-xl font-semibold text-gray-800 dark:text-gray-100">3amoor
                                        </h3>
                                        <div class="flex space-x-4 mt-6">
                                            <a href="https://www.linkedin.com/in/amr-khaled-a282b2343"
                                                class="text-indigo-600 dark:text-indigo-400 hover:text-indigo-500 transform hover:scale-110 transition duration-200"
                                                target="_blank" rel="noopener noreferrer">
                                                <i class="fab fa-linkedin fa-2x"></i>
                                            </a>

                                            <a href="https://www.instagram.com/amrr.khaled.77"
                                                class="text-indigo-600 dark:text-indigo-400 hover:text-indigo-500 transform hover:scale-110 transition duration-200"
                                                target="_blank" rel="noopener noreferrer">
                                                <i class="fab fa-instagram fa-2x"></i>
                                            </a>
                                        </div>
                                        <p class="text-gray-600 dark:text-gray-300 mt-4 text-sm">Social media marketing
                                            and data collector</p>
                                    </div>
                                </div>
                                <!-- Shaimaa ashraf card  -->
                                <div
                                    class="bg-white dark:bg-gray-800 rounded-xl shadow-xl transform hover:scale-105 transition duration-300 ease-in-out p-8">
                                    <div class="flex flex-col items-center">
                                        <img loading="lazy" src="icon.jpg" alt="Shaimaa ashraf - Data Collector Photo"
                                            class="w-32 h-32 rounded-full border-4 border-indigo-500 mb-4 object-cover">
                                        <h3 class="text-xl font-semibold text-gray-800 dark:text-gray-100">Shaimaa
                                            ashraf
                                        </h3>
                                        <div class="flex space-x-4 mt-6">
                                            <a href="https://www.instagram.com/shaimaa.haggag.31"
                                                class="text-indigo-600 dark:text-indigo-400 hover:text-indigo-500 transform hover:scale-110 transition duration-200"
                                                target="_blank" rel="noopener noreferrer">
                                                <i class="fab fa-instagram fa-2x"></i>
                                            </a>
                                        </div>
                                        <p class="text-gray-600 dark:text-gray-300 mt-4 text-sm">HTI first year student
                                        </p>
                                    </div>
                                </div>
                                <!-- Add more Year 1 helpers here -->
                            </div>
                        </div>



                        <!-- Call to Action -->
                        <div class="mt-12 text-center">
                            <p class="text-gray-600 dark:text-gray-300 text-lg">
                                Don't be like the rest be with us We will be the best, Call us
                                <a href="https://wa.me/201090952790?text=Hello%20Team%20Shoky%2C%20I%20am%20interested%20in%20joining%20your%20team."
                                    class="text-indigo-600 dark:text-indigo-400 hover:text-indigo-500 transform hover:scale-110 transition duration-200">
                                    <i class="fab fa-whatsapp"></i> WhatsApp
                                </a> for exciting opportunities!
                            </p>
                        </div>
                    </div>

                </div>
            </main>
        </div>
    </div>

    <!-- Notification Dropdown -->
    <div id="notification-dropdown"
        class="hidden absolute right-4 top-16 w-80 max-h-96 overflow-y-auto bg-white dark:bg-gray-800 rounded-lg shadow-lg z-50 border border-gray-200 dark:border-gray-700">
        <div class="p-4 border-b border-gray-200 dark:border-gray-700">
            <h3 class="font-semibold text-gray-900 dark:text-white">Notifications</h3>
        </div>

        <div id="notification-list" class="p-2">
            <!-- Dynamically populated -->
        </div>

        <div class="p-3 text-center border-t border-gray-200 dark:border-gray-700">
            <button id="clear-notifications" class="text-sm text-indigo-600 dark:text-indigo-400 hover:underline">Clear
                All</button>
        </div>
    </div>

    <script>
        // --- START: Get Firebase Database Reference ---
        let db; // Declare db variable to be accessible within the app object
        // --- END: Get Firebase Database Reference ---
        document.addEventListener('DOMContentLoaded', function () {
            // Sticky Note Template
            const noteTemplate = (color, content = '', id = Date.now()) => `
                <div class="note p-4 rounded-lg shadow-md h-40 flex flex-col bg-${color}-100 dark:bg-${color}-800" data-id="${id}">
                    <div class="flex justify-between items-start mb-2">
                        <button class="delete-note text-gray-500 hover:text-gray-700 dark:hover:text-gray-300">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <textarea class="flex-1 w-full bg-transparent resize-none focus:outline-none" placeholder="Write your note...">${content}</textarea>
                </div>
            `;

            // Todo Item Template
            const todoTemplate = (text, completed = false, id = Date.now()) => `
                <li class="flex items-center justify-between p-2 hover:bg-gray-50 dark:hover:bg-gray-700 rounded-md" data-id="${id}">
                    <div class="flex items-center">
                        <input type="checkbox" ${completed ? 'checked' : ''} class="todo-checkbox h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded">
                        <span class="ml-3 ${completed ? 'line-through text-gray-400 dark:text-gray-500' : 'text-gray-700 dark:text-gray-300'}">${text}</span>
                    </div>
                    <button class="delete-todo text-red-500 hover:text-red-700 dark:hover:text-red-400">
                        <i class="fas fa-trash-alt"></i>
                    </button>
                </li>
            `;
            // // Add this to your existing script, inside the DOMContentLoaded event listener
            // const tour = new Shepherd.Tour({
            //     defaultStepOptions: {
            //         cancelIcon: {
            //             enabled: true
            //         },
            //         classes: 'shadow-md bg-purple-50',
            //         scrollTo: { behavior: 'smooth', block: 'center' }
            //     },
            //     useModalOverlay: true
            // });

            // // Add tour steps
            // tour.addStep({
            //     id: 'welcome',
            //     text: 'Ø§ÙÙØ§ Ø¨ÙÙ ÙØ§ ØµØ¯ÙÙÙ ÙØ§Ø®Ø¯Ù ÙÙÙ Ø§ÙÙÙÙ Ø§Ù Ø§ÙÙÙÙØ¹ Ø¯Ø§ ÙØ¹Ø¨Ø§Ø±Ù Ø¹Ù Ø§Ù Ø¬Ø§ÙØ² Ø!',
            //     attachTo: {
            //         element: '.content-area',
            //         on: 'top'
            //     },
            //     classes: 'shepherd-theme-custom',
            //     buttons: [
            //         {
            //             text: 'Skip Tour',
            //             classes: 'shepherd-button-cancel',
            //             action: tour.complete
            //         },
            //         {
            //             text: 'Next',
            //             classes: 'shepherd-button-primary',
            //             action: tour.next
            //         }
            //     ]
            // });


            // tour.addStep({
            //     id: 'upcoming-lectures',
            //     text: 'ÙÙØ§ ÙØªØ´ÙÙ Ø§ÙÙØ­Ø§Ø¶Ø§Ø±Ø§Øª Ø§ÙØ¬Ø§ÙÙ ',
            //     attachTo: {
            //         element: '#upcoming-lectures',
            //         on: 'bottom'
            //     },
            //     classes: 'shepherd-theme-custom',

            //     buttons: [
            //         {
            //             text: 'Back',
            //             classes: 'shepherd-button-secondary',
            //             action: tour.back
            //         },
            //         {
            //             text: 'Next',
            //             classes: 'shepherd-button-primary',
            //             action: tour.next
            //         }
            //     ]
            // });

            // tour.addStep({
            //     id: 'recent-materials',
            //     text: 'ØªÙØ¯Ø± ØªØ´ÙÙ ÙÙØ§ Ø§Ø®Ø± Ø§ÙÙØ§ØªØ±ÙØ§Ù Ø§ÙÙ Ø§ØªØ¶Ø§ÙØª',
            //     attachTo: {
            //         element: '#recent-materials',
            //         on: 'down'
            //     },
            //     classes: 'shepherd-theme-custom',
            //     buttons: [
            //         {
            //             text: 'Back',
            //             classes: 'shepherd-button-secondary',
            //             action: tour.back
            //         },
            //         {
            //             text: 'Next',
            //             classes: 'shepherd-button-primary',
            //             action: tour.next
            //         }
            //     ]
            // });

            // // Sidebar Step
            // tour.addStep({
            //     id: 'navigation',
            //     text: 'Ø¯Ø§ Ø§ÙÙ Ø­Ø§Ø¬Ù ØªÙØ¯Ø± Ø¨ÙÙ ØªØªÙÙÙ ÙÙÙ Ø³ÙØ§Ø¡ ÙØµÙØ­Ù Ø§ÙØ§Ø®Ø¨Ø§Ø± , ØªØ´ÙÙ Ø§ÙÙÙØ±Ø³Ø§Øª , Ù ØªØ¹Ø±Ù Ø¹ÙÙØ§ Ø§ÙØªØ± , ØªØ¹Ø¯Ù ÙØ¹ÙÙÙØ§ØªÙ ',
            //     attachTo: {
            //         element: '#sidebar',
            //         on: 'right'
            //     },
            //     beforeShowPromise: function () {
            //         return new Promise(function (resolve) {
            //             if (window.innerWidth < 1024) {
            //                 // Open the sidebar
            //                 document.getElementById('sidebar').classList.remove('sidebar-collapsed');
            //                 setTimeout(() => {
            //                     resolve();
            //                 }, 300); // Ensure animation completes before proceeding
            //             } else {
            //                 resolve();
            //             }
            //         });
            //     },
            //     classes: 'shepherd-theme-custom',
            //     buttons: [
            //         {
            //             text: 'Back',
            //             classes: 'shepherd-button-secondary',
            //             action: tour.back
            //         },
            //         {
            //             text: 'Next',
            //             classes: 'shepherd-button-primary',
            //             action: tour.next // Move to next step WITHOUT closing sidebar
            //         }
            //     ],
            //     modalOverlayOpeningPadding: 5,
            //     canClickTarget: false,
            //     popperOptions: {
            //         modifiers: [
            //             {
            //                 name: 'preventOverflow',
            //                 options: {
            //                     padding: 10
            //                 }
            //             }
            //         ]
            //     }
            // });
            // // Install App Step (Fixed)
            // tour.addStep({
            //     id: 'install-app',
            //     text: 'ÙÙ Ø¹Ø§ÙØ² ØªØ´ØºÙ Ø§ÙÙÙÙØ¹ Ø§ÙÙÙØ§ÙÙ ÙÙØ¨ÙÙ Ø¹ÙØ¯Ù Ø¹ÙÙ Ø¬ÙØ§Ø²Ù Ø¯ÙØ³ ÙÙØ§ ÙØ«Ø¨ØªÙ',
            //     attachTo: {
            //         element: '#install-app-button',
            //         on: 'left'
            //     },
            //     beforeShowPromise: function () {
            //         return new Promise(function (resolve) {
            //             if (window.innerWidth < 1024) {
            //                 // Ensure sidebar stays open for mobile
            //                 document.getElementById('sidebar').classList.remove('sidebar-collapsed');
            //             }
            //             setTimeout(resolve, 300);
            //         });
            //     },
            //     classes: 'shepherd-theme-custom',
            //     buttons: [
            //         {
            //             text: 'Back',
            //             classes: 'shepherd-button-secondary',
            //             action: tour.back
            //         },
            //         {
            //             text: 'Next',
            //             classes: 'shepherd-button-primary',
            //             action: tour.next // Just go to next step without closing sidebar
            //         }
            //     ]
            // });

            // // Theme Toggle Step
            // tour.addStep({
            //     id: 'theme-toggle',
            //     text: 'ØªÙØ¯Ø± ØªØºÙØ± ÙØ¨ÙÙ Ø§ÙÙØ¶Ø¹ Ø§ÙÙØ§ØªØ­ ÙØ§ÙØ¯Ø§ÙÙ ÙØªØ´ÙÙ Ø§ÙØ§ÙØ¶Ù ÙÙÙ Ø§Ù ',
            //     attachTo: {
            //         element: '#theme-toggle',
            //         on: 'top'
            //     },
            //     beforeShowPromise: function () {
            //         return new Promise(function (resolve) {
            //             if (window.innerWidth < 1024) {
            //                 // Ensure sidebar stays open for theme toggle step
            //                 document.getElementById('sidebar').classList.remove('sidebar-collapsed');
            //                 setTimeout(() => {
            //                     resolve();
            //                 }, 300);
            //             } else {
            //                 resolve();
            //             }
            //         });
            //     },
            //     classes: 'shepherd-theme-custom',
            //     buttons: [
            //         {
            //             text: 'Back',
            //             classes: 'shepherd-button-secondary',
            //             action: tour.back
            //         },
            //         {
            //             text: 'Next',
            //             classes: 'shepherd-button-primary',
            //             action: () => {
            //                 if (window.innerWidth < 1024) {
            //                     // Close sidebar after theme toggle step
            //                     setTimeout(() => {
            //                         document.getElementById('sidebar').classList.add('sidebar-collapsed');
            //                     }, 100);
            //                 }
            //                 tour.next();
            //             }
            //         }
            //     ]
            // });


            // tour.addStep({
            //     id: 'courses-section',
            //     text: 'ØªØµÙØ­ Ø§ÙÙÙØ±Ø³Ø§Øª Ø§ÙÙÙ ÙØ³Ø¬Ù ÙÙÙØ§ ÙÙØ§. ÙÙ ÙØ§Ø±Øª ÙÙØ±Ø³ Ø¨ÙØ¹Ø±Ø¶ ÙÙØ¯ Ø§ÙÙÙØ±Ø³Ø Ø§ÙØ¹ÙÙØ§ÙØ Ø§Ø³Ù Ø§ÙÙØ¯Ø±Ø³Ø ÙØ¹Ø¯Ø¯ Ø§ÙÙØµÙÙ.',
            //     attachTo: {
            //         element: '#courses-container',
            //         on: 'top'
            //     },
            //     beforeShowPromise: function () {
            //         return new Promise(function (resolve) {
            //             // Navigate to courses page first
            //             app.navigateTo('courses');
            //             setTimeout(resolve, 300); // Give time for transition
            //         });
            //     },
            //     classes: 'shepherd-theme-custom',
            //     buttons: [
            //         {
            //             text: 'Back',
            //             classes: 'shepherd-button-secondary',
            //             action: tour.back
            //         },
            //         {
            //             text: 'Next',
            //             classes: 'shepherd-button-primary',
            //             action: tour.next
            //         }
            //     ]
            // });

            // tour.addStep({
            //     id: 'course-search',
            //     text: 'Ø¨Ø³Ø±Ø¹Ø© ØªÙØ¯Ø± ØªÙØ§ÙÙ Ø§ÙÙÙØ±Ø³Ø§Øª Ø¨Ø§ÙØ¨Ø­Ø« Ø¹Ù Ø§ÙØ¹ÙØ§ÙÙÙ Ø£Ù Ø£Ø³ÙØ§Ø¡ Ø§ÙÙØ¯Ø±Ø³ÙÙ.',
            //     attachTo: {
            //         element: '#course-search',
            //         on: 'bottom'
            //     },
            //     classes: 'shepherd-theme-custom',
            //     buttons: [
            //         {
            //             text: 'Back',
            //             classes: 'shepherd-button-secondary',
            //             action: tour.back
            //         },
            //         {
            //             text: 'Next',
            //             classes: 'shepherd-button-primary',
            //             action: tour.next
            //         }
            //     ]
            // });

            // tour.addStep({
            //     id: 'course-details',
            //     text: 'Ø§Ø¶ØºØ· Ø¹ÙÙ "view course" Ø¹ÙØ´Ø§Ù ØªØ¯Ø®Ù Ø¹ÙÙ ØªÙØ§ØµÙÙ Ø§ÙÙÙØ±Ø³Ø Ø²Ù Ø§ÙÙØµÙÙ ÙØ§ÙÙÙØ§Ø¯ Ø§ÙÙÙ ÙÙÙÙ ØªØ­ÙÙÙØ§.',
            //     attachTo: {
            //         element: '.view-course-btn',
            //         on: 'bottom'
            //     },
            //     beforeShowPromise: function () {
            //         return new Promise(function (resolve) {
            //             // Navigate to courses page first
            //             app.navigateTo('courses');

            //             // Select the first course
            //             app.state.selectedCourse = app.mockData.courses[0];

            //             setTimeout(resolve, 300);
            //         });
            //     },
            //     classes: 'shepherd-theme-custom',
            //     buttons: [
            //         {
            //             text: 'Back',
            //             classes: 'shepherd-button-secondary',
            //             action: tour.back
            //         },
            //         {
            //             text: 'Next',
            //             classes: 'shepherd-button-primary',
            //             action: tour.next
            //         }
            //     ]
            // });
            // tour.addStep({
            //     id: 'course-overview',
            //     text: 'ÙÙØ§ ØªÙØ¯Ø± ØªØ´ÙÙ ÙØ¹ÙÙÙØ§Øª ÙÙØµÙØ© Ø¹Ù Ø§ÙÙÙØ±Ø³Ø Ø²Ù Ø§Ø³Ù Ø§ÙÙØ¯Ø±Ø³ ÙÙØµÙ Ø§ÙÙÙØ±Ø³.',
            //     attachTo: {
            //         element: '#course-details-content > div',
            //         on: 'bottom'
            //     },
            //     beforeShowPromise: function () {
            //         return new Promise(function (resolve) {
            //             // First, ensure we have a selected course
            //             if (!app.state.selectedCourse) {
            //                 // Select the first course if none is selected
            //                 app.state.selectedCourse = app.mockData.courses[0];
            //             }

            //             // Navigate to course details and render content
            //             app.navigateTo('course-details');

            //             // Give time for the content to render
            //             setTimeout(() => {
            //                 resolve();
            //             }, 500);
            //         });
            //     },
            //     classes: 'shepherd-theme-custom',
            //     buttons: [
            //         {
            //             text: 'Back',
            //             classes: 'shepherd-button-secondary',
            //             action: tour.back
            //         },
            //         {
            //             text: 'Next',
            //             classes: 'shepherd-button-primary',
            //             action: tour.next
            //         }
            //     ]
            // });

            // tour.addStep({
            //     id: 'course-chapters',
            //     text: 'ÙÙ ÙØµÙ Ø¨ÙØ­ØªÙÙ Ø¹ÙÙ ÙÙØ§Ø¯ ÙØ­Ø§Ø¶Ø±Ø§ØªØ Ø²Ù ÙÙÙØ§Øª PDFØ ÙÙØ¯ÙÙÙØ§ØªØ ÙÙØ§Ø¬Ø¨Ø§Øª. Ø§Ø¶ØºØ· Ø¹ÙÙ Ø§ÙÙØµÙ Ø¹ÙØ´Ø§Ù ØªÙØ¨Ø±Ù ÙØªØ¯Ø®Ù Ø¹ÙÙ Ø§ÙÙØ­ØªÙÙ Ø¨ØªØ§Ø¹Ù.',
            //     attachTo: {
            //         element: '#chapters-container',
            //         on: 'bottom'
            //     },
            //     beforeShowPromise: function () {
            //         return new Promise(function (resolve) {
            //             // Open first chapter to show content
            //             const firstChapterHeader = document.querySelector('.chapter-header');
            //             const firstChapterContent = document.querySelector('.chapter-content');
            //             const icon = firstChapterHeader.querySelector('i');

            //             firstChapterContent.classList.remove('hidden');
            //             icon.classList.add('rotate-180');

            //             setTimeout(resolve, 300);
            //         });
            //     },
            //     classes: 'shepherd-theme-custom',
            //     buttons: [
            //         {
            //             text: 'Back',
            //             classes: 'shepherd-button-secondary',
            //             action: tour.back
            //         },
            //         {
            //             text: 'Next',
            //             classes: 'shepherd-button-primary',
            //             action: tour.next
            //         }
            //     ]
            // });

            // tour.addStep({
            //     id: 'course-materials',
            //     text: 'Ø­ÙÙ ÙÙØ§Ø¯ Ø§ÙÙÙØ±Ø³ Ø¨Ø§ÙØ¶ØºØ· Ø¹ÙÙ Ø§ÙØ£Ø²Ø±Ø§Ø± Ø¯Ù. Ø§ÙÙÙÙ Ø¨ÙÙØ¶Ø­ ÙÙØ¹ Ø§ÙÙØ­ØªÙÙ: Ø£Ø­ÙØ± ÙÙÙÙØ§Øª PDFØ Ø£Ø²Ø±Ù ÙÙÙÙØ¯ÙÙÙØ§ØªØ ÙØ£Ø®Ø¶Ø± ÙÙÙØ§Ø¬Ø¨Ø§Øª',
            //     attachTo: {
            //         element: '.download-btn',
            //         on: 'left'
            //     },
            //     classes: 'shepherd-theme-custom',
            //     buttons: [
            //         {
            //             text: 'Back',
            //             classes: 'shepherd-button-secondary',
            //             action: tour.back
            //         },
            //         {
            //             text: 'Done',
            //             classes: 'shepherd-button-done',
            //             action: tour.complete
            //         }
            //     ]
            // });
            const app = {

                // State Management
                state: {
                    darkMode: false,
                    currentPage: 'dashboard',
                    notifications: true,
                    selectedCourse: null,
                    selectedCourseId: null,
                    targetChapterIndex: null,
                    userData: {
                        name: null,
                        university: null,
                        universityName: null,
                        year: null,
                        group: null
                    }
                },
                examScheduleData: [
                    // ... (Keep the full examScheduleData array from the previous version) ...
                    // Page 1 Data
                    {
                        day: "Ø§ÙØ³Ø¨Øª",
                        date: "2025/05/10",
                        code: "BSC 114",
                        name: "ÙØºØ© Ø¥ÙØ¬ÙÙØ²ÙØ© (1)",
                        period: "Ø£ÙÙÙ",
                        time: "9:30 - 10:30",
                        regulation: "1",
                    },
                    {
                        day: "Ø§ÙØ³Ø¨Øª",
                        date: "2025/05/10",
                        code: "H 102",
                        name: "Ø§ÙÙØºØ© Ø§ÙØ¥ÙØ¬ÙÙØ²ÙØ©",
                        period: "Ø£ÙÙÙ",
                        time: "9:30 - 10:30",
                        regulation: "4",
                    },
                    {
                        day: "Ø§ÙØ³Ø¨Øª",
                        date: "2025/05/10",
                        code: "H 204",
                        name: "Ø¶Ø¨Ø· ÙØªÙÙÙØ¯ Ø§ÙØ¬ÙØ¯Ø©",
                        period: "Ø«Ø§ÙÙØ©",
                        time: "11:00 - 12:00",
                        regulation: "4",
                    },
                    {
                        day: "Ø§ÙØ§Ø­Ø¯",
                        date: "2025/05/11",
                        code: "PHE 220",
                        name: "ØªØ±Ø¨ÙØ© Ø±ÙØ§Ø¶ÙØ© (2)",
                        period: "Ø£ÙÙÙ",
                        time: "9:30 - 10:30",
                        regulation: "1",
                    },
                    {
                        day: "Ø§ÙØ§Ø­Ø¯",
                        date: "2025/05/11",
                        code: "H 103",
                        name: "Ø¥Ø¯Ø§Ø±Ø© Ø£Ø¹ÙØ§Ù",
                        period: "Ø«Ø§ÙÙØ©",
                        time: "11:00 - 12:00",
                        regulation: "4",
                    },
                    {
                        day: "Ø§ÙØ§Ø«ÙÙÙ",
                        date: "2025/05/12",
                        code: "BSC 213",
                        name: "ÙØ¨Ø§Ø¯Ø¦ Ø¥Ø¯Ø§Ø±Ø©",
                        period: "Ø£ÙÙÙ",
                        time: "9:30 - 10:30",
                        regulation: "1",
                    },
                    {
                        day: "Ø§ÙØ§Ø«ÙÙÙ",
                        date: "2025/05/12",
                        code: "BSC 214",
                        name: "ÙØºØ© Ø¥ÙØ¬ÙÙØ²ÙØ© (3)",
                        period: "Ø£ÙÙÙ",
                        time: "9:30 - 10:30",
                        regulation: "1",
                    },
                    {
                        day: "Ø§ÙØ§Ø«ÙÙÙ",
                        date: "2025/05/12",
                        code: "H 201",
                        name: "Ø£Ø®ÙØ§ÙÙØ§Øª Ø§ÙØ¹ÙÙ",
                        period: "Ø«Ø§ÙÙØ©",
                        time: "11:00 - 12:00",
                        regulation: "4",
                    },
                    {
                        day: "Ø§ÙØ§Ø«ÙÙÙ",
                        date: "2025/05/12",
                        code: "BSC 224",
                        name: "ÙØ¨Ø§Ø¯Ø¦ Ø§ÙØ§ÙØªØµØ§Ø¯",
                        period: "Ø«Ø§ÙØ«Ø©",
                        time: "12:30 - 1:30",
                        regulation: "1",
                    },
                    {
                        day: "Ø§ÙØ§Ø«ÙÙÙ",
                        date: "2025/05/12",
                        code: "H 101",
                        name: "ÙÙØ§Ø±Ø§Øª ØªÙØ§ØµÙ",
                        period: "Ø«Ø§ÙØ«Ø©",
                        time: "12:30 - 1:30",
                        regulation: "4",
                    },
                    {
                        day: "Ø§ÙØ§Ø±Ø¨Ø¹Ø§Ø¡",
                        date: "2025/05/14",
                        code: "BSC 410",
                        name: "ÙØºØ© Ø¥ÙØ¬ÙÙØ²ÙØ© (5)",
                        period: "Ø£ÙÙÙ",
                        time: "9:30 - 10:30",
                        regulation: "1",
                    },
                    {
                        day: "Ø§ÙØ§Ø±Ø¨Ø¹Ø§Ø¡",
                        date: "2025/05/14",
                        code: "HUM 110",
                        name: "ÙÙØ±Ø± Ø«ÙØ§ÙÙ (1)",
                        period: "Ø£ÙÙÙ",
                        time: "9:30 - 10:30",
                        regulation: "1",
                    },
                    {
                        day: "Ø§ÙØ§Ø±Ø¨Ø¹Ø§Ø¡",
                        date: "2025/05/14",
                        code: "HUM 320",
                        name: "ÙÙØ±Ø± Ø«ÙØ§ÙÙ (2)",
                        period: "Ø«Ø§ÙÙØ©",
                        time: "11:00 - 12:00",
                        regulation: "1",
                    },
                    {
                        day: "Ø§ÙØ§Ø±Ø¨Ø¹Ø§Ø¡",
                        date: "2025/05/14",
                        code: "H 203",
                        name: "ÙØªØ§Ø¨Ø© ØªÙØ§Ø±ÙØ± ÙÙÙØ©",
                        period: "Ø«Ø§ÙÙØ©",
                        time: "11:00 - 12:00",
                        regulation: "4",
                    },
                    {
                        day: "Ø§ÙØ§Ø±Ø¨Ø¹Ø§Ø¡",
                        date: "2025/05/14",
                        code: "BSC 320",
                        name: "ÙØºØ© Ø¥ÙØ¬ÙÙØ²ÙØ© (4)",
                        period: "Ø«Ø§ÙØ«Ø©",
                        time: "12:30 - 1:30",
                        regulation: "1",
                    },
                    {
                        day: "Ø§ÙØ§Ø±Ø¨Ø¹Ø§Ø¡",
                        date: "2025/05/14",
                        code: "PHE 110",
                        name: "ØªØ±Ø¨ÙØ© Ø±ÙØ§Ø¶ÙØ© (1)",
                        period: "Ø«Ø§ÙØ«Ø©",
                        time: "12:30 - 1:30",
                        regulation: "1",
                    },
                    {
                        day: "Ø§ÙØ³Ø¨Øª",
                        date: "2025/05/17",
                        code: "INF 320",
                        name: "ÙØ¸Ù Ø¯Ø¹Ù ÙØ§ØªØ®Ø§Ø° Ø§ÙÙØ±Ø§Ø±",
                        period: "Ø£ÙÙÙ",
                        time: "9:30 - 11:00",
                        regulation: "1",
                    },
                    {
                        day: "Ø§ÙØ³Ø¨Øª",
                        date: "2025/05/17",
                        code: "CS 102",
                        name: "Ø¨Ø±ÙØ¬Ø© Ø§ÙØ­Ø§Ø³Ø¨Ø§Øª",
                        period: "Ø£ÙÙÙ",
                        time: "9:30 - 11:00",
                        regulation: "4",
                    },
                    {
                        day: "Ø§ÙØ³Ø¨Øª",
                        date: "2025/05/17",
                        code: "CSC 423",
                        name: "ÙØ¸Ù Ø§ÙØ­Ø§Ø³Ø¨Ø§Øª Ø§ÙÙÙØ²Ø¹Ø© ÙØ§ÙÙØªÙØ§Ø²ÙØ©",
                        period: "Ø«Ø§ÙÙØ©",
                        time: "11:30 - 1:00",
                        regulation: "1",
                    },
                    {
                        day: "Ø§ÙØ³Ø¨Øª",
                        date: "2025/05/17",
                        code: "CS 302",
                        name: "Ø¨Ø±ÙØ¬Ø© Ø§ÙÙÙØ¨",
                        period: "Ø«Ø§ÙÙØ©",
                        time: "11:30 - 1:00",
                        regulation: "4",
                    },
                    {
                        day: "Ø§ÙØ³Ø¨Øª",
                        date: "2025/05/17",
                        code: "BSC 112",
                        name: "ÙÙØ¯ÙØ© Ø±Ø³Ù Ø¨Ø§ÙØ­Ø§Ø³Ø¨",
                        period: "Ø«Ø§ÙØ«Ø©",
                        time: "1:30 - 3:00",
                        regulation: "1",
                    },
                    {
                        day: "Ø§ÙØ§Ø­Ø¯",
                        date: "2025/05/18",
                        code: "BSC 210",
                        name: "Ø±ÙØ§Ø¶Ø© (3)",
                        period: "Ø£ÙÙÙ",
                        time: "9:30 - 11:00",
                        regulation: "1",
                    },
                    {
                        day: "Ø§ÙØ§Ø­Ø¯",
                        date: "2025/05/18",
                        code: "BSC 311",
                        name: "ØªØ±Ø§Ø³Ù Ø§ÙØ¨ÙØ§ÙØ§Øª",
                        period: "Ø£ÙÙÙ",
                        time: "9:30 - 11:00",
                        regulation: "1",
                    },
                    // Page 2 Data
                    {
                        day: "Ø§ÙØ§Ø­Ø¯",
                        date: "2025/05/18",
                        code: "CSC 416",
                        name: "Ø¨Ø±ÙØ¬Ø© Ø§ÙØ´Ø¨ÙØ§Øª",
                        period: "Ø£ÙÙÙ",
                        time: "9:30 - 11:00",
                        regulation: "1",
                    },
                    {
                        day: "Ø§ÙØ§Ø­Ø¯",
                        date: "2025/05/18",
                        code: "CS 204",
                        name: "ÙÙØ¯ÙØ© ÙÙ ÙÙØ§Ø¹Ø¯ Ø§ÙØ¨ÙØ§ÙØ§Øª",
                        period: "Ø£ÙÙÙ",
                        time: "9:30 - 11:00",
                        regulation: "4",
                    },
                    {
                        day: "Ø§ÙØ§Ø­Ø¯",
                        date: "2025/05/18",
                        code: "BSC 110",
                        name: "Ø±ÙØ§Ø¶Ø© (1)",
                        period: "Ø«Ø§ÙÙØ©",
                        time: "11:30 - 1:00",
                        regulation: "1",
                    },
                    {
                        day: "Ø§ÙØ§Ø­Ø¯",
                        date: "2025/05/18",
                        code: "BS 101",
                        name: "Ø§ÙØªÙØ§Ø¶Ù ÙØ§ÙØªÙØ§ÙÙ",
                        period: "Ø«Ø§ÙÙØ©",
                        time: "11:30 - 1:00",
                        regulation: "4",
                    },
                    {
                        day: "Ø§ÙØ§Ø­Ø¯",
                        date: "2025/05/18",
                        code: "INF 220",
                        name: "ØªØ­ÙÙÙ ÙØ¸Ù",
                        period: "Ø«Ø§ÙØ«Ø©",
                        time: "1:30 - 3:00",
                        regulation: "1",
                    },
                    {
                        day: "Ø§ÙØ§Ø­Ø¯",
                        date: "2025/05/18",
                        code: "INF 310",
                        name: "ØªØµÙÙÙ ÙØ¸Ù ÙØ¹ÙÙÙØ§Øª",
                        period: "Ø«Ø§ÙØ«Ø©",
                        time: "1:30 - 3:00",
                        regulation: "1",
                    },
                    {
                        day: "Ø§ÙØ§Ø«ÙÙÙ",
                        date: "2025/05/19",
                        code: "BSC 220",
                        name: "Ø¨Ø­ÙØ« Ø¹ÙÙÙØ§Øª",
                        period: "Ø£ÙÙÙ",
                        time: "9:30 - 11:00",
                        regulation: "1",
                    },
                    {
                        day: "Ø§ÙØ§Ø«ÙÙÙ",
                        date: "2025/05/19",
                        code: "CSC 411",
                        name: "Ø§ÙÙÙØ°Ø¬Ø© ÙØ§ÙÙØ­Ø§ÙØ§Ù",
                        period: "Ø£ÙÙÙ",
                        time: "9:30 - 11:00",
                        regulation: "1",
                    },
                    {
                        day: "Ø§ÙØ§Ø«ÙÙÙ",
                        date: "2025/05/19",
                        code: "BS 201",
                        name: "Ø¨Ø­ÙØ« Ø§ÙØ¹ÙÙÙØ§Øª",
                        period: "Ø£ÙÙÙ",
                        time: "9:30 - 11:00",
                        regulation: "4",
                    },
                    {
                        day: "Ø§ÙØ§Ø«ÙÙÙ",
                        date: "2025/05/19",
                        code: "CSC 121",
                        name: "Ø§ÙØ¨Ø±ÙØ¬Ø© Ø§ÙÙÙÙÙÙØ©",
                        period: "Ø«Ø§ÙÙØ©",
                        time: "11:30 - 1:00",
                        regulation: "1",
                    },
                    {
                        day: "Ø§ÙØ§Ø«ÙÙÙ",
                        date: "2025/05/19",
                        code: "CSC 323",
                        name: "Ø±Ø³Ù Ø¨ÙØ§Ø³Ø·Ø© Ø§ÙØ­Ø§Ø³Ø¨",
                        period: "Ø«Ø§ÙÙØ©",
                        time: "11:30 - 1:00",
                        regulation: "1",
                    },
                    {
                        day: "Ø§ÙØ§Ø«ÙÙÙ",
                        date: "2025/05/19",
                        code: "CS 308",
                        name: "Ø§ÙØ±Ø³Ù Ø¨Ø§ÙØ­Ø§Ø³Ø¨",
                        period: "Ø«Ø§ÙÙØ©",
                        time: "11:30 - 1:00",
                        regulation: "4",
                    },
                    {
                        day: "Ø§ÙØ§Ø«ÙÙÙ",
                        date: "2025/05/19",
                        code: "CSC 417",
                        name: "ÙØ¹Ø§ÙØ¬Ø© Ø§ÙØµÙØ±",
                        period: "Ø«Ø§ÙØ«Ø©",
                        time: "1:30 - 3:00",
                        regulation: "1",
                    },
                    {
                        day: "Ø§ÙØ«ÙØ§Ø«Ø§Ø¡",
                        date: "2025/05/20",
                        code: "CSC 415",
                        name: "ÙØ¸Ø±ÙØ© ÙØªØ±Ø¬ÙØ§Øª Ø§ÙØ¨Ø±Ø§ÙØ¬",
                        period: "Ø£ÙÙÙ",
                        time: "9:30 - 11:00",
                        regulation: "1",
                    },
                    {
                        day: "Ø§ÙØ«ÙØ§Ø«Ø§Ø¡",
                        date: "2025/05/20",
                        code: "INF 210",
                        name: "ÙÙØ§ÙÙ Ø¨ÙØ§ÙØ§Øª",
                        period: "Ø£ÙÙÙ",
                        time: "9:30 - 11:00",
                        regulation: "1",
                    },
                    {
                        day: "Ø§ÙØ«ÙØ§Ø«Ø§Ø¡",
                        date: "2025/05/20",
                        code: "CS 201",
                        name: "ÙÙØ§ÙÙ Ø§ÙØ¨ÙØ§ÙØ§Øª",
                        period: "Ø£ÙÙÙ",
                        time: "9:30 - 11:00",
                        regulation: "4",
                    },
                    {
                        day: "Ø§ÙØ«ÙØ§Ø«Ø§Ø¡",
                        date: "2025/05/20",
                        code: "BSC 113",
                        name: "Ø§ÙÙØªØ±ÙÙÙØ§Øª (1)",
                        period: "Ø«Ø§ÙÙØ©",
                        time: "11:30 - 1:00",
                        regulation: "1",
                    },
                    {
                        day: "Ø§ÙØ«ÙØ§Ø«Ø§Ø¡",
                        date: "2025/05/20",
                        code: "BSC 122",
                        name: "Ø§ÙÙØªØ±ÙÙÙØ§Øª (2)",
                        period: "Ø«Ø§ÙÙØ©",
                        time: "11:30 - 1:00",
                        regulation: "1",
                    },
                    {
                        day: "Ø§ÙØ«ÙØ§Ø«Ø§Ø¡",
                        date: "2025/05/20",
                        code: "BS 104",
                        name: "Ø§ÙÙØªØ±ÙÙÙØ§Øª",
                        period: "Ø«Ø§ÙÙØ©",
                        time: "11:30 - 1:00",
                        regulation: "4",
                    },
                    {
                        day: "Ø§ÙØ«ÙØ§Ø«Ø§Ø¡",
                        date: "2025/05/20",
                        code: "CSC 310",
                        name: "ÙØ§Ø¬ÙØ§Øª Ø§ÙØ­Ø§Ø³Ø¨Ø§Øª ÙØ·Ø±ÙÙØ§ØªÙØ§",
                        period: "Ø«Ø§ÙØ«Ø©",
                        time: "1:30 - 3:00",
                        regulation: "1",
                    },
                    {
                        day: "Ø§ÙØ§Ø±Ø¨Ø¹Ø§Ø¡",
                        date: "2025/05/21",
                        code: "CSC 320",
                        name: "ÙÙØ¯Ø³Ø© Ø§ÙØ¨Ø±ÙØ¬ÙØ§Øª (1)",
                        period: "Ø£ÙÙÙ",
                        time: "9:30 - 11:00",
                        regulation: "1",
                    },
                    {
                        day: "Ø§ÙØ§Ø±Ø¨Ø¹Ø§Ø¡",
                        date: "2025/05/21",
                        code: "CS 104",
                        name: "ÙÙØ¯ÙØ© ÙØ¸Ù Ø§ÙÙØ¹ÙÙÙØ§Øª",
                        period: "Ø£ÙÙÙ",
                        time: "9:30 - 11:00",
                        regulation: "4",
                    },
                    {
                        day: "Ø§ÙØ§Ø±Ø¨Ø¹Ø§Ø¡",
                        date: "2025/05/21",
                        code: "CSC 426",
                        name: "Ø§ÙØ´Ø¨ÙØ§Øª Ø§ÙØ¹ØµØ¨ÙØ©",
                        period: "Ø«Ø§ÙÙØ©",
                        time: "11:30 - 1:00",
                        regulation: "1",
                    },
                    // Page 3 Data
                    {
                        day: "Ø§ÙØ§Ø±Ø¨Ø¹Ø§Ø¡",
                        date: "2025/05/21",
                        code: "CS 343",
                        name: "ÙØ¹Ø§ÙØ¬Ø© Ø§ÙØ¥Ø´Ø§Ø±Ø§Øª Ø§ÙØ±ÙÙÙØ©",
                        period: "Ø«Ø§ÙÙØ©",
                        time: "11:30 - 1:00",
                        regulation: "4",
                    },
                    {
                        day: "Ø§ÙØ§Ø±Ø¨Ø¹Ø§Ø¡",
                        date: "2025/05/21",
                        code: "INF 311",
                        name: "ÙØ¸Ù Ø§Ø¯Ø§Ø±Ø© ÙÙØ§Ø¹Ø¯ Ø§ÙØ¨ÙØ§ÙØ§Øª (1)",
                        period: "Ø«Ø§ÙØ«Ø©",
                        time: "1:30 - 3:00",
                        regulation: "1",
                    },
                    {
                        day: "Ø§ÙØ³Ø¨Øª",
                        date: "2025/05/24",
                        code: "CSC 424",
                        name: "Ø§ÙÙØ³Ø§Ø¦Ø· Ø§ÙÙØªØ¹Ø¯Ø¯Ø©",
                        period: "Ø£ÙÙÙ",
                        time: "9:30 - 11:00",
                        regulation: "1",
                    },
                    {
                        day: "Ø§ÙØ³Ø¨Øª",
                        date: "2025/05/24",
                        code: "CS 205",
                        name: "Ø£Ø³Ø§Ø³ÙØ§Øª Ø§ÙÙØ³Ø§Ø¦Ø· Ø§ÙÙØªØ¹Ø¯Ø¯Ø©",
                        period: "Ø£ÙÙÙ",
                        time: "9:30 - 11:00",
                        regulation: "4",
                    },
                    {
                        day: "Ø§ÙØ³Ø¨Øª",
                        date: "2025/05/24",
                        code: "BSC 124",
                        name: "ÙÙØ²ÙØ§Ø¡",
                        period: "Ø«Ø§ÙÙØ©",
                        time: "11:30 - 1:00",
                        regulation: "1",
                    },
                    {
                        day: "Ø§ÙØ³Ø¨Øª",
                        date: "2025/05/24",
                        code: "INF 221",
                        name: "ØªÙØ³ÙÙ ÙÙÙØ§Øª",
                        period: "Ø«Ø§ÙÙØ©",
                        time: "11:30 - 1:00",
                        regulation: "1",
                    },
                    {
                        day: "Ø§ÙØ³Ø¨Øª",
                        date: "2025/05/24",
                        code: "BS 202",
                        name: "ÙÙØ²ÙØ§Ø¡",
                        period: "Ø«Ø§ÙÙØ©",
                        time: "11:30 - 1:00",
                        regulation: "4",
                    },
                    {
                        day: "Ø§ÙØ§Ø­Ø¯",
                        date: "2025/05/25",
                        code: "CSC 322",
                        name: "Ø´Ø¨ÙØ§Øª Ø§ÙØ­Ø§Ø³Ø¨Ø§Øª",
                        period: "Ø£ÙÙÙ",
                        time: "9:30 - 11:00",
                        regulation: "1",
                    },
                    {
                        day: "Ø§ÙØ§Ø­Ø¯",
                        date: "2025/05/25",
                        code: "BS 105",
                        name: "Ø¥Ø­ØµØ§Ø¡ ÙØ§Ø­ØªÙØ§ÙØ§Øª",
                        period: "Ø£ÙÙÙ",
                        time: "9:30 - 11:00",
                        regulation: "4",
                    },
                    {
                        day: "Ø§ÙØ§Ø­Ø¯",
                        date: "2025/05/25",
                        code: "CSC 313",
                        name: "Ø¨ÙØ§Ø¡ ÙØªÙØ¸ÙÙ ÙØ¸Ù Ø§ÙØ­Ø§Ø³Ø¨Ø§Øª ÙÙØºØ© Ø§ÙØªØ¬ÙÙØ¹",
                        period: "Ø«Ø§ÙÙØ©",
                        time: "11:30 - 1:00",
                        regulation: "1",
                    },
                    {
                        day: "Ø§ÙØ§Ø­Ø¯",
                        date: "2025/05/25",
                        code: "CS 301",
                        name: "ÙØºØ© Ø§ÙØªØ¬ÙÙØ¹",
                        period: "Ø«Ø§ÙÙØ©",
                        time: "11:30 - 1:00",
                        regulation: "4",
                    },
                    {
                        day: "Ø§ÙØ§Ø­Ø¯",
                        date: "2025/05/25",
                        code: "CSC 412",
                        name: "Ø§ÙØ°ÙØ§Ø¡ Ø§ÙØ§ØµØ·ÙØ§Ø¹Ù",
                        period: "Ø«Ø§ÙØ«Ø©",
                        time: "1:30 - 3:00",
                        regulation: "1",
                    },
                    {
                        day: "Ø§ÙØ§Ø­Ø¯",
                        date: "2025/05/25",
                        code: "CS 403",
                        name: "Ø§ÙØ°ÙØ§Ø¡ Ø§ÙØ§ØµØ·ÙØ§Ø¹Ù",
                        period: "Ø«Ø§ÙØ«Ø©",
                        time: "1:30 - 3:00",
                        regulation: "4",
                    },
                    {
                        day: "Ø§ÙØ§Ø«ÙÙÙ",
                        date: "2025/05/26",
                        code: "CSC 420",
                        name: "Ø§ÙÙØ¸Ù Ø§ÙØ®Ø¨ÙØ±Ø©",
                        period: "Ø£ÙÙÙ",
                        time: "9:30 - 11:00",
                        regulation: "1",
                    },
                    {
                        day: "Ø§ÙØ§Ø«ÙÙÙ",
                        date: "2025/05/26",
                        code: "BS 102",
                        name: "Ø§ÙØ¬Ø¨Ø± Ø§ÙØ®Ø·Ù",
                        period: "Ø£ÙÙÙ",
                        time: "9:30 - 11:00",
                        regulation: "4",
                    },
                    {
                        day: "Ø§ÙØ§Ø«ÙÙÙ",
                        date: "2025/05/26",
                        code: "CSC 222",
                        name: "ÙØ¸Ù Ø§ÙØªØ´ØºÙÙ",
                        period: "Ø«Ø§ÙÙØ©",
                        time: "11:30 - 1:00",
                        regulation: "1",
                    },
                    {
                        day: "Ø§ÙØ§Ø«ÙÙÙ",
                        date: "2025/05/26",
                        code: "CS 404",
                        name: "ÙØ¸Ø±ÙØ§Øª ÙØ¸Ù Ø§ÙØªØ´ØºÙÙ",
                        period: "Ø«Ø§ÙÙØ©",
                        time: "11:30 - 1:00",
                        regulation: "4",
                    },
                    {
                        day: "Ø§ÙØ§Ø«ÙÙÙ",
                        date: "2025/05/26",
                        code: "CSC 414",
                        name: "ÙÙØ¯Ø³Ø© Ø§ÙØ¨Ø±ÙØ¬ÙØ§Øª (2)",
                        period: "Ø«Ø§ÙØ«Ø©",
                        time: "1:30 - 3:00",
                        regulation: "1",
                    },
                    {
                        day: "Ø§ÙØ«ÙØ§Ø«Ø§Ø¡",
                        date: "2025/05/27",
                        code: "CSC 324",
                        name: "Ø§ÙØ¨Ø±ÙØ¬Ø© Ø§ÙÙÙØ·ÙÙØ©",
                        period: "Ø£ÙÙÙ",
                        time: "9:30 - 11:00",
                        regulation: "1",
                    },
                    {
                        day: "Ø§ÙØ«ÙØ§Ø«Ø§Ø¡",
                        date: "2025/05/27",
                        code: "CS 300",
                        name: "ÙÙØ¶ÙØ¹Ø§Øª ÙØ®ØªØ§Ø±Ø© ÙÙ Ø¹ÙÙÙ Ø§ÙØ­Ø§Ø³Ø¨ - ÙØ³ØªÙÙ 3",
                        period: "Ø£ÙÙÙ",
                        time: "9:30 - 11:00",
                        regulation: "4",
                    },
                    {
                        day: "Ø§ÙØ«ÙØ§Ø«Ø§Ø¡",
                        date: "2025/05/27",
                        code: "BSC 222",
                        name: "Ø·Ø±Ù Ø§Ø­ØµØ§Ø¦ÙØ©",
                        period: "Ø«Ø§ÙÙØ©",
                        time: "11:30 - 1:00",
                        regulation: "1",
                    },
                    {
                        day: "Ø§ÙØ«ÙØ§Ø«Ø§Ø¡",
                        date: "2025/05/27",
                        code: "CS 101",
                        name: "ÙÙØ¯ÙØ© ÙÙ Ø¹ÙÙÙ Ø§ÙØ­Ø§Ø³Ø¨",
                        period: "Ø«Ø§ÙÙØ©",
                        time: "11:30 - 1:00",
                        regulation: "4",
                    },
                ],

                // Initialize Application
                init: async function () {
                    console.log("App init started...");

                    // --- START: Get Firebase Database Reference (Moved Here) ---
                    try {
                        // Check if the app instance was successfully initialized in the head
                        if (!window._firebaseAppInstance) {
                            throw new Error("Firebase app instance not found. Initialization in head likely failed.");
                        }
                        // Dynamically import getDatabase function here, inside async init
                        const { getDatabase } = await import("https://www.gstatic.com/firebasejs/11.6.1/firebase-database.js");
                        db = getDatabase(window._firebaseAppInstance); // Assign to the outer 'db' variable
                        console.log("Firebase Database Reference Obtained");

                    } catch (error) {
                        console.error("Failed to get Firebase Database Reference:", error);
                        alert("Error connecting to data services. Some features might be unavailable. Please try refreshing.");
                        // db will remain undefined, the check below will handle it
                    }
                    // --- END: Get Firebase Database Reference ---
                    // --- START: Show Loading Indicators ---
                    // Simple example: Add loading text to key areas
                    document.getElementById('upcoming-lectures').innerHTML = '<p class="text-gray-500 dark:text-gray-400 text-center p-4">Loading lectures...</p>';
                    document.getElementById('recent-materials').innerHTML = '<p class="text-gray-500 dark:text-gray-400 text-center p-4">Loading materials...</p>';
                    document.getElementById('dashboard-news').innerHTML = '<p class="text-gray-500 dark:text-gray-400 text-center p-4">Loading news...</p>';
                    document.getElementById('courses-container').innerHTML = '<p class="text-gray-500 dark:text-gray-400 text-center p-4">Loading courses...</p>';
                    document.getElementById('lecture-list').innerHTML = '<tr><td colspan="4" class="text-center p-4 text-gray-500 dark:text-gray-400">Loading schedule...</td></tr>';
                    document.getElementById('news-container').innerHTML = '<p class="text-gray-500 dark:text-gray-400 text-center p-4">Loading news...</p>';
                    document.getElementById('exam-tracker-container').innerHTML = '<p class="text-gray-500 dark:text-gray-400 text-center p-4">Loading deadlines...</p>';
                    // --- END: Show Loading Indicators ---
                    this.loadUserData();
                    this.setupEventListeners(); // Keep this early
                    this.setupFullCalendar();
                    if (db) { // Only load if db connection was successful
                        await this.loadFirebaseData();
                    } else {
                        console.warn("Skipping Firebase data load because database reference failed.");
                        // Show error messages in the UI sections
                        document.getElementById('courses-container').innerHTML = '<p class="text-red-500 text-center p-4">Could not connect to data services.</p>';
                        // Add similar messages to other sections
                    }  // Load data needed for routing/rendering

                    // this.renderCurrentPage(); // Remove this - routing logic below handles initial page
                    this.updateUIWithUserData();
                    this.renderNotifications();

                    // Check theme preference
                    const savedDarkMode = localStorage.getItem('darkMode');
                    if (savedDarkMode === 'true') { this.toggleDarkMode(true); }

                    // Set current date
                    const dateOptions = { year: 'numeric', month: 'long', day: 'numeric' };
                    document.getElementById('current-date').textContent = new Date().toLocaleDateString('en-US', dateOptions);

                    // START ADDITION: Initial Routing Logic
                    const initialRoute = this.parseHashRoute(window.location.hash);
                    console.log('Initial route parsed:', initialRoute);

                    let startPage = initialRoute.page || 'dashboard';
                    let startId = initialRoute.id || null;

                    // Navigate to the determined starting page/state
                    this.navigateTo(startPage, startId);

                    // Ensure initial history state matches the actual start page/id
                    const initialHash = window.location.hash || '#/dashboard'; // Use current hash or default
                    const initialState = { page: startPage, id: startId };
                    const initialTitle = this.capitalizeFirstLetter(startPage) + (startId ? ` (${startId})` : '');
                    // Use replaceState for the very first entry to avoid a 'back' to a blank state
                    history.replaceState(initialState, initialTitle, initialHash);
                    console.log('Initial history state replaced:', initialHash, initialState);
                    // END ADDITION

                    // Show welcome modal if first visit (AFTER initial routing attempt)
                    if (!this.state.userData.name) {
                        document.getElementById('welcome-modal').classList.remove('hidden');
                    }

                    // Add event listeners for history navigation AFTER initial setup
                    this.setupHistoryListeners();

                    // Adjust sidebar for mobile AFTER initial setup
                    if (checkIfMobile()) {
                        document.getElementById('sidebar').classList.add('sidebar-collapsed');
                    }
                }, // End of init function

                // START ADDITION: Helper to parse URL hash
                parseHashRoute: function (hash) {
                    const route = { page: null, id: null };
                    if (hash && hash.startsWith('#/')) {
                        const parts = hash.substring(2).split('/'); // Remove #/ and split
                        route.page = parts[0] || null;
                        if (route.page === 'course-details' && parts.length > 1) {
                            route.id = decodeURIComponent(parts[1]); // Decode potential course ID
                        }
                        // Add more else if blocks here if other pages need IDs
                    }
                    return route;
                }, // End of parseHashRoute function
                // END ADDITION

                // START REVISED VERSION: New function to setup history listeners
                setupHistoryListeners: function () {
                    window.addEventListener('popstate', (event) => {
                        const previousState = event.state; // State we are going back/forward TO
                        console.log('popstate event fired. Navigating TO state:', previousState);

                        let targetPage = 'dashboard';
                        let targetId = null;
                        let targetChapterIndex = null; // <<< Variable for chapter index

                        if (previousState && previousState.page) {
                            targetPage = previousState.page;
                            targetId = previousState.id || null;
                            targetChapterIndex = previousState.chapterIndex; // <<< Get chapter index from state
                            console.log('Using event.state for navigation:', previousState);
                        } else {
                            // Fallback logic remains the same...
                            console.warn('popstate event had null or missing state.page, defaulting to dashboard.');
                            history.replaceState({ page: 'dashboard', id: null, chapterIndex: null }, 'Dashboard', '#/dashboard');
                        }

                        // Check if the app's current state already matches the target state
                        if (this.state.currentPage !== targetPage ||
                            this.state.selectedCourseId !== targetId ||
                            this.state.targetChapterIndex !== targetChapterIndex) { // <<< Compare chapter index too (important after resetting)

                            console.log(`App state (${this.state.currentPage}/${this.state.selectedCourseId}/chap:${this.state.targetChapterIndex}) differs from history target (${targetPage}/${targetId}/chap:${targetChapterIndex}). Navigating app...`);

                            // Set the target chapter index BEFORE navigating
                            this.state.targetChapterIndex = targetChapterIndex; // <<< Set state

                            // Navigate the application view WITHOUT pushing history again
                            this.navigateTo(targetPage, targetId);

                        } else {
                            console.log(`App state already matches history target (${targetPage}/${targetId}/chap:${targetChapterIndex}). No app navigation needed.`);
                            // Reset target index even if not navigating, as popstate implies intent changed
                            this.state.targetChapterIndex = null;
                        }
                    });

                    // Beforeunload listener remains the same...
                    window.addEventListener('beforeunload', (event) => { /* ... */ });

                    console.log('History event listeners (popstate, beforeunload) attached.');
                },// END REVISED VERSION
                // Load User Data from Cookies
                loadUserData: function () {
                    this.state.userData.name = this.getCookie('userName');
                    this.state.userData.university = this.getCookie('university');
                    this.state.userData.universityName = this.getCookie('universityName');
                    this.state.userData.year = this.getCookie('academicYear');
                    this.state.userData.group = this.getCookie('group');
                },

                // Update UI with User Data
                updateUIWithUserData: function () {
                    const userData = this.state.userData;

                    if (userData.name) {
                        document.getElementById('sidebar-user-name').textContent = userData.name;
                        document.getElementById('dropdown_usrname').textContent = userData.name;
                        document.getElementById('nav-user-name').textContent = userData.name;
                        document.getElementById('dashboard-user-name').textContent = userData.name;
                        document.getElementById('settings-name').value = userData.name;

                        // Set user initials
                        const initials = userData.name.split(' ').map(name => name[0]).join('');
                        document.getElementById('user-initials').textContent = initials;
                        document.getElementById('nav-user-initials').textContent = initials;
                    }

                    if (userData.university) {
                        const universityText = userData.universityName || this.getUniversityNameFromCode(userData.university);
                        document.getElementById('sidebar-university').textContent = universityText;
                        document.getElementById('settings-university').value = userData.university;

                        if (userData.university === 'other' && userData.universityName) {
                            document.getElementById('settings-other-university-container').classList.remove('hidden');
                            document.getElementById('settings-other-university').value = userData.universityName;
                        }
                    }

                    if (userData.year) {
                        document.getElementById('sidebar-year').textContent = userData.year;
                        document.getElementById('settings-year').value = userData.year;
                    }

                    if (userData.group) {
                        document.getElementById('sidebar-group').textContent = userData.group;
                        document.getElementById('settings-group').value = userData.group;
                    }
                },

                // Utility: Get University Name from Code
                getUniversityNameFromCode: function (code) {
                    const universities = {
                        'hti': 'HTI University',
                        'other': 'Other University'
                    };

                    return universities[code] || 'University';
                },

                // Setup Event Listeners
                setupEventListeners: function () {
                    const mainContent = document.querySelector('.content-area'); // Or the main container for pages

                    mainContent.addEventListener('click', (e) => {
                        // Generate Schedule Button Check
                        if (e.target && e.target.id === 'generateScheduleBtn') { // Check the ID
                            console.log('Generate Schedule button click detected via delegation.'); // <-- ADD THIS LOG
                            this.generateSchedule(); // Ensure 'this' refers to the 'app' object
                        }
                        // Export PDF Button Check
                        else if (e.target && e.target.id === 'exportPdfBtn') {
                            console.log('Export PDF button click detected via delegation.'); // <-- ADD THIS LOG
                            this.exportScheduleToPDF(); // Ensure 'this' refers to the 'app' object
                        }
                        // ... other delegated listeners (view course, back button etc.) ...
                    });
                    // Add this at the beginning of setupEventListeners
                    window.addEventListener('resize', () => {
                        const sidebar = document.getElementById('sidebar');
                        if (checkIfMobile()) {
                            sidebar.classList.add('sidebar-collapsed');
                        } else {
                            sidebar.classList.remove('sidebar-collapsed');
                        }
                    });
                    // User Info Form Submission
                    document.getElementById('user-info-form').addEventListener('submit', this.handleUserInfoSubmit.bind(this));

                    // University Selection Change
                    document.getElementById('university').addEventListener('change', function (e) {
                        const otherContainer = document.getElementById('other-university-container');
                        if (e.target.value === 'other') {
                            otherContainer.classList.remove('hidden');
                        } else {
                            otherContainer.classList.add('hidden');
                        }
                    });

                    // Settings Form Submission
                    document.getElementById('settings-form').addEventListener('submit', this.handleSettingsSubmit.bind(this));

                    // Settings University Selection Change
                    document.getElementById('settings-university').addEventListener('change', function (e) {
                        const otherContainer = document.getElementById('settings-other-university-container');
                        if (e.target.value === 'other') {
                            otherContainer.classList.remove('hidden');
                        } else {
                            otherContainer.classList.add('hidden');
                        }
                    });
                    document.querySelectorAll('[data-page]').forEach(link => {
                        link.addEventListener('click', (e) => {
                            console.log('Navigating to:', e.currentTarget.dataset.page); // Debugging
                            const page = e.currentTarget.dataset.page;
                            app.navigateTo(page);
                        });
                    });
                    // Navigation Links
                    document.querySelectorAll('.nav-link').forEach(link => {
                        link.addEventListener('click', (e) => {
                            const page = e.currentTarget.dataset.page;
                            this.navigateTo(page);

                            // Close sidebar on mobile after navigation
                            if (window.innerWidth < 1024) {
                                document.getElementById('sidebar').classList.add('sidebar-collapsed');
                            }
                        });
                    });

                    // Sidebar Toggle (Mobile)
                    document.getElementById('open-sidebar').addEventListener('click', () => {
                        document.getElementById('sidebar').classList.remove('sidebar-collapsed');
                    });

                    document.getElementById('close-sidebar').addEventListener('click', () => {
                        document.getElementById('sidebar').classList.add('sidebar-collapsed');
                    });

                    // Theme Toggle
                    document.getElementById('theme-toggle').addEventListener('click', () => {
                        this.toggleDarkMode();
                    });

                    document.getElementById('settings-theme-toggle').addEventListener('change', (e) => {
                        this.toggleDarkMode(e.target.checked);
                    });

                    // Notification Toggle
                    document.getElementById('notification-button').addEventListener('click', async function () {
                        // Check if push notifications are supported
                        if ('serviceWorker' in navigator && 'PushManager' in window) {
                            try {
                                const registration = await navigator.serviceWorker.ready;
                                const permission = await Notification.requestPermission();

                                if (permission === 'granted') {
                                    const applicationServerKey = 'BMKGpCMKhbZK013iH-1q3K6Qbmv6Yz6gEwlklT-24GT_pk9f6R2Otq1byR8I2bUmBZmrreyAkkkJplb-M1XEpJs';
                                    subscribeUser(registration, applicationServerKey);
                                } else {
                                    console.log('Notification permission denied');
                                }
                            } catch (error) {
                                console.error('Error requesting notification permission:', error);
                            }
                        } else {
                            console.log('Push notifications not supported');
                        }

                        // Keep existing dropdown toggle functionality
                        document.getElementById('notification-dropdown').classList.toggle('hidden');
                    }); document.getElementById('clear-notifications').addEventListener('click', this.clearNotifications.bind(this));

                    // Back to Courses Button
                    document.getElementById('back-to-courses').addEventListener('click', () => {
                        this.navigateTo('courses');
                    });

                    // Lecture View Toggles
                    document.getElementById('view-calendar').addEventListener('click', () => {
                        document.getElementById('calendar-view').classList.remove('hidden');
                        document.getElementById('list-view').classList.add('hidden');
                        document.getElementById('view-calendar').classList.remove('bg-gray-200', 'dark:bg-gray-700', 'text-gray-800', 'dark:text-white', 'hover:bg-gray-300', 'dark:hover:bg-gray-600');
                        document.getElementById('view-calendar').classList.add('bg-indigo-600', 'text-white', 'hover:bg-indigo-700');
                        document.getElementById('view-list').classList.remove('bg-indigo-600', 'text-white', 'hover:bg-indigo-700');
                        document.getElementById('view-list').classList.add('bg-gray-200', 'dark:bg-gray-700', 'text-gray-800', 'dark:text-white', 'hover:bg-gray-300', 'dark:hover:bg-gray-600');
                        this.calendar.render();
                    });

                    document.getElementById('view-list').addEventListener('click', () => {
                        document.getElementById('calendar-view').classList.add('hidden');
                        document.getElementById('list-view').classList.remove('hidden');
                        document.getElementById('view-list').classList.remove('bg-gray-200', 'dark:bg-gray-700', 'text-gray-800', 'dark:text-white', 'hover:bg-gray-300', 'dark:hover:bg-gray-600');
                        document.getElementById('view-list').classList.add('bg-indigo-600', 'text-white', 'hover:bg-indigo-700');
                        document.getElementById('view-calendar').classList.remove('bg-indigo-600', 'text-white', 'hover:bg-indigo-700');
                        document.getElementById('view-calendar').classList.add('bg-gray-200', 'dark:bg-gray-700', 'text-gray-800', 'dark:text-white', 'hover:bg-gray-300', 'dark:hover:bg-gray-600');
                    });

                    // Course Search
                    document.getElementById('course-search').addEventListener('input', (e) => {
                        const searchTerm = e.target.value.toLowerCase();
                        this.filterCourses(searchTerm);
                    });

                    // Close notification dropdown when clicking outside
                    document.addEventListener('click', (e) => {
                        const dropdown = document.getElementById('notification-dropdown');
                        const button = document.getElementById('notification-button');

                        if (!dropdown.contains(e.target) && !button.contains(e.target) && !dropdown.classList.contains('hidden')) {
                            dropdown.classList.add('hidden');
                        }
                    });

                    // Logout Button Event Listener
                    document.getElementById('logout-button').addEventListener('click', function () {
                        // Clear user-related cookies
                        document.cookie.split(";").forEach(function (c) {
                            document.cookie = c.trim().split("=")[0] + "=;expires=Thu, 01 Jan 1970 00:00:00 UTC;path=/";
                        });

                        // Redirect to login or welcome page
                        location.reload();
                    });
                },

                // Handle User Info Form Submission
                handleUserInfoSubmit: function (e) {
                    e.preventDefault();

                    const name = document.getElementById('userName').value;
                    const university = document.getElementById('university').value;
                    const year = document.getElementById('academicYear').value;
                    const group = document.getElementById('group').value;

                    let universityName = null;
                    if (university === 'other') {
                        universityName = document.getElementById('otherUniversity').value;
                    }

                    // Set cookies
                    this.setCookie('userName', name, 365);
                    this.setCookie('university', university, 365);
                    this.setCookie('academicYear', year, 365);
                    this.setCookie('group', group, 365);

                    if (universityName) {
                        this.setCookie('universityName', universityName, 365);
                    }

                    // Update application state
                    this.state.userData.name = name;
                    this.state.userData.university = university;
                    this.state.userData.year = year;
                    this.state.userData.group = group;
                    this.state.userData.universityName = universityName;

                    // Update UI
                    this.updateUIWithUserData();

                    // Hide modal
                    document.getElementById('welcome-modal').classList.add('hidden');
                    tour.start();
                    // Reload mock data based on new user info
                    this.loadMockData();
                },

                // Handle Settings Form Submission
                handleSettingsSubmit: function (e) {
                    e.preventDefault();

                    const name = document.getElementById('settings-name').value;
                    const university = document.getElementById('settings-university').value;
                    const year = document.getElementById('settings-year').value;
                    const group = document.getElementById('settings-group').value;

                    let universityName = null;
                    if (university === 'other') {
                        universityName = document.getElementById('settings-other-university').value;
                    }

                    // Set cookies
                    this.setCookie('userName', name, 365);
                    this.setCookie('university', university, 365);
                    this.setCookie('academicYear', year, 365);
                    this.setCookie('group', group, 365);

                    if (universityName) {
                        this.setCookie('universityName', universityName, 365);
                    } else {
                        this.eraseCookie('universityName');
                    }

                    // Update application state
                    this.state.userData.name = name;
                    this.state.userData.university = university;
                    this.state.userData.year = year;
                    this.state.userData.group = group;
                    this.state.userData.universityName = universityName;

                    // Update UI
                    this.updateUIWithUserData();

                    // Show notification
                    this.addNotification('Settings Updated', 'Your personal information has been updated successfully.');

                    // Reload mock data based on new user info
                    this.loadMockData();
                },
                navigateTo: function (page, id = null) {
                    console.log(`Navigating to: ${page}` + (id ? ` with ID: ${id}` : ''));
                    const targetChapterIndexForState = this.state.targetChapterIndex; // Keep this

                    // Update internal state FIRST
                    const previousPage = this.state.currentPage;
                    this.state.currentPage = page;
                    this.state.selectedCourseId = id; // Store the ID if provided
                    console.log(`App state updated - currentPage: ${this.state.currentPage}, selectedCourseId: ${this.state.selectedCourseId}`);

                    // --- Construct the new URL Hash ---
                    let newHash = `#/${page}`;
                    if (page === 'course-details' && id) {
                        newHash += `/${encodeURIComponent(id)}`;
                    }
                    const pageTitle = this.capitalizeFirstLetter(page) + (id ? ` (${id})` : '');

                    // --- Update History State and URL ---
                    const currentStateHash = window.location.hash;
                    if (newHash !== currentStateHash) {
                        history.pushState({ page: page, id: id, chapterIndex: targetChapterIndexForState }, pageTitle, newHash); // Include chapterIndex in state
                        console.log(`History state pushed: ${newHash}`);
                    } else {
                        console.log(`Skipping history pushState, hash already matches: ${newHash}`);
                    }

                    // --- Logic for showing/hiding pages ---
                    document.querySelectorAll('.page-container').forEach(pageEl => {
                        pageEl.classList.add('hidden');
                    });

                    // Handle course details specifically
                    if (page === 'course-details') {
                        if (!id) {
                            console.error("NavigateTo 'course-details' called without an ID.");
                            this.navigateTo('courses');
                            return;
                        }

                        // --- CORRECTED: Find course across all years ---
                        let foundCourse = null;
                        for (const year in this.mockData.courses) {
                            const coursesForYear = this.mockData.courses[year] || [];
                            foundCourse = coursesForYear.find(c => c && c.id === id); // Add check for c existence
                            if (foundCourse) {
                                break; // Stop searching once found
                            }
                        }
                        // --- End Correction ---

                        if (!foundCourse) {
                            console.error(`Course with ID ${id} not found in any year.`);
                            alert(`Error: Course with ID ${id} could not be found.`);
                            this.navigateTo('courses'); // Redirect
                            return;
                        }

                        this.state.selectedCourse = foundCourse; // Set the selected course
                        const targetPageElement = document.getElementById('course-details-page');
                        if (targetPageElement) {
                            targetPageElement.classList.remove('hidden');
                            document.getElementById('current-page-breadcrumb').textContent = `Courses / ${foundCourse.title}`;
                            this.renderCourseDetails(); // Render *after* finding course
                        } else {
                            console.error("Course details page element not found!");
                            this.navigateTo('courses');
                        }

                    } else if (page === 'courses') {
                        this.state.selectedCourse = null; // Clear selected course when going back to list
                        this.state.selectedCourseId = null;
                        const targetPageElement = document.getElementById('courses-page');
                        if (targetPageElement) {
                            targetPageElement.classList.remove('hidden');
                            document.getElementById('current-page-breadcrumb').textContent = 'Courses';
                            // Ensure courses are rendered for the correct year when navigating TO the courses page
                            this.renderCourses();
                        } else {
                            console.error("Courses page element not found!");
                            this.navigateTo('dashboard');
                        }
                    }
                    // --- ADD Handling for the new Exam Schedule page ---
                    else if (page === 'exam-schedule') {
                        const targetPageElement = document.getElementById('exam-schedule-page');
                        if (targetPageElement) {
                            targetPageElement.classList.remove('hidden');
                            document.getElementById('current-page-breadcrumb').textContent = 'Exam Schedule';
                            this.renderExamSchedulePage(); // Call the specific render function
                        } else {
                            console.error("Exam Schedule page element not found!");
                            this.navigateTo('dashboard'); // Fallback
                        }
                    }
                    // Handle other pages (rest of the logic remains the same)
                    else {
                        const targetPageElement = document.getElementById(`${page}-page`);
                        if (targetPageElement) {
                            targetPageElement.classList.remove('hidden');
                            document.getElementById('current-page-breadcrumb').textContent = this.capitalizeFirstLetter(page);

                            // Special rendering triggers
                            if (page === 'lectures' && this.calendar) {
                                setTimeout(() => this.calendar.render(), 0);
                            }
                            if (page === 'tools') {
                                this.renderToolsPage?.();
                            }
                            if (page === 'exam-tracker') {
                                this.renderExamTracker?.();
                            }
                            // Re-render dashboard if navigating back? Optional.
                            // if (page === 'dashboard') {
                            //    this.renderDashboard();
                            // }

                        } else {
                            console.error(`Page element not found for id: ${page}-page`);
                            this.navigateTo('dashboard'); // Fallback
                        }
                    }
                    // Reset target chapter index AFTER navigation logic is complete
                    this.state.targetChapterIndex = null;


                }, // End of navigateTo function
                // --- ADD Render function for the Exam Schedule Page ---
                renderExamSchedulePage: function () {
                    console.log("Rendering Exam Schedule Page");
                    // Ensure the container is visible (handled by navigateTo)
                    // Populate the checkboxes
                    this.populateCourseCheckboxes();
                    // Hide results initially
                    document.getElementById('scheduleOutput').classList.add('hidden');
                    document.getElementById('noResults').classList.add('hidden');
                    // Attach specific listeners if not using delegation or if needed for complex setup
                    // (Delegation in setupEventListeners is generally preferred)
                },
                // --- END Render function ---
                // --- ADD Exam Schedule Generator Functions as App Methods ---

                adjustTimeFormat: function (timeStr) {
                    // Input format like "10.30:9.30" or "1.00:11.30" or already "HH:MM - HH:MM"
                    if (timeStr.includes(':') && timeStr.includes('-')) return timeStr; // Already formatted

                    const parts = timeStr.split(':');
                    if (parts.length === 2) {
                        // Handle potential . vs : in time parts
                        let start = parts[1].replace('.', ':');
                        let end = parts[0].replace('.', ':');

                        // Pad with leading zeros if needed
                        start = start.split(':').map(p => p.padStart(2, '0')).join(':');
                        end = end.split(':').map(p => p.padStart(2, '0')).join(':');

                        return `${start} - ${end}`;
                    }
                    console.warn(`Unexpected time format encountered: ${timeStr}`);
                    return timeStr; // Return original if format is unexpected
                },

                populateCourseCheckboxes: function () {
                    const checkboxContainer = document.getElementById('checkboxContainer');
                    if (!checkboxContainer) {
                        console.error("Checkbox container not found!");
                        return;
                    }
                    checkboxContainer.innerHTML = ''; // Clear loading/previous
                    const addedCodes = new Set();
                    const coursesToDisplay = [];

                    this.examScheduleData.forEach(exam => {
                        const upperCode = exam.code.toUpperCase();
                        if (!addedCodes.has(upperCode)) {
                            addedCodes.add(upperCode);
                            // Check if name exists, provide fallback
                            const displayName = exam.name || 'Unknown Course';
                            coursesToDisplay.push({ code: exam.code, name: displayName });
                        }
                    });

                    coursesToDisplay.sort((a, b) => a.name.localeCompare(b.name, 'ar'));

                    coursesToDisplay.forEach(course => {
                        const div = document.createElement('div');
                        div.className = 'checkbox-item';

                        const checkbox = document.createElement('input');
                        checkbox.type = 'checkbox';
                        checkbox.id = `examcourse-${course.code.replace(/\s+/g, '-')}`; // Ensure valid ID
                        checkbox.value = course.code;
                        checkbox.name = 'examCourseSelection';

                        const label = document.createElement('label');
                        label.htmlFor = checkbox.id;
                        // Ensure course code and name are displayed, handle missing name gracefully
                        label.textContent = `${course.code} - ${course.name || 'Unnamed Course'}`;
                        label.className = 'text-sm text-gray-700 dark:text-gray-200 flex-grow'; // Added dark mode text

                        div.appendChild(checkbox);
                        div.appendChild(label);
                        checkboxContainer.appendChild(div);
                    });
                    if (coursesToDisplay.length === 0) {
                        checkboxContainer.innerHTML = '<p class="text-gray-500 dark:text-gray-400">No courses available in schedule data.</p>';
                    }
                },

                generateSchedule: function () {
                    const checkedBoxes = document.querySelectorAll('#checkboxContainer input[type="checkbox"]:checked');
                    const scheduleOutputDiv = document.getElementById('scheduleOutput');
                    const noResultsP = document.getElementById('noResults');


                    if (checkedBoxes.length === 0) {
                        alert("Please select at least one course.");
                        scheduleOutputDiv.classList.add('hidden');
                        noResultsP.classList.add('hidden');
                        return;
                    }

                    const selectedCodes = Array.from(checkedBoxes).map(cb => cb.value.toUpperCase());

                    const filteredSchedule = this.examScheduleData.filter(exam =>
                        selectedCodes.includes(exam.code.toUpperCase())
                    );

                    this.displaySchedule(filteredSchedule); // Call the app method
                },

                displaySchedule: function (schedule) {
                    const resultsTableBody = document.getElementById('resultsBody');
                    const scheduleOutputDiv = document.getElementById('scheduleOutput');
                    const noResultsP = document.getElementById('noResults');

                    if (!resultsTableBody || !scheduleOutputDiv || !noResultsP) {
                        console.error("Required elements for displaying schedule not found.");
                        return;
                    }

                    resultsTableBody.innerHTML = ''; // Clear previous results

                    if (schedule.length === 0) {
                        noResultsP.classList.remove('hidden');
                        scheduleOutputDiv.classList.add('hidden'); // Hide the table section
                    } else {
                        noResultsP.classList.add('hidden');

                        // Sort by date and then time
                        schedule.sort((a, b) => {
                            const dateA = new Date(a.date.split('/').reverse().join('-')); // Convert DD/MM/YYYY to YYYY-MM-DD for sorting
                            const dateB = new Date(b.date.split('/').reverse().join('-'));
                            const dateComparison = dateA - dateB;
                            if (dateComparison !== 0) return dateComparison;

                            const timeA = a.time.split(' - ')[0];
                            const timeB = b.time.split(' - ')[0];
                            return timeA.localeCompare(timeB);
                        });


                        schedule.forEach(exam => {
                            const row = resultsTableBody.insertRow();
                            // Apply dark mode classes conditionally or via CSS
                            row.className = 'bg-white dark:bg-gray-800'; // Base classes

                            // Format time using the helper again just in case
                            const formattedTime = this.adjustTimeFormat(exam.time);

                            row.insertCell().textContent = exam.day || 'N/A';
                            row.insertCell().textContent = exam.date || 'N/A';
                            row.insertCell().textContent = exam.code || 'N/A';
                            row.insertCell().textContent = exam.name || 'N/A';
                            row.insertCell().textContent = exam.period || 'N/A';
                            row.insertCell().textContent = formattedTime; // Use formatted time
                            row.insertCell().textContent = exam.regulation || 'N/A';

                            // Apply styling to cells
                            Array.from(row.cells).forEach(cell => cell.classList.add('px-6', 'py-4', 'whitespace-nowrap')); // Added whitespace-nowrap
                            // Specific alignment if needed (can also be done with CSS nth-child)
                            row.cells[2].classList.add('text-center'); // Code
                            row.cells[6].classList.add('text-center'); // Regulation
                            row.cells[1].classList.add('text-center'); // Date
                            row.cells[5].classList.add('text-center'); // Time
                        });
                        scheduleOutputDiv.classList.remove('hidden'); // Show the table section
                    }
                },

                exportScheduleToPDF: async function () {
                    console.log("Export PDF function started."); // For debugging
                    // --- STEP 1: Check if jsPDF library is loaded ---
                    if (typeof window.jspdf === 'undefined' || typeof window.jspdf.jsPDF === 'undefined') {
                        console.error("jsPDF library is not loaded or available (window.jspdf or window.jspdf.jsPDF is undefined).");
                        alert("PDF Exporter is not ready. Please wait a moment or try refreshing the page.");
                        return; // Stop execution if the library isn't ready
                    }
                    // --- END Check ---
                    const { jsPDF } = window.jspdf; // Ensure jsPDF is loaded
                    // --- STEP 2: Initialize the jsPDF document ---
                    let doc; // Declare here
                    try {
                        doc = new jsPDF(); // *** INITIALIZE 'doc' HERE, EARLY ***
                        console.log("jsPDF instance created."); // For debugging
                    } catch (pdfError) {
                        console.error("Failed to initialize jsPDF:", pdfError);
                        alert("An error occurred while initializing the PDF generator. Please check the console.");
                        return; // Stop if initialization fails
                    }
                    // --- END Initialization ---
                    // --- STEP 3: Check if autoTable plugin is loaded (needed AFTER doc is created) ---
                    if (typeof doc.autoTable !== 'function') {
                        console.error("jsPDF autoTable plugin is not loaded (doc.autoTable is not a function).");
                        alert("PDF Table Generator is not ready. Please wait a moment or try refreshing the page.");
                        return; // Stop execution if the plugin isn't ready
                    }
                    // --- END Check ---
                    if (typeof jsPDF === 'undefined' || typeof doc.autoTable === 'undefined') {
                        alert("PDF generation library not loaded. Please wait or refresh.");
                        return;
                    }

                    // --- Logo Loading ---
                    let logoDataUrl = null;
                    try {
                        // *** IMPORTANT: Update 'placeholder-logo.png' to your actual logo path ***
                        const logoPath = 'icon.png'; // Or 'favicon/android-icon-192x192.png' etc.
                        const logoResponse = await fetch(logoPath);
                        if (!logoResponse.ok) throw new Error(`Logo file not found at ${logoPath}`);
                        const logoBlob = await logoResponse.blob();
                        logoDataUrl = await new Promise((resolve, reject) => {
                            const reader = new FileReader();
                            reader.onloadend = () => resolve(reader.result);
                            reader.onerror = reject;
                            reader.readAsDataURL(logoBlob);
                        });
                    } catch (error) {
                        console.error("Error loading logo for PDF:", error);
                        // Non-blocking error, continue without logo
                    }
                    // --- End Logo Loading ---

                    // --- Font Loading ---
                    try {
                        // *** IMPORTANT: Ensure 'Amiri-Regular.ttf' is in the correct path relative to index.html ***
                        const fontPath = 'Amiri-Regular.ttf'; // Adjust if needed
                        const fontResponse = await fetch(fontPath);
                        if (!fontResponse.ok) throw new Error(`Font file not found at ${fontPath}`);
                        const fontArrayBuffer = await fontResponse.arrayBuffer();
                        const fontBase64 = btoa(new Uint8Array(fontArrayBuffer).reduce((data, byte) => data + String.fromCharCode(byte), ''));
                        doc.addFileToVFS('Amiri-Regular.ttf', fontBase64);
                        doc.addFont('Amiri-Regular.ttf', 'Amiri', 'normal');
                        doc.setFont('Amiri');
                    } catch (error) {
                        console.error("Error loading font for PDF:", error);
                        // Non-blocking error, PDF might render Arabic incorrectly
                        alert("Warning: Could not load Arabic font for PDF. Text might not display correctly.");
                    }
                    // --- End Font Loading ---

                    // --- Page Setup ---
                    const pageHeight = doc.internal.pageSize.getHeight();
                    const pageWidth = doc.internal.pageSize.getWidth();
                    const margin = 10;
                    let currentY = margin;

                    // --- Add Logo ---
                    if (logoDataUrl) {
                        try {
                            const imgType = logoDataUrl.split(';')[0].split('/')[1].toUpperCase();
                            const logoHeight = 15;
                            const tempImg = new Image();
                            tempImg.src = logoDataUrl;
                            await new Promise(resolve => { tempImg.onload = resolve; });
                            const aspectRatio = tempImg.width / tempImg.height;
                            const logoWidth = logoHeight * aspectRatio;
                            const logoX = pageWidth - margin - logoWidth;
                            const logoY = margin;
                            doc.addImage(logoDataUrl, imgType, logoX, logoY, logoWidth, logoHeight);
                            currentY = logoY + logoHeight + 5;
                        } catch (imgError) {
                            console.error("Error adding logo image to PDF:", imgError);
                            currentY = margin + 15; // Fallback spacing if logo fails
                        }
                    } else {
                        currentY = margin + 15; // Space if no logo
                    }

                    // --- Add Title ---
                    doc.setFont('Amiri'); // Re-apply font
                    doc.setFontSize(18);
                    const title = "Exam Schedule"; // Use Arabic if font loaded: "Ø¬Ø¯ÙÙ Ø§ÙØ§ÙØªØ­Ø§ÙØ§Øª Ø§ÙÙØ®ØµØµ"
                    const titleWidth = doc.getStringUnitWidth(title) * doc.internal.getFontSize() / doc.internal.scaleFactor;
                    const titleX = (pageWidth - titleWidth) / 2;
                    doc.text(title, titleX, currentY);
                    currentY += 7;

                    doc.setFontSize(12);
                    const subtitle = `Generated for ${this.state.userData.name || 'User'}`; // Use Arabic if font loaded: "(ÙØ³Ù Ø¹ÙÙÙ Ø§ÙØ­Ø§Ø³Ø¨ - ÙØ§ÙÙ/ÙÙØ§ÙØ± 2024/2025)"
                    const subtitleWidth = doc.getStringUnitWidth(subtitle) * doc.internal.getFontSize() / doc.internal.scaleFactor;
                    const subtitleX = (pageWidth - subtitleWidth) / 2;
                    doc.text(subtitle, subtitleX, currentY);
                    currentY += 10;

                    // --- Generate Table ---
                    try {
                        doc.autoTable({
                            html: '#resultsTable',
                            startY: currentY,
                            theme: 'grid',
                            styles: {
                                font: 'Amiri', // Critical for Arabic
                                halign: 'center',
                                cellPadding: 2,
                                fontSize: 9, // Slightly smaller font for potentially more columns
                                overflow: 'linebreak',
                            },
                            headStyles: {
                                fillColor: [79, 70, 229], // Indigo-600
                                textColor: 255, // White
                                fontStyle: 'bold',
                                halign: 'center', // Center header text
                            },
                            columnStyles: { // Fine-tune alignment per column
                                0: { halign: 'right' }, // Day (Arabic)
                                1: { halign: 'center' },// Date
                                2: { halign: 'center' },// Code
                                3: { halign: 'right' }, // Name (Arabic)
                                4: { halign: 'right' }, // Period (Arabic)
                                5: { halign: 'center' },// Time
                                6: { halign: 'center' },// Regulation
                            },
                            didParseCell: function (data) {
                                // Additional parsing if needed, but columnStyles is often enough
                                if (data.section === 'head') {
                                    data.cell.styles.halign = 'center'; // Ensure headers are centered override
                                }
                                // Basic RTL reverse for known Arabic columns (can be imperfect)
                                if (data.section === 'body' && ['day', 'name', 'period'].includes(data.column.dataKey)) {
                                    if (typeof data.cell.raw === 'string' && /[\u0600-\u06FF]/.test(data.cell.raw)) {
                                        // Simple word reverse - might need more sophisticated library for perfect display
                                        // data.cell.text = data.cell.raw.split(' ').reverse().join('  ');
                                        data.cell.styles.halign = 'right'; // Ensure right alignment
                                    }
                                }
                            },
                            // Ensure column headers match the table exactly if using `html` property isn't enough
                            // columns: [ ... ] // Usually not needed if `html` works well
                        });
                    } catch (tableError) {
                        console.error("Error generating PDF table with autoTable:", tableError);
                        alert("An error occurred while creating the PDF table. Please check the console for details.");
                        return; // Stop PDF generation
                    }

                    // Save the PDF
                    doc.save(`Exam_Schedule_${this.state.userData.name || 'User'}.pdf`); // Personalized filename
                },


                // --- END Exam Schedule Generator Functions ---
                toggleDarkMode: function (forcedState) {
                    const newState = forcedState !== undefined ? forcedState : !this.state.darkMode;

                    if (newState) {
                        document.body.classList.remove('light');
                        document.body.classList.add('dark');
                        document.getElementById('theme-toggle').innerHTML = '<i class="fas fa-sun"></i>';

                        // Add dark mode classes to elements that need them
                        document.querySelectorAll('.bg-white').forEach(el => {
                            el.classList.add('dark:bg-gray-800');
                        });

                        document.querySelectorAll('.text-gray-900').forEach(el => {
                            el.classList.add('dark:text-white');
                        });

                        document.querySelectorAll('.text-gray-600, .text-gray-700').forEach(el => {
                            el.classList.add('dark:text-gray-300');
                        });

                        document.querySelectorAll('.text-gray-500').forEach(el => {
                            el.classList.add('dark:text-gray-400');
                        });

                        document.querySelectorAll('.bg-gray-100').forEach(el => {
                            el.classList.add('dark:bg-gray-900');
                        });

                        document.querySelectorAll('.bg-gray-200').forEach(el => {
                            el.classList.add('dark:bg-gray-700');
                        });

                        document.querySelectorAll('.border-gray-300').forEach(el => {
                            el.classList.add('dark:border-gray-700');
                        });

                        document.querySelectorAll('.text-indigo-600').forEach(el => {
                            el.classList.remove('text-indigo-600');
                            el.classList.add('dark:text-indigo-400');
                        });
                    } else {
                        document.body.classList.remove('dark');
                        document.body.classList.add('light');
                        document.getElementById('theme-toggle').innerHTML = '<i class="fas fa-moon"></i>';
                    }

                    // Update checkbox state
                    document.getElementById('settings-theme-toggle').checked = newState;

                    // Save preference
                    localStorage.setItem('darkMode', newState);

                    // Update state
                    this.state.darkMode = newState;

                    // Re-render calendar if visible
                    if (this.state.currentPage === 'lectures' && !document.getElementById('calendar-view').classList.contains('hidden')) {
                        this.calendar.render();
                    }
                },

                // Toggle Notification Dropdown
                toggleNotificationDropdown: function () {
                    const dropdown = document.getElementById('notification-dropdown');
                    dropdown.classList.toggle('hidden');
                },

                addNotification: function (title, message) {
                    const notificationList = document.getElementById('notification-list');
                    const notificationBadge = document.getElementById('notification-badge');

                    // Create notification object
                    const notification = {
                        title,
                        message,
                        timestamp: new Date().toISOString()
                    };

                    // Save notification to localStorage
                    const notifications = JSON.parse(localStorage.getItem('notifications')) || [];
                    notifications.unshift(notification);
                    localStorage.setItem('notifications', JSON.stringify(notifications));

                    // Render notification
                    this.renderNotifications();

                    // Update badge
                    notificationBadge.textContent = notifications.length;
                    notificationBadge.classList.remove('hidden');
                },

                clearNotifications: function () {
                    // Clear notifications from localStorage
                    localStorage.removeItem('notifications');

                    // Clear notification list in the UI
                    document.getElementById('notification-list').innerHTML = '<p class="p-4 text-center text-gray-500 dark:text-gray-400">No notifications</p>';
                    document.getElementById('notification-badge').textContent = '0';
                    document.getElementById('notification-badge').classList.add('hidden');
                    document.getElementById('notification-dropdown').classList.add('hidden');
                },

                renderNotifications: function () {
                    const notificationList = document.getElementById('notification-list');
                    const notifications = JSON.parse(localStorage.getItem('notifications')) || [];

                    if (notifications.length === 0) {
                        notificationList.innerHTML = '<p class="p-4 text-center text-gray-500 dark:text-gray-400">No notifications</p>';
                        return;
                    }

                    notificationList.innerHTML = '';
                    notifications.forEach(notification => {
                        const notificationEl = document.createElement('div');
                        notificationEl.className = 'p-3 hover:bg-gray-100 dark:hover:bg-gray-700 border-b border-gray-200 dark:border-gray-700 animate-fadeIn';
                        notificationEl.innerHTML = `
            <h4 class="font-medium text-gray-900 dark:text-white">${notification.title}</h4>
            <p class="text-sm text-gray-600 dark:text-gray-300">${notification.message}</p>
            <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">${new Date(notification.timestamp).toLocaleString()}</p>
        `;
                        notificationList.appendChild(notificationEl);
                    });

                    // Update badge
                    const notificationBadge = document.getElementById('notification-badge');
                    notificationBadge.textContent = notifications.length;
                    notificationBadge.classList.remove('hidden');
                },

                // Setup FullCalendar
                setupFullCalendar: function () {
                    const calendarEl = document.getElementById('calendar-view');

                    this.calendar = new FullCalendar.Calendar(calendarEl, {
                        initialView: 'dayGridMonth',
                        headerToolbar: {
                            left: 'prev,next today',
                            center: 'title',
                            right: 'dayGridMonth,timeGridWeek,timeGridDay'
                        },
                        events: [],
                        themeSystem: 'standard',
                        height: 'auto',
                        eventClick: info => {
                            this.addNotification('Lecture Reminder', `${info.event.title} starting at ${info.event.start.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })} in ${info.event.extendedProps.location}`);
                        }
                    });
                },

                // // Load Mock Data for the Application
                // loadMockData: function () {
                //     // Load data based on user's year and university
                //     const year = this.state.userData.year || '1';

                //     // Generate courses for the user's year
                //     this.mockData = {
                //         courses: this.generateMockCourses(year),
                //         lectures: this.generateMockLectures(year),
                //         news: this.generateMockNews(),
                //         examTasks: examTaskData
                //     };

                //     // Render data
                //     this.renderDashboard();
                //     this.renderCourses();
                //     this.renderLectures();
                //     this.renderNews();
                //     this.populateCalendar();
                //     this.renderExamTracker();
                // },
                CACHE_KEY: 'appDataCache',
                CACHE_TIMESTAMP_KEY: 'appDataCacheTimestamp',
                CACHE_DURATION_MS: 60 * 60 * 1000, // 1 hour cache duration (adjust as needed)

                loadFirebaseData: async function () {
                    console.log("Checking cache before loading Firestore data...");

                    const cachedData = localStorage.getItem(this.CACHE_KEY);
                    const cachedTimestamp = localStorage.getItem(this.CACHE_TIMESTAMP_KEY);
                    let isCacheValid = false;

                    if (cachedData && cachedTimestamp) {
                        const cacheAge = Date.now() - parseInt(cachedTimestamp, 10);
                        if (cacheAge < this.CACHE_DURATION_MS) {
                            isCacheValid = true;
                        }
                    }

                    if (isCacheValid) {
                        console.log("Loading data from valid cache.");
                        this.mockData = JSON.parse(cachedData);
                        // --- Render data using cached data ---
                        this.renderDashboard();
                        this.renderCourses();
                        this.renderLectures();
                        this.renderNews();
                        this.populateCalendar();
                        this.renderExamTracker();
                        console.log("Finished rendering from cache.");
                        // Optional: You could still fetch in the background to update cache later
                        // this.fetchAndCacheFirebaseData();
                        return; // Exit early, we used the cache
                    }

                    console.log("Cache invalid or missing. Fetching from Firestore...");
                    await this.fetchAndCacheFirebaseData(); // Fetch, render, and cache
                },

                fetchAndCacheFirebaseData: async function () {
                    // Your existing Firestore fetching logic goes here...
                    let fsDB;
                    try {
                        const { getFirestore, collection, getDocs, doc, query, orderBy } = await import("https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js");

                        if (!window._firebaseAppInstance) throw new Error("Firebase App not initialized.");
                        fsDB = getFirestore(window._firebaseAppInstance);

                        // Initialize mockData structure
                        this.mockData = { courses: {}, lectures: [], news: [], examTasks: {} };

                        // --- Fetch Data (Your existing logic) ---
                        const lecturesQuery = query(collection(fsDB, "lectures"), orderBy("date", "desc"));
                        const newsQuery = query(collection(fsDB, "news"), orderBy("date", "desc"));
                        // ... rest of your fetching logic for lectures, news, courses, tasks ...

                        const [lecturesSnapshot, newsSnapshot] = await Promise.all([
                            getDocs(lecturesQuery),
                            getDocs(newsQuery)
                        ]);

                        this.mockData.lectures = lecturesSnapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                        this.mockData.news = newsSnapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));

                        const yearsToFetch = ["1", "2"]; // Adjust as needed
                        for (const year of yearsToFetch) {
                            // Fetch courses & chapters
                            const coursesCollectionRef = collection(fsDB, "academic_years", year, "courses");
                            const coursesSnapshot = await getDocs(coursesCollectionRef);
                            const coursesForYear = [];
                            for (const courseDoc of coursesSnapshot.docs) {
                                const courseDataItem = { id: courseDoc.id, ...courseDoc.data(), chapters: [] };
                                const chaptersCollectionRef = collection(courseDoc.ref, "chapters");
                                const chaptersSnapshot = await getDocs(chaptersCollectionRef);
                                courseDataItem.chapters = chaptersSnapshot.docs.map(chapterDoc => ({ id: chapterDoc.id, ...chapterDoc.data() })).sort(/* sort logic */);
                                coursesForYear.push(courseDataItem);
                            }
                            this.mockData.courses[year] = coursesForYear;

                            // Fetch exam tasks
                            const tasksCollectionRef = collection(fsDB, "academic_years", year, "examTasks");
                            const tasksSnapshot = await getDocs(tasksCollectionRef);
                            this.mockData.examTasks[year] = tasksSnapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                        }


                        console.log("Firestore data fetched:", this.mockData);

                        // --- Cache the fetched data ---
                        localStorage.setItem(this.CACHE_KEY, JSON.stringify(this.mockData));
                        localStorage.setItem(this.CACHE_TIMESTAMP_KEY, Date.now().toString());
                        console.log("Data saved to cache.");

                        // --- Render data using newly fetched data ---
                        this.renderDashboard();
                        this.renderCourses();
                        this.renderLectures();
                        this.renderNews();
                        this.populateCalendar();
                        this.renderExamTracker();
                        // --- END: Render data ---

                    } catch (error) {
                        console.error("Error fetching or caching Firestore data:", error);
                        // Handle error appropriately (e.g., show message to user)
                        // Clear potentially corrupt cache?
                        // localStorage.removeItem(this.CACHE_KEY);
                        // localStorage.removeItem(this.CACHE_TIMESTAMP_KEY);
                    } finally {
                        console.log("Finished Firestore fetch/cache process.");
                    }
                },

                // Add a function to clear the cache, e.g., on logout or in settings
                clearDataCache: function () {
                    localStorage.removeItem(this.CACHE_KEY);
                    localStorage.removeItem(this.CACHE_TIMESTAMP_KEY);
                    console.log("App data cache cleared.");
                },
                renderCurrentPage: function () {
                    this.navigateTo(this.state.currentPage);
                },

                // Render Dashboard
                renderDashboard: function () {
                    this.renderUpcomingLectures();
                    this.renderRecentMaterials();
                    this.renderDashboardNews();
                },

                // Render Upcoming Lectures on Dashboard
                renderUpcomingLectures: function () {
                    const container = document.getElementById('upcoming-lectures');
                    container.innerHTML = '';

                    // Get upcoming lectures (next 7 days)
                    const now = new Date();
                    const nextWeek = new Date(now);
                    nextWeek.setDate(now.getDate() + 7);

                    const upcomingLectures = this.mockData.lectures
                        .filter(lecture => {
                            const lectureDate = new Date(lecture.date + 'T' + lecture.time);
                            return lectureDate >= now && lectureDate <= nextWeek;
                        })
                        .sort((a, b) => {
                            const dateA = new Date(a.date + 'T' + a.time);
                            const dateB = new Date(b.date + 'T' + b.time);
                            return dateA - dateB;
                        })
                        .slice(0, 3);

                    if (upcomingLectures.length === 0) {
                        container.innerHTML = '<p class="text-gray-500 dark:text-gray-400 text-center p-4">Will be available soon</p>';
                        return;
                    }

                    upcomingLectures.forEach(lecture => {
                        const lectureDate = new Date(lecture.date + 'T' + lecture.time);
                        const formattedDate = lectureDate.toLocaleDateString('en-US', { weekday: 'short', month: 'short', day: 'numeric' });
                        const formattedTime = lectureDate.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit' });

                        const lectureEl = document.createElement('div');
                        lectureEl.className = 'flex items-start p-2 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors';
                        lectureEl.innerHTML = `
                            <div class="flex-shrink-0 w-10 h-10 rounded-md bg-indigo-100 dark:bg-indigo-900 flex items-center justify-center text-indigo-600 dark:text-indigo-300 mr-3">
                                <i class="fas fa-clock"></i>
                            </div>
                            <div>
                                <h4 class="font-medium text-gray-900 dark:text-white">${lecture.title}</h4>
                                <p class="text-sm text-gray-600 dark:text-gray-300">${formattedDate} at ${formattedTime}</p>
                                <p class="text-xs text-gray-500 dark:text-gray-400">Location: ${lecture.location}</p>
                            </div>
                        `;

                        container.appendChild(lectureEl);
                    });
                },
                renderRecentMaterials: function () {
                    const container = document.getElementById('recent-materials');
                    container.innerHTML = ''; // Clear previous items

                    // --- CORRECTED LOGIC TO FLATTEN COURSES ---
                    const allMaterials = [];
                    // Iterate through the years in the courses object
                    for (const year in this.mockData.courses) {
                        const coursesForYear = this.mockData.courses[year] || []; // Get the array for the year
                        // Iterate through courses within that year
                        coursesForYear.forEach(course => {
                            if (!course || !Array.isArray(course.chapters)) return; // Safety check

                            course.chapters.forEach((chapter, chapterIndex) => {
                                if (!chapter || !Array.isArray(chapter.materials)) return; // Safety check

                                chapter.materials.forEach(material => {
                                    allMaterials.push({
                                        // Keep existing properties
                                        title: material.title,
                                        type: material.type,
                                        courseTitle: course.title, // Keep original title for display
                                        chapterTitle: chapter.title, // Keep original title for display
                                        date: material.date,
                                        // Add necessary navigation data
                                        courseId: course.id,      // Course ID
                                        chapterIndex: chapterIndex, // Chapter Index
                                        // Add year if needed for linking or display (optional)
                                        academicYear: year
                                    });
                                });
                            });
                        });
                    }
                    // --- END CORRECTED LOGIC ---

                    // Sort materials by date (newest first) - Remains the same
                    allMaterials.sort((a, b) => new Date(b.date) - new Date(a.date));

                    // Take the most recent 3 materials - Remains the same
                    const displayMaterials = allMaterials.slice(0, 3);

                    if (displayMaterials.length === 0) {
                        container.innerHTML = '<p class="text-gray-500 dark:text-gray-400 text-center p-4">No recent materials available</p>';
                        return;
                    }

                    // --- Rendering Logic (Remains mostly the same) ---
                    displayMaterials.forEach(material => {
                        const materialDate = new Date(material.date);
                        const formattedDate = materialDate.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });

                        let icon = 'fa-file-alt';
                        let bgColor = 'bg-gray-100 dark:bg-gray-900 text-gray-600 dark:text-gray-300'; // Default
                        switch (material.type?.toLowerCase()) { // Add optional chaining and lower case
                            case 'pdf': icon = 'fa-file-pdf'; bgColor = 'bg-red-100 dark:bg-red-900 text-red-600 dark:text-red-300'; break;
                            case 'video': icon = 'fa-video'; bgColor = 'bg-blue-100 dark:bg-blue-900 text-blue-600 dark:text-blue-300'; break;
                            case 'assignment': icon = 'fa-tasks'; bgColor = 'bg-green-100 dark:bg-green-900 text-green-600 dark:text-green-300'; break;
                            case 'presentation': icon = 'fa-file-powerpoint'; bgColor = 'bg-orange-100 dark:bg-orange-900 text-orange-600 dark:text-orange-400'; break;
                            case 'document': icon = 'fa-file-word'; bgColor = 'bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-500'; break;
                        }


                        const materialEl = document.createElement('button');
                        materialEl.className = 'w-full text-left flex items-start p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-opacity-50 transition-colors recent-material-item'; // Add common class
                        materialEl.setAttribute('data-course-id', material.courseId);
                        materialEl.setAttribute('data-chapter-index', material.chapterIndex);
                        materialEl.setAttribute('aria-label', `View material ${material.title} in course ${material.courseTitle}`);

                        materialEl.innerHTML = `
                    <div class="flex-shrink-0 w-10 h-10 rounded-md ${bgColor} flex items-center justify-center mr-3">
                        <i class="fas ${icon}"></i>
                    </div>
                    <div class="flex-1 overflow-hidden">
                        <div class="flex justify-between items-center">
                            <h4 class="font-medium text-gray-900 dark:text-white truncate" title="${material.title}">${material.title}</h4>
                            <span class="text-xs text-gray-500 dark:text-gray-400 whitespace-nowrap ml-2">${formattedDate}</span>
                        </div>
                        <p class="text-sm text-gray-600 dark:text-gray-300 truncate" title="${material.courseTitle} - ${material.chapterTitle}">
                            ${material.courseTitle} - ${material.chapterTitle}
                        </p>
                    </div>
                `;
                        container.appendChild(materialEl);
                    });
                    // --- End Rendering Logic ---

                    // --- Event Delegation (Remains the same) ---
                    if (this.recentMaterialClickListener) {
                        container.removeEventListener('click', this.recentMaterialClickListener);
                    }
                    this.recentMaterialClickListener = (event) => {
                        const clickedItem = event.target.closest('.recent-material-item');
                        if (clickedItem) {
                            const courseId = clickedItem.dataset.courseId;
                            const chapterIndex = parseInt(clickedItem.dataset.chapterIndex, 10);
                            if (courseId && !isNaN(chapterIndex)) {
                                this.state.targetChapterIndex = chapterIndex;
                                this.navigateTo('course-details', courseId);
                            } else {
                                console.warn('Clicked recent material item missing required data attributes.');
                            }
                        }
                    };
                    container.addEventListener('click', this.recentMaterialClickListener);
                    // --- End Event Delegation ---

                }, // End of renderRecentMaterials// Render Dashboard News
                renderDashboardNews: function () {
                    const container = document.getElementById('dashboard-news');
                    container.innerHTML = '';

                    // Sort news by date (most recent first)
                    const topNews = this.mockData.news
                        .slice(0, 3)
                        .sort((a, b) => new Date(b.date) - new Date(a.date));

                    if (topNews.length === 0) {
                        container.innerHTML = '<p class="text-gray-500 dark:text-gray-400 text-center p-4">No news available</p>';
                        return;
                    }

                    topNews.forEach(news => {
                        const newsDate = new Date(news.date);
                        const formattedDate = newsDate.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });

                        const newsEl = document.createElement('div');
                        newsEl.className = 'p-2 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors news-item';
                        newsEl.innerHTML = `
            <div class="flex justify-between mb-1">
                <h4 class="font-medium text-gray-900 dark:text-white">${news.title}</h4>
                <span class="text-xs text-gray-500 dark:text-gray-400">${formattedDate}</span>
            </div>
            <p class="text-sm text-gray-600 dark:text-gray-300 line-clamp-2">${news.content.substring(0, 100)}...</p>
        `;

                        container.appendChild(newsEl);
                    });
                },

                renderCourses: function () {
                    const container = document.getElementById('courses-container');
                    container.innerHTML = ''; // Clear previous items

                    // --- Get courses for the current user's year ---
                    const userYear = this.state.userData.year || '1'; // Default to '1' if not set
                    const coursesToRender = this.mockData?.courses?.[userYear] || []; // Get array for the user's year

                    console.log(`Rendering courses for year: ${userYear}`, coursesToRender); // Debugging log

                    if (coursesToRender.length === 0) {
                        container.innerHTML = `<p class="text-gray-500 dark:text-gray-400 text-center p-4 col-span-full">No courses found for Year ${userYear}.</p>`;
                        return;
                    }

                    // --- Iterate over the specific year's courses ---
                    coursesToRender.forEach(course => {
                        if (!course || !course.id) { // Add a check for valid course object
                            console.warn("Skipping invalid course object during rendering:", course);
                            return;
                        }
                        const courseEl = document.createElement('div');
                        courseEl.className = 'bg-white dark:bg-gray-800 rounded-xl shadow-md overflow-hidden card-hover';
                        // Ensure chapters is treated as an array for length check
                        const chapterCount = Array.isArray(course.chapters) ? course.chapters.length : 0;

                        courseEl.innerHTML = `
                    <div class="h-24 gradient-bg flex items-center justify-center">
                        <i class="fas fa-book text-4xl text-white opacity-75"></i>
                    </div>
                    <div class="p-5">
                        <h3 class="text-xl font-semibold mb-2">${course.id} : ${course.title}</h3>
                        <p class="text-gray-600 dark:text-gray-300 mb-4">${course.instructor || 'N/A'}</p>
                        <div class="flex justify-between items-center">
                            <span class="text-sm text-gray-500 dark:text-gray-400">${chapterCount} Chapters</span>
                            <button data-course-id="${course.id}" class="view-course-btn px-4 py-2 rounded-md bg-indigo-600 text-white text-sm hover:bg-indigo-700 transition-colors">View Course</button>
                        </div>
                    </div>
                `;

                        container.appendChild(courseEl);
                    });

                    // --- Re-add event listeners (important!) ---
                    document.querySelectorAll('.view-course-btn').forEach(button => {
                        // Remove existing listener first to prevent duplicates if renderCourses is called multiple times
                        button.removeEventListener('click', this.handleViewCourseClick); // Use a named handler if possible, or handle inline
                        // Add listener inline (simpler for now)
                        button.addEventListener('click', (e) => {
                            const courseId = e.target.dataset.courseId;
                            this.navigateTo('course-details', courseId);
                        });
                    });
                },// Filter Courses by Search Term
                filterCourses: function (searchTerm) {
                    document.querySelectorAll('#courses-container > div').forEach(courseEl => {
                        const title = courseEl.querySelector('h3').textContent.toLowerCase();
                        const instructor = courseEl.querySelector('p').textContent.toLowerCase();

                        if (title.includes(searchTerm) || instructor.includes(searchTerm)) {
                            courseEl.classList.remove('hidden');
                        } else {
                            courseEl.classList.add('hidden');
                        }
                    });
                },

                renderCourseDetails: function () {
                    const container = document.getElementById('course-details-content');
                    const course = this.state.selectedCourse;

                    if (!course) {
                        console.error("renderCourseDetails called but this.state.selectedCourse is null. Navigating away.");
                        this.navigateTo('courses');
                        return;
                    }

                    const shareUrl = `${window.location.origin}${window.location.pathname}#/course-details/${encodeURIComponent(course.id)}`;
                    let shareButtonHtml = '';
                    if (navigator.share) {
                        shareButtonHtml = `<button id="share-course-btn" class="mt-2 sm:mt-0 px-4 py-2 rounded-md bg-green-600 text-white text-sm font-medium hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition-colors"><i class="fas fa-share-alt mr-1"></i> Share Course</button>`;
                    } else {
                        shareButtonHtml = `<button id="copy-course-link-btn" data-url="${shareUrl}" class="mt-2 sm:mt-0 px-4 py-2 rounded-md bg-blue-600 text-white text-sm font-medium hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors"><i class="fas fa-copy mr-1"></i> Copy Link</button>`;
                    }
                    container.innerHTML = `
                        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-md overflow-hidden mb-6">
    <div class="p-4 sm:p-6">
        <div class="flex justify-between items-start flex-wrap gap-2 mb-4">
            <div class="flex-grow min-w-0">
                <h1 class="text-xl sm:text-2xl font-bold text-gray-900 dark:text-white break-words">${course.title}
                    <span class="text-lg font-normal text-gray-500 dark:text-gray-400">(${course.id})</span>
                </h1>
                <p class="text-gray-600 dark:text-gray-300 mt-1">Instructor: ${course.instructor}</p>
            </div>
            <div class="flex-shrink-0">
                ${shareButtonHtml}
            </div>
        </div>
<p class="text-gray-700 dark:text-gray-300 break-words max-w-full text-sm sm:text-base line-clamp-5 sm:line-clamp-3">
  ${course?.description || 'No description available.'}
</p>
    </div>
</div>
                        
                        <h2 class="text-xl font-semibold mb-4">Course Chapters</h2>
                        <div id="chapters-container" class="space-y-4">
                            ${course.chapters.map((chapter, index) => `
                                <div class="bg-white dark:bg-gray-800 rounded-xl shadow-md overflow-hidden">
                                    <div class="p-4 bg-gray-50 dark:bg-gray-700 flex justify-between items-center cursor-pointer chapter-header" data-chapter-index="${index}">
                                        <h3 class="font-medium">${chapter.title}</h3>
                                        <i class="fas fa-chevron-down text-gray-500 dark:text-gray-400 transform transition-transform duration-300"></i>
                                    </div>
                                    <div class="chapter-content p-4 hidden">
                                        <p class="text-gray-600 dark:text-gray-300 mb-4"> ${chapter && chapter.description ? chapter.description : 'No description available.'}
</p>
                                        
                                        <h4 class="font-medium mb-2">Materials</h4>
                                        <div class="space-y-2">
                                            ${chapter.materials.map(material => {
                        let icon = 'fa-file-pdf';
                        let color = 'text-red-600 dark:text-red-400';

                        if (material.type === 'video') {
                            icon = 'fa-video';
                            color = 'text-blue-600 dark:text-blue-400';
                        } else if (material.type === 'assignment') {
                            icon = 'fa-tasks';
                            color = 'text-green-600 dark:text-green-400';
                        }

                        return `
                                                <div class="flex items-center p-2 hover:bg-gray-50 dark:hover:bg-gray-700 rounded-md">
                                                    <i class="fas ${icon} ${color} mr-3"></i>
                                                    <div class="flex-1">
                                                        <p class="font-medium">${material.title}</p>
                                                        <p class="text-xs text-gray-500 dark:text-gray-400">Added: ${new Date(material.date).toLocaleDateString()}</p>
                                                    </div>
                                                    <a href="${material.link}"   class="px-3 py-1 rounded-md bg-gray-200 dark:bg-gray-600 text-gray-800 dark:text-white text-sm hover:bg-gray-300 dark:hover:bg-gray-500 transition-colors download-btn">
                                                        <i class="fas fa-folder-open mr-1"></i> Open
                                                    </a>
                                                </div>
                                            `;
                    }).join('')}
                                        </div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    `;

                    // Add event listeners to chapter headers
                    document.querySelectorAll('.chapter-header').forEach(header => {
                        header.addEventListener('click', () => {
                            const content = header.nextElementSibling;
                            const icon = header.querySelector('i');

                            content.classList.toggle('hidden');
                            icon.classList.toggle('rotate-180');
                        });
                    });
                    // Share button
                    const shareBtn = container.querySelector('#share-course-btn');
                    if (shareBtn) {
                        shareBtn.addEventListener('click', async () => {
                            try {
                                const shareData = {
                                    title: `Course: ${course.title}`,
                                    text: `Hey! ð Check out this course: "${course.title}" (ID: ${course.id}) by ${course.instructor}`,
                                    url: shareUrl,
                                };
                                await navigator.share(shareData);
                            } catch (err) {
                                if (err.name !== 'AbortError') alert(`Sharing failed: ${err.message}`);
                            }
                        });
                    }

                    // Copy link fallback
                    const copyBtn = container.querySelector('#copy-course-link-btn');
                    if (copyBtn) {
                        copyBtn.addEventListener('click', async (e) => {
                            const urlToCopy = e.currentTarget.dataset.url;
                            const originalText = e.currentTarget.innerHTML;
                            try {
                                await navigator.clipboard.writeText(urlToCopy);
                                e.currentTarget.innerHTML = '<i class="fas fa-check mr-1"></i> Copied!';
                                e.currentTarget.disabled = true;
                                setTimeout(() => {
                                    e.currentTarget.innerHTML = originalText;
                                    e.currentTarget.disabled = false;
                                }, 2000);
                            } catch (err) {
                                alert('Copy failed. Please copy manually:\n\n' + urlToCopy);
                            }
                        });
                    }

                    // Scroll to chapter if specified
                    const targetIndex = this.state.targetChapterIndex;
                    if (targetIndex !== null && targetIndex >= 0) {
                        const chapterHeader = container.querySelector(`[data-chapter-index="${targetIndex}"]`);
                        if (chapterHeader) {
                            chapterHeader.click(); // open it
                            chapterHeader.scrollIntoView({ behavior: 'smooth', block: 'start' });
                        }
                    }
                },


                renderLectures: function () {
                    const tbody = document.getElementById('lecture-list');
                    tbody.innerHTML = '';
                    const lecturesToRender = this.mockData?.lectures || []; // Use loaded data

                    this.mockData.lectures.forEach(lecture => {
                        const lectureDate = new Date(lecture.date + 'T' + lecture.time);
                        const formattedDate = lectureDate.toLocaleDateString('en-US', { weekday: 'long', month: 'long', day: 'numeric' });
                        const formattedTime = lectureDate.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit' });

                        const row = document.createElement('tr');
                        row.innerHTML = `
                            <td class="px-6 py-4 whitespace-nowrap">
                                <div class="text-sm font-medium text-gray-900 dark:text-white">${formattedDate}</div>
                                <div class="text-sm text-gray-500 dark:text-gray-400">${formattedTime}</div>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap">
                                <div class="text-sm text-gray-900 dark:text-white">${lecture.title}</div>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap">
                                <div class="text-sm text-gray-900 dark:text-white">${lecture.location}</div>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap">
                                <div class="text-sm text-gray-900 dark:text-white">${lecture.instructor}</div>
                            </td>
                        `;

                        tbody.appendChild(row);
                    });
                },

                // Populate Calendar
                populateCalendar: function () {
                    // Clear existing events
                    this.calendar.removeAllEvents();

                    // Add lectures as events
                    this.mockData.lectures.forEach(lecture => {
                        const eventColor = this.getRandomColor();

                        this.calendar.addEvent({
                            title: lecture.title,
                            start: `${lecture.date}T${lecture.time}`,
                            end: this.calculateEndTime(lecture.date, lecture.time),
                            extendedProps: {
                                location: lecture.location,
                                instructor: lecture.instructor
                            },
                            backgroundColor: eventColor,
                            borderColor: eventColor
                        });
                    });

                    // Render calendar
                    this.calendar.render();
                },

                // Calculate End Time (1 hour after start)
                calculateEndTime: function (date, time) {
                    const startTime = new Date(`${date}T${time}`);
                    const endTime = new Date(startTime.getTime() + 60 * 60 * 1000);

                    return endTime.toISOString();
                },

                // Get Random Color for Calendar Events
                getRandomColor: function () {
                    const colors = [
                        '#4F46E5', // Indigo
                        '#7C3AED', // Purple
                        '#10B981', // Green
                        '#EF4444', // Red
                        '#F59E0B', // Amber
                        '#3B82F6', // Blue
                        '#EC4899'  // Pink
                    ];

                    return colors[Math.floor(Math.random() * colors.length)];
                },

                renderNews: function () {
                    const container = document.getElementById('news-container');
                    container.innerHTML = '';
                    console.log("Attempting to render News Page. Data available:", JSON.stringify(this.mockData?.news, null, 2)); // Log data

                    const newsData = this.mockData?.news || []; // Ensure it's an array

                    if (!newsData || newsData.length === 0) {
                        console.log("No news data found to render on news page.");
                        container.innerHTML = '<p class="text-gray-500 dark:text-gray-400 text-center p-4">No news available at the moment.</p>';
                        return; // Exit if no news
                    }

                    // Create a copy before sorting
                    const sortedNews = [...newsData].sort((a, b) => {
                        // Handle Firestore Timestamp or string date, provide default if missing
                        const dateA = a?.date?.toDate ? a.date.toDate() : new Date(a?.date || 0);
                        const dateB = b?.date?.toDate ? b.date.toDate() : new Date(b?.date || 0);
                        return dateB - dateA; // Sort descending (newest first)
                    });


                    sortedNews.forEach(news => {
                        try { // Add try-catch for robustness during rendering individual items
                            // Handle potential Firestore Timestamp or string date
                            const newsDate = news?.date?.toDate ? news.date.toDate() : new Date(news?.date || Date.now()); // Default to now if date is invalid/missing
                            const formattedDate = newsDate.toLocaleDateString('en-US', { weekday: 'long', month: 'long', day: 'numeric', year: 'numeric' });

                            const newsEl = document.createElement('div');
                            newsEl.className = 'bg-white dark:bg-gray-800 rounded-xl shadow-md overflow-hidden news-item mb-4'; // Added mb-4 for spacing
                            newsEl.innerHTML = `
                 <div class="p-6">
                     <div class="flex justify-between items-start mb-4 flex-wrap gap-2">
                         <h3 class="text-xl font-semibold text-gray-900 dark:text-white">${news?.title || 'Untitled News'}</h3>
                         <span class="text-sm text-gray-500 dark:text-gray-400 whitespace-nowrap">${formattedDate}</span>
                     </div>
                     <div class="news-content">
                         <p class="text-gray-600 dark:text-gray-300">${news?.content || 'No content provided.'}</p>
                     </div>
                     <div class="mt-4 flex items-center text-sm">
                         <span class="text-gray-500 dark:text-gray-400">Source: ${news?.source || 'Unknown'}</span>
                     </div>
                 </div>
                 `;
                            container.appendChild(newsEl);
                        } catch (renderError) {
                            console.error("Error rendering news item:", news, renderError);
                        }
                    });
                },

                renderDashboardNews: function () {
                    const container = document.getElementById('dashboard-news');
                    container.innerHTML = '';
                    console.log("Attempting to render Dashboard News. Data available:", JSON.stringify(this.mockData?.news, null, 2)); // Log data

                    const newsData = this.mockData?.news || []; // Ensure it's an array

                    if (!newsData || newsData.length === 0) {
                        console.log("No news data found to render on dashboard.");
                        container.innerHTML = '<p class="text-gray-500 dark:text-gray-400 text-center p-4">No news available</p>';
                        return; // Exit if no news
                    }

                    // Sort by date descending, then take top 3
                    const topNews = [...newsData].sort((a, b) => {
                        const dateA = a?.date?.toDate ? a.date.toDate() : new Date(a?.date || 0);
                        const dateB = b?.date?.toDate ? b.date.toDate() : new Date(b?.date || 0);
                        return dateB - dateA;
                    }).slice(0, 3);

                    topNews.forEach(news => {
                        try {
                            const newsDate = news?.date?.toDate ? news.date.toDate() : new Date(news?.date || Date.now()); // Handle Timestamp or string
                            const formattedDate = newsDate.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });

                            const newsEl = document.createElement('div');
                            newsEl.className = 'p-2 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors border-l-4 border-indigo-500 mb-3'; // Style for dashboard
                            newsEl.innerHTML = `
                 <div class="flex justify-between items-center mb-1">
                     <h4 class="font-medium text-gray-900 dark:text-white truncate" title="${news?.title || ''}">${news?.title || 'Untitled News'}</h4>
                     <span class="text-xs text-gray-500 dark:text-gray-400 whitespace-nowrap ml-2">${formattedDate}</span>
                 </div>
                 <p class="text-sm text-gray-600 dark:text-gray-300 line-clamp-2">${news?.content || 'No content.'}</p>
                 `;
                            container.appendChild(newsEl);
                        } catch (renderError) {
                            console.error("Error rendering dashboard news item:", news, renderError);
                        }
                    });
                },
                // START: New function to render Exam Tracker
                renderExamTracker: function () {
                    const container = document.getElementById('exam-tracker-container');
                    const yearSpan = document.getElementById('exam-tracker-year');
                    container.innerHTML = ''; // Clear previous items

                    const userYear = this.state.userData.year || '1'; // Default to year 1 if not set
                    yearSpan.textContent = `Year ${userYear}`;

                    const itemsForYear = this.mockData?.examTasks?.[userYear] || []; // Use loaded data

                    // Filter for upcoming items only
                    const now = new Date();
                    const upcomingItems = itemsForYear.filter(item => new Date(item.deadline) >= now);

                    // Sort by deadline (soonest first)
                    upcomingItems.sort((a, b) => new Date(a.deadline) - new Date(b.deadline));

                    if (upcomingItems.length === 0) {
                        container.innerHTML = '<p class="text-gray-500 dark:text-gray-400 text-center p-4">Enjoy, No upcoming exams or tasks found.</p>';
                        return;
                    }

                    upcomingItems.forEach(item => {
                        const deadlineDate = new Date(item.deadline);
                        const formattedDeadline = deadlineDate.toLocaleString('en-US', {
                            weekday: 'short', month: 'short', day: 'numeric', hour: 'numeric', minute: '2-digit', hour12: true
                        });

                        // Calculate days remaining (existing code)
                        const timeDiff = deadlineDate.getTime() - now.getTime();
                        const daysRemaining = Math.ceil(timeDiff / (1000 * 3600 * 24));
                        let daysRemainingText = '';
                        let daysRemainingColor = 'text-gray-500 dark:text-gray-400';

                        if (daysRemaining > 1) {
                            daysRemainingText = `${daysRemaining} days remaining`;
                        } else if (daysRemaining === 1) {
                            daysRemainingText = `1 day remaining`;
                            daysRemainingColor = 'text-yellow-600 dark:text-yellow-400';
                        } else if (daysRemaining === 0) {
                            daysRemainingText = `Due today`;
                            daysRemainingColor = 'text-red-600 dark:text-red-500 font-semibold';
                        }


                        // Determine icon and color based on type (existing code)
                        let iconClass = 'fa-file-alt';
                        let typeColor = 'bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300';
                        let typeText = 'Task';
                        if (item.type === 'exam') {
                            iconClass = 'fa-pencil-alt';
                            typeColor = 'bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300';
                            typeText = 'Exam';
                        }

                        // START: Conditionally create the button HTML
                        let linkButtonHTML = '';
                        if (item.link) {
                            linkButtonHTML = `
                                <a href="${item.link}" target="_blank" rel="noopener noreferrer" class="mt-2 inline-block px-3 py-1 bg-indigo-600 text-white text-xs font-medium rounded-md hover:bg-indigo-700 transition-colors">
                                    <i class="fas fa-external-link-alt mr-1"></i> Go to ${typeText}
                                </a>
                            `;
                        }
                        // END: Conditionally create the button HTML

                        const itemEl = document.createElement('div');
                        itemEl.className = 'border border-gray-200 dark:border-gray-700 rounded-lg p-4 flex items-start space-x-4 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors';
                        // Updated innerHTML to include the conditional button
                        itemEl.innerHTML = `
                            <div class="flex-shrink-0 w-10 h-10 rounded-full ${typeColor} flex items-center justify-center mt-1">
                                <i class="fas ${iconClass}"></i>
                            </div>
                            <div class="flex-grow">
                                <div class="flex justify-between items-center mb-1 flex-wrap"> <!-- Added flex-wrap -->
                                    <h3 class="text-lg font-semibold text-gray-900 dark:text-white mr-2">${item.title}</h3> <!-- Added mr-2 -->
                                    <span class="text-sm font-medium px-2 py-0.5 rounded-full ${typeColor} whitespace-nowrap">${typeText}</span> <!-- Added whitespace-nowrap -->
                                </div>
                                <p class="text-sm text-gray-600 dark:text-gray-300">Course: ${item.course}</p>
                                <p class="text-sm text-gray-600 dark:text-gray-300">Deadline: ${formattedDeadline}</p>
                                <p class="text-sm font-medium ${daysRemainingColor}">${daysRemainingText}</p>
                                ${item.details ? `<p class="text-xs text-gray-500 dark:text-gray-400 mt-1">Details: ${item.details}</p>` : ''}
                                ${linkButtonHTML} <!-- Insert the conditional button HTML here -->
                            </div>
                        `;
                        container.appendChild(itemEl);
                    });
                }, // End of renderExamTracker function
                // END: New function to render Exam Tracker
                // Updated function to load courses from the dataset
                generateMockCourses: function (year) {
                    const yearNum = parseInt(year);
                    return this.mockData?.courses?.[yearNum] || [];
                },

                // Generate Mock Lectures
                generateMockLectures: function () {
                    return lectureData; // Use the static dataset
                },

                // Generate Mock News
                generateMockNews: function () {
                    return news;
                },

                // Helper: Get Course Title
                getCourseTitle: function (prefix, number) {
                    const titles = {
                        'CS': ['Introduction to Computer Science', 'Data Structures and Algorithms', 'Web Development', 'Database Systems', 'Computer Networks', 'Operating Systems'],
                        'MATH': ['Calculus I', 'Linear Algebra', 'Discrete Mathematics', 'Differential Equations', 'Statistics', 'Mathematical Modeling'],
                        'ENG': ['English Composition', 'Technical Writing', 'Literature', 'Communication Skills'],
                        'PHYS': ['Physics I', 'Mechanics', 'Electromagnetism', 'Modern Physics'],
                        'STAT': ['Probability Theory', 'Statistical Methods', 'Data Analysis'],
                        'ECON': ['Microeconomics', 'Macroeconomics', 'Economic Theory'],
                        'SE': ['Software Engineering', 'Requirements Engineering', 'Software Testing', 'Project Management'],
                        'AI': ['Artificial Intelligence', 'Machine Learning', 'Natural Language Processing', 'Computer Vision'],
                        'DB': ['Database Design', 'Big Data Analytics', 'Data Warehousing'],
                        'NET': ['Network Security', 'Cloud Computing', 'Distributed Systems']
                    };

                    const availableTitles = titles[prefix];
                    return prefix + number + ': ' + availableTitles[Math.floor(Math.random() * availableTitles.length)];
                },

                // Helper: Get Chapter Title
                getChapterTitle: function (prefix) {
                    const titles = {
                        'CS': ['Programming Fundamentals', 'Object-Oriented Design', 'Data Structures', 'Algorithms', 'Web Technologies', 'Security Principles'],
                        'MATH': ['Functions and Limits', 'Derivatives', 'Integrals', 'Series and Sequences', 'Vectors', 'Matrices'],
                        'ENG': ['Essay Writing', 'Grammar and Style', 'Critical Analysis', 'Research Methods'],
                        'PHYS': ['Newton\'s Laws', 'Work and Energy', 'Electric Fields', 'Magnetic Fields', 'Relativity'],
                        'STAT': ['Probability Distributions', 'Hypothesis Testing', 'Regression Analysis', 'ANOVA'],
                        'ECON': ['Supply and Demand', 'Market Structures', 'Fiscal Policy', 'Monetary Policy'],
                        'SE': ['Agile Methodologies', 'Design Patterns', 'Testing Strategies', 'CI/CD Pipelines'],
                        'AI': ['Search Algorithms', 'Neural Networks', 'Reinforcement Learning', 'Natural Language Processing'],
                        'DB': ['Relational Model', 'SQL', 'NoSQL Systems', 'Query Optimization'],
                        'NET': ['Network Protocols', 'Routing Algorithms', 'Cloud Services', 'Cybersecurity']
                    };

                    const defaultTitles = ['Introduction', 'Basic Concepts', 'Advanced Topics', 'Applications', 'Case Studies'];

                    const availableTitles = titles[prefix] || defaultTitles;
                    return availableTitles[Math.floor(Math.random() * availableTitles.length)];
                },

                // Helper: Get Material Title
                getMaterialTitle: function (type, chapter, item) {
                    if (type === 'pdf') {
                        return `Lecture ${chapter}.${item} Notes`;
                    } else if (type === 'video') {
                        return `Video Tutorial ${chapter}.${item}`;
                    } else {
                        return `Assignment ${chapter}.${item}`;
                    }
                },

                // Helper: Get Random Instructor
                getRandomInstructor: function () {
                    const instructors = [
                        'Dr. Sarah Johnson',
                        'Prof. Michael Chen',
                        'Dr. Emily Rodriguez',
                        'Prof. David Williams',
                        'Dr. Jessica Thompson',
                        'Prof. Robert Kim',
                        'Dr. Lisa Patel',
                        'Prof. James Wilson'
                    ];

                    return instructors[Math.floor(Math.random() * instructors.length)];
                },

                // Utility: Set Cookie
                setCookie: function (name, value, days) {
                    const expires = new Date();
                    expires.setTime(expires.getTime() + days * 24 * 60 * 60 * 1000);
                    document.cookie = name + '=' + encodeURIComponent(value) + ';expires=' + expires.toUTCString() + ';path=/';
                },

                // Utility: Get Cookie
                getCookie: function (name) {
                    const nameEQ = name + '=';
                    const ca = document.cookie.split(';');
                    for (let i = 0; i < ca.length; i++) {
                        let c = ca[i];
                        while (c.charAt(0) === ' ') c = c.substring(1, c.length);
                        if (c.indexOf(nameEQ) === 0) return decodeURIComponent(c.substring(nameEQ.length, c.length));
                    }
                    return null;
                },

                // Utility: Erase Cookie
                eraseCookie: function (name) {
                    document.cookie = name + '=;Max-Age=-99999999;path=/';
                },

                // Utility: Capitalize First Letter
                capitalizeFirstLetter: function (string) {
                    return string.charAt(0).toUpperCase() + string.slice(1);
                }
            };
            function checkIfMobile() {
                return window.innerWidth < 1024;
            }
            // Initialize the application
            app.init();

            // Todo List Functionality
            document.getElementById('add-todo').addEventListener('click', () => {
                document.getElementById('todo-input-container').classList.remove('hidden');
                document.getElementById('new-todo').focus();
            });

            document.getElementById('cancel-todo').addEventListener('click', () => {
                document.getElementById('todo-input-container').classList.add('hidden');
                document.getElementById('new-todo').value = '';
            });

            document.getElementById('save-todo').addEventListener('click', () => {
                const todoText = document.getElementById('new-todo').value.trim();
                if (todoText) {
                    const todoList = document.getElementById('todo-list');
                    todoList.insertAdjacentHTML('beforeend', todoTemplate(todoText));

                    // Save to localStorage
                    const todos = JSON.parse(localStorage.getItem('todos')) || [];
                    todos.push({ id: Date.now(), text: todoText, completed: false });
                    localStorage.setItem('todos', JSON.stringify(todos));

                    document.getElementById('new-todo').value = '';
                    document.getElementById('todo-input-container').classList.add('hidden');
                }
            });

            // Sticky Notes Functionality
            document.getElementById('add-note').addEventListener('click', () => {
                const notesContainer = document.getElementById('notes-container');
                notesContainer.insertAdjacentHTML('afterbegin', noteTemplate(selectedColor));

                // Save to localStorage
                const notes = JSON.parse(localStorage.getItem('notes')) || [];
                notes.push({ id: Date.now(), color: selectedColor, content: '' });
                localStorage.setItem('notes', JSON.stringify(notes));
            });

            // Event delegation for todo list
            document.getElementById('todo-list').addEventListener('click', (e) => {
                if (e.target.classList.contains('delete-todo') || e.target.closest('.delete-todo')) {
                    const todoItem = e.target.closest('li');
                    const todoId = todoItem.dataset.id;

                    // Remove from localStorage
                    let todos = JSON.parse(localStorage.getItem('todos')) || [];
                    todos = todos.filter(todo => todo.id != todoId);
                    localStorage.setItem('todos', JSON.stringify(todos));

                    todoItem.remove();
                } else if (e.target.classList.contains('todo-checkbox')) {
                    const todoItem = e.target.closest('li');
                    const todoId = todoItem.dataset.id;
                    const isCompleted = e.target.checked;

                    // Update in localStorage
                    let todos = JSON.parse(localStorage.getItem('todos')) || [];
                    const todo = todos.find(t => t.id == todoId);
                    if (todo) {
                        todo.completed = isCompleted;
                        localStorage.setItem('todos', JSON.stringify(todos));
                    }

                    // Update UI
                    const textSpan = todoItem.querySelector('span');
                    if (isCompleted) {
                        textSpan.classList.add('line-through', 'text-gray-400', 'dark:text-gray-500');
                    } else {
                        textSpan.classList.remove('line-through', 'text-gray-400', 'dark:text-gray-500');
                    }
                }
            });

            // Event delegation for sticky notes
            document.getElementById('notes-container').addEventListener('click', (e) => {
                if (e.target.classList.contains('delete-note') || e.target.closest('.delete-note')) {
                    const note = e.target.closest('.note');
                    const noteId = note.dataset.id;

                    // Remove from localStorage
                    let notes = JSON.parse(localStorage.getItem('notes')) || [];
                    notes = notes.filter(n => n.id != noteId);
                    localStorage.setItem('notes', JSON.stringify(notes));

                    note.remove();
                }
            });

            // Save note content when changed
            document.getElementById('notes-container').addEventListener('input', (e) => {
                if (e.target.tagName === 'TEXTAREA') {
                    const note = e.target.closest('.note');
                    const noteId = note.dataset.id;
                    const content = e.target.value;

                    // Update in localStorage
                    let notes = JSON.parse(localStorage.getItem('notes')) || [];
                    const noteObj = notes.find(n => n.id == noteId);
                    if (noteObj) {
                        noteObj.content = content;
                        localStorage.setItem('notes', JSON.stringify(notes));
                    }
                }
            });

            // Track selected color
            let selectedColor = 'yellow';

            // Color picker for notes
            document.querySelectorAll('.color-picker').forEach(button => {
                button.addEventListener('click', (e) => {
                    selectedColor = e.target.dataset.color;

                    // Update active state
                    document.querySelectorAll('.color-picker').forEach(btn => {
                        btn.classList.remove('ring-2', 'ring-indigo-500');
                    });
                    e.target.classList.add('ring-2', 'ring-indigo-500');
                });
            });

            // Set initial active color
            document.querySelector('.color-picker[data-color="yellow"]').classList.add('ring-2', 'ring-indigo-500');

            // Load saved todos and notes
            function loadSavedItems() {
                // Load todos
                const todos = JSON.parse(localStorage.getItem('todos')) || [];
                const todoList = document.getElementById('todo-list');
                todoList.innerHTML = '';
                todos.forEach(todo => {
                    todoList.insertAdjacentHTML('beforeend', todoTemplate(todo.text, todo.completed, todo.id));
                });

                // Load notes
                const notes = JSON.parse(localStorage.getItem('notes')) || [];
                const notesContainer = document.getElementById('notes-container');
                notesContainer.innerHTML = '';
                notes.forEach(note => {
                    notesContainer.insertAdjacentHTML('beforeend', noteTemplate(note.color, note.content, note.id));
                });
            }

            // Call load when tools page is shown
            document.addEventListener('click', (e) => {
                if (e.target.dataset.page === 'tools' || e.target.closest('[data-page="tools"]')) {
                    loadSavedItems();
                }
            });
        });
    </script>
</body>

</html>